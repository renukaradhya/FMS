function error(a){console.log(a.status)}function show_dialoge(a,b,c,d,e){return a.open({scope:b,templateUrl:d,controller:"dialogeCtrl",resolve:{data:function(){return void 0==c||null==c||""==c?{message:null,title:e}:void 0==e||null==e||""==e?{message:c,title:null}:void 0!=c&&null!=c&&""!=c||void 0!=e&&null!=e&&""!=e?{message:c,title:e}:null}}})}function open_dialoge(a,b,c,d,e){return b.open({scope:c,size:a,templateUrl:e,controller:"dialogeCtrl",resolve:{data:function(){return d}}})}function error(a,b){404==b.status&&console.log(a+b.status)}function goToHome(){$(".sidebar-menu #space a").trigger("click")}var branchManager_login=angular.module("branchManager_login",["blockUI","config_app","ngRoute","ngResource"]);branchManager_login.config(["$locationProvider","blockUIConfig",function(a,b){a.html5Mode({enabled:!0,requireBase:!0}),b.message="Logging In ..."}]),branchManager_login.factory("br_manager_loginFactory",["$resource","br_Manager_Config",function(a,b){var c={},d=b.getLoginApi();return c.getLogin=function(b){return a(d+"/"+b,{},{login:{method:"POST",headers:{"Content-Type":"application/json"},interceptor:{response:function(a){return a}}}})},c}]),branchManager_login.controller("loginCtrl",["$scope","br_manager_loginFactory","$window",function(a,b,c){a.username="",a.password="",a.login=function(){var d='{"userName":"'+a.username+'","password":"'+a.password+'"}';b.getLogin(a.login_as).login({},d,function(a){if(200==a.status){var b=a.data;c.sessionStorage.setItem("orgId",b.orgId),c.sessionStorage.setItem("userId",b.userId),c.sessionStorage.setItem("branchId",b.branchId),c.localStorage.setItem("authCode",b.authCode),console.log("orgId"+b.orgId),console.log("userId"+b.userId),console.log("branchId"+b.branchId),c.location="pc_main.html"}},function(b){console.log(b),0==b.status?c.location="system_error.html":a.$parent.$parent.response_message=b.data})},a.clearErrorMsg=function(){a.$parent.$parent.response_message=""}}]);var branchManager=angular.module("branchManager",["ui.bootstrap","blockUI","slimScrollDirective","highcharts-ng","angularUtils.directives.dirPagination","config_app","ui.bootstrap","branchManager_login","checklist-model","ui.router","ngRoute","ngResource"]);branchManager.factory("branchManagerFactory",["$resource","br_Manager_Config","$window",function(a,b,c){var d={},e=b.getBaseUrl(),f=b.getPasswordApi(),g=c.localStorage.getItem("authCode");return d.fetchBranchInfo=function(){return a(e,{},{fetch:{method:"get",isArray:!1,headers:{Authorization:g},interceptor:{response:function(a){return a}}}})},d.changePassword=function(b){return a(f+"/user/"+b+"/password",{},{pass:{method:"PUT",headers:{Authorization:g,"Content-Type":"application/json"},interceptor:{response:function(a){return a}}}})},d}]),branchManager.run([function(){$(function(){$(document).keydown(function(a){return 116==(a.which||a.keyCode)||82==a.keyCode&&a.ctrlKey?void a.preventDefault():116!=(a.which||a.keyCode)})})}]),branchManager.controller("mainCtrl",["$scope","$location","br_Manager_Config","$window",function(a,b,c,d){function e(){b.path("/dash")}var f=c.setConfig();f?e():(d.location="index.html",a.$parent.response_message="Please try after some time")}]),branchManager.controller("companyCtrl",["$scope","branchManagerFactory","$state","$timeout","$window",function(a,b,c,d,e){b.fetchBranchInfo().fetch({},function(b){if(a.todaydate=new Date,console.log(b),200==b.status){var d=angular.fromJson(b.data),e={orgName:d.orgName,address:d.address,branchName:d.branchName,pincode:d.pincode,branchId:d.branchId,managerName:d.branchManagerName};a.$parent.logo_image="images/loading5.jpg",a.$parent.orgName=e.orgName,a.$parent.branchId=e.branchId,a.$parent.branchName=e.branchName,a.$parent.address=e.address,a.$parent.pincode=e.pincode,a.$parent.managerName=e.managerName,c.go("dash")}},error);a.setBaseContentHeight=function(a){a>10?($(".base-content").css({height:"100%"}),$(".slim-content").slimScroll({height:"95%",alwaysVisible:!1,size:"3px"}).css("width","100%"),$(".table-base .slimScrollDiv").css("min-width","660px")):($(".base-content").height("auto"),$(".slim-content").slimScroll({destroy:!0}))},c.go("dash")}]),branchManager.config(["$stateProvider","$urlRouterProvider","$routeProvider","$locationProvider","blockUIConfig",function(a,b,c,d,e){b.otherwise("/#"),a.state("dash",{url:"/dash",templateUrl:"views/br_manager/pc_dashboard.html",controller:"dashCtrl"}).state("pass",{url:"/pass",templateUrl:"views/br_manager/change_password.html",controller:"passwordCtrl"}).state("vehicle",{"abstract":!0,url:"/vehicle",template:'<div ui-view style="height:100%"></div>',controller:"vehicleManagementCtrl"}).state("vehicle.list",{url:"",templateUrl:"views/br_manager/mg_vehicleManagement.html"}).state("vehicle.add",{url:"",templateUrl:"views/br_manager/mg_addVehicle.html"}).state("vehicle.edit",{url:"",templateUrl:"views/br_manager/mg_editVehicle.html"}).state("vehicle.delete",{url:"",templateUrl:"views/br_manager/mg_vehicleManagement.html"}).state("assess",{"abstract":!0,url:"/assess",template:'<div ui-view style="height:100%"></div>',controller:"assessmentCtrl"}).state("assess.list",{url:"",templateUrl:"views/br_manager/mg_assessment.html"}).state("assess.create",{url:"",templateUrl:"views/br_manager/mg_addAsessments.html"}).state("assess.view",{url:"",templateUrl:"views/br_manager/mg_assessmentDetails.html"}).state("assess.edit",{url:"",templateUrl:"views/br_manager/mg_editAssessment.html"}).state("fuelbook",{"abstract":!0,url:"/fuelbook",template:'<div ui-view style="height:100%"></div>',controller:"fuelbookManagementCtrl"}).state("fuelbook.list",{url:"",templateUrl:"views/br_manager/mg_FuelBookManagement.html"}).state("fuelbook.add",{url:"",templateUrl:"views/br_manager/mg_addFuelbookEntry.html"}).state("fuelbook.edit",{url:"",templateUrl:"views/br_manager/mg_editFuelbook.html"}).state("fuelbook.delete",{url:"",templateUrl:"views/br_manager/mg_FuelBookManagement.html"}).state("sm",{"abstract":!0,url:"/sm",template:'<div ui-view style="height:100%"></div>',controller:"studentManageCtrl"}).state("sm.list",{url:"",templateUrl:"views/br_manager/SM.html"}).state("sm.add",{url:"",templateUrl:"views/br_manager/mg_newAdmission1.html"}).state("sm.read",{url:"",templateUrl:"views/br_manager/mg_reAdmisson.html"}).state("sm.view",{url:"",templateUrl:"views/br_manager/mg_studentCompleteDetails.html"}).state("sm.assign",{url:"",templateUrl:"views/br_manager/mg_assignStudent.html"}).state("sm.choose",{url:"",templateUrl:"views/br_manager/mg_studentFeesMode.html"}).state("photo",{"abstract":!0,url:"/photo",template:'<div ui-view style="height:100%"></div>',controller:"photoCtrl"}).state("photo.img",{url:"",templateUrl:"views/br_manager/mg_uploadPhoto.html"}).state("photo.facultyphoto",{url:"",templateUrl:"views/br_manager/mg_facultyPhoto.html"}).state("spm",{"abstract":!0,url:"/spm",template:'<div ui-view style="height:100%"></div>',controller:"studentPromotionsManagementCtrl1"}).state("spm.list",{url:"",templateUrl:"views/br_manager/mg_studentPromotionManagement.html"}).state("spm.promote",{url:"",templateUrl:"views/br_manager/mg_studentPromotion.html"}).state("promotion",{"abstract":!0,url:"/promotion",template:'<div ui-view style="height:100%"></div>',controller:"studentPromotionsManagementCtrl"}).state("promotion.list",{url:"",templateUrl:"views/br_manager/mg_studentPromotionManagement.html"}).state("promotion.studentdetails",{url:"",templateUrl:"views/br_manager/mg_studentDetails.html"}).state("promotion.read",{url:"",templateUrl:"views/br_manager/mg_readmission.html"}).state("promotion.studentadmission",{url:"",templateUrl:"views/br_manager/mg_studentPromotion.html"}).state("classroom",{"abstract":!0,url:"/classroom",template:'<div ui-view style="height:100%"></div>',controller:"classroomManagementCtrl"}).state("classroom.list",{url:"",templateUrl:"views/br_manager/mg_classroom.html"}).state("classroom.add",{url:"",templateUrl:"views/br_manager/mg_addClassroom.html"}).state("classroom.edit",{url:"",templateUrl:"views/br_manager/mg_editClassroom.html"}).state("classroom.view",{url:"",templateUrl:"views/br_manager/mg_classroomSubjects.html"}).state("classroom.delete",{url:"",templateUrl:"views/br_manager/CR.html"}).state("classroom.assign",{url:"",templateUrl:"views/br_manager/mg_assignFaculty.html"}).state("faculty",{"abstract":!0,url:"/faculty",template:'<div ui-view style="height:100%"></div>',controller:"facultyManagementCtrl"}).state("faculty.list",{url:"",templateUrl:"views/br_manager/mg_facultyManagement.html"}).state("faculty.add",{url:"",templateUrl:"views/br_manager/mg_addFaculty.html"}).state("faculty.edit",{url:"",templateUrl:"views/br_manager/mg_editFaculty.html"}).state("faculty.view",{url:"",templateUrl:"views/br_manager/mg_FacultyCompleteInfo.html"}).state("leave",{"abstract":!0,url:"/leave",template:'<div ui-view style="height:100%"></div>',controller:"facultyLeaveCtrl"}).state("leave.list",{url:"",templateUrl:"views/br_manager/mg_facultyLeaveManagement.html"}).state("inventory",{"abstract":!0,url:"/inventory",template:'<div ui-view style="height:100%"></div>',controller:"inventoryManagementCtrl"}).state("inventory.list",{url:"",templateUrl:"views/br_manager/mg_inventoryManagement.html"}).state("inventory.edit",{url:"",templateUrl:"views/br_manager/mg_editIventary.html"}).state("inventory.add",{url:"",templateUrl:"views/br_manager/mg_addInventory.html"}).state("library",{"abstract":!0,url:"/library",template:'<div ui-view style ="height:100%"></div>',controller:"libraryManagementCtrl"}).state("library.assign",{url:"",templateUrl:"views/br_manager/mg_libraryAssign.html"}).state("library.list",{url:"",templateUrl:"views/br_manager/mg_libraryManagement.html"}).state("library.delist",{url:"",templateUrl:"views/br_manager/mg_libraryDefaulter.html"}).state("library.add",{url:"",templateUrl:"views/br_manager/mg_addLibraryBook.html"}).state("library.edit",{url:"",templateUrl:"views/br_manager/mg_editLibraryBook.html"}).state("library.ret",{url:"",templateUrl:"views/br_manager/mg_libraryUnissue.html"}).state("library.search",{url:"",templateUrl:"views/br_manager/mg_libraryManagement.html"}).state("library.report",{url:"",templateUrl:"views/br_manager/mg_library_report.html"}).state("fee",{"abstract":!0,url:"/fee",template:'<div ui-view style="height:100%"></div>',controller:"feeManagementCtrl"}).state("fee.list",{url:"",templateUrl:"views/br_manager/mg_feeManagement.html"}).state("fee.add",{url:"",templateUrl:"views/br_manager/mg_addFee.html"}).state("fee.edit",{url:"",templateUrl:"views/br_manager/mg_editFeesStructure.html"}).state("fee.assign",{url:"",templateUrl:"views/br_manager/mg_assignFees.html"}).state("fee.details",{url:"",templateUrl:"views/br_manager/mg_feeStructureDetails.html"}).state("fee.oneTimeFee",{url:"",templateUrl:"views/br_manager/mg_addFeesOneTime.html"}).state("fee.recurringFee",{url:"",templateUrl:"views/br_manager/mg_addFeesRecurring.html"}).state("feeTran",{"abstract":!0,url:"/feeTran",template:'<div ui-view style="height:100%"></div>',controller:"feeTransactionCtrl"}).state("feeTran.lists",{url:"",templateUrl:"views/br_manager/mg_FeeTransaction.html"}).state("feeTran.stlist",{url:"",templateUrl:"views/br_manager/mg_feeStructureStudent.html"}).state("feeTran.details",{url:"",templateUrl:"views/br_manager/mg_transactionDetails.html"}).state("feeTran.addTran",{url:"",templateUrl:"views/br_manager/mg_addfeesTransaction.html"}).state("feeTran.see",{url:"",templateUrl:"views/br_manager/mg_feesDetailsStudent.html"}).state("holiday",{url:"/holiday",template:'<div ui-view style="height:100%"></div>',controller:"holidaysManagementCtrl"}).state("holiday.list",{url:"",templateUrl:"views/br_manager/mg_holidaysManagement.html"}).state("holiday.add",{url:"",templateUrl:"views/br_manager/mg_addHoliday.html"}).state("holiday.edit",{url:"",templateUrl:"views/br_manager/mg_editHolidays.html"}).state("subject",{url:"/subject",template:'<div ui-view style="height:100%"></div>',controller:"subjectManagementCtrl"}).state("subject.list",{url:"",templateUrl:"views/br_manager/mg_subjectList.html"}).state("subject.add",{url:"",templateUrl:"views/br_manager/mg_addSubject.html"}).state("subject.edit",{url:"",templateUrl:"views/br_manager/mg_editSubject.html"}).state("subject.assign",{url:"",templateUrl:"views/br_manager/mg_assignsubject.html"}).state("reports",{url:"/reports",template:'<div ui-view style="height:100%"></div>',controller:"reportCtrl"}).state("reports.main",{url:"",templateUrl:"views/br_manager/mg_reportdashbord.html"}).state("reports.branchFee",{url:"",templateUrl:"views/br_manager/mg_branchFee_report.html"}).state("reports.studentFee",{url:"",templateUrl:"views/br_manager/mg_branchFee_report_year.html"}).state("reports.back",{url:"",templateUrl:"views/br_manager/mg_reportdashbord.html"}).state("classroomreports",{url:"/classroomreports",template:'<div ui-view style="height:100%"></div>',controller:"classroomReportsCtrl"}).state("classroomreports.classroom",{url:"",templateUrl:"views/br_manager/mg_classroomReport.html"}).state("classroomreports.main",{url:"",templateUrl:"views/br_manager/mg_reportdashbord.html"}).state("students",{url:"/students",template:'<div ui-view style="height:100%"></div>',controller:"studentReportsCtrl"}).state("students.student",{url:"",templateUrl:"views/br_manager/mg_studentReports.html"}).state("students.main",{url:"",templateUrl:"views/br_manager/mg_reportdashbord.html"}).state("subjects",{url:"/subjects",template:'<div ui-view style="height:100%"></div>',controller:"subjectReportsCtrl"}).state("subjects.sub",{url:"",templateUrl:"views/br_manager/mg_subjectsReport.html"}).state("subjects.main",{url:"",templateUrl:"views/br_manager/mg_reportdashbord.html"}).state("facultyreports",{url:"/facultyreports",template:'<div ui-view style="height:100%"></div>',controller:"facultyReportCtrl"}).state("facultyreports.faculty",{url:"",templateUrl:"views/br_manager/mg_facultyReport.html"}).state("facultyreports.main",{url:"",templateUrl:"views/br_manager/mg_reportdashbord.html"}).state("vehiclereports",{url:"/vehiclereports",template:'<div ui-view style="height:100%"></div>',controller:"vehicleReportsCtrl"}).state("vehiclereports.vehicle",{url:"",templateUrl:"views/br_manager/mg_vehicleReport.html"}).state("vehiclereports.students",{url:"",templateUrl:"views/br_manager/mg_VehicleStudentReports.html"}).state("vehiclereports.main",{url:"",templateUrl:"views/br_manager/mg_reportdashbord.html"}).state("feeReport",{url:"/feeReport",template:'<div ui-view style="height:100%"></div>',controller:"feeStructureReportsCtrl"}).state("feeReport.fee",{url:"",templateUrl:"views/br_manager/mg_feesStructureReports.html"}).state("feeReport.main",{url:"",templateUrl:"views/br_manager/mg_reportdashbord.html"}).state("events",{url:"/vehiclereports",template:'<div ui-view style="height:100%"></div>',controller:"eventReportsCtrl"}).state("events.eve",{url:"",templateUrl:"views/br_manager/mg_eventReports.html"}).state("events.main",{url:"",templateUrl:"views/br_manager/mg_reportdashbord.html"}).state("intryreport",{url:"/intryreport",template:'<div ui-view style="height:100%"></div>',controller:"inventaryReportsCtrl"}).state("intryreport.inventary",{url:"",templateUrl:"views/br_manager/mg_inventaryReport.html"}).state("intryreport.main",{url:"",templateUrl:"views/br_manager/mg_reportdashbord.html"}).state("time",{"abstract":!0,url:"/time",template:'<div ui-view style="height:100%"></div>',controller:"timeTableCtrl"}).state("time.list",{url:"",templateUrl:"views/br_manager/mg_timetable.html"}).state("time.add",{url:"",templateUrl:"views/br_manager/mg_addTimetable.html"}).state("marksheet",{"abstract":!0,url:"/marksheet",template:'<div ui-view style="height:100%"></div>',controller:"marksSheetCtrl"}).state("marksheet.each",{url:"",templateUrl:"views/br_manager/mg_MarkSheetforEachAsses.html"}).state("marksheet.class",{url:"",templateUrl:"views/br_manager/mg_Marksheetforclassroom.html"}).state("marksheet.annual",{url:"",templateUrl:"views/br_manager/mg_MarksheetAnnual.html"}).state("marksheet.add",{url:"",templateUrl:"views/br_manager/mg_assessmentMarks.html"}).state("marksheet.editMarks",{url:"",templateUrl:"views/br_manager/mg_editassesmentMarks.html"}).state("marksheet.result1",{url:"",templateUrl:"views/br_manager/mg_assessmentResult.html"}).state("marksheet.result2",{url:"",templateUrl:"views/br_manager/mg_assessmentResult.html"}).state("marksheet.main",{url:"",templateUrl:"views/br_manager/mg_reportdashbord.html"}).state("transferCertificate",{"abstract":!0,url:"/transferCertificate",template:'<div ui-view style="height:100%"></div>',controller:"transferCertificateCtrl"}).state("transferCertificate.view",{url:"",templateUrl:"views/br_manager/mg_transferCertificate.html"}).state("event",{"abstract":!0,url:"/event",template:'<div ui-view style = "height:100%"></div>',controller:"eventManagementCtrl"}).state("event.list",{url:"",templateUrl:"views/br_manager/mg_eventManagement1.html"}).state("event.add",{url:"",templateUrl:"views/br_manager/mg_addEvent.html"}).state("event.edit",{url:"",templateUrl:"views/br_manager/mg_editEvents.html"}).state("notify",{"abstract":!0,url:"/notify",template:'<div ui-view style = "height:100%"></div>',controller:"notificationCtrl"}).state("notify.sms",{url:"",templateUrl:"views/br_manager/mg_notification.html"}).state("notify.email",{url:"",templateUrl:"views/br_manager/mg_notification.html"}).state("notify.mail",{url:"",templateUrl:"views/br_manager/mg_mailtostudent.html"}).state("notify.mails",{url:"",templateUrl:"views/br_manager/mg_mailtoclassroom.html"}).state("notify.mailsAll",{url:"",templateUrl:"views/br_manager/mg_mailToSchool.html"}).state("notify.mailtofaculty",{url:"",templateUrl:"views/br_manager/mg_mailToFaculty.html"}).state("notify.mailsAllfaculty",{url:"",templateUrl:"views/br_manager/mg_mailToAllFaculty.html"}).state("xlsfiles",{"abstract":!0,url:"/xlsfiles",template:'<div ui-view style = "height:100%"></div>',controller:"fileUploadCtrl"}).state("xlsfiles.files",{url:"",templateUrl:"views/br_manager/mg_spreadsheets.html"}).state("xlsfiles.studentsheet",{url:"",templateUrl:"views/br_manager/mg_spreadsheetStudent.html"}).state("xlsfiles.marksheet",{url:"",templateUrl:"views/br_manager/mg_spreadsheetMarksheet.html"}).state("xlsfiles.facultysheet",{url:"",templateUrl:"views/br_manager/mg_spreadsheetFaculty.html"}).state("xlsfiles.inventarysheet",{url:"",templateUrl:"views/br_manager/mg_spreadsheetInventory.html"}).state("xlsfiles.vehiclesheet",{url:"",templateUrl:"views/br_manager/mg_spreadsheetVehicle.html"}).state("xlsfiles.librarysheet",{url:"",templateUrl:"views/br_manager/mg_spreadsheetLibrary.html"}).state("xlsfiles.logo",{url:"",templateUrl:"views/br_manager/logo.html"}).state("xlsfiles.video",{url:"",templateUrl:"views/br_manager/video.html"}).state("studyCertificate",{"abstract":!0,url:"/study",template:'<div ui-view style="height:100%"></div>',controller:"studyCertificateManagementCtrl"}),d.html5Mode(!0),e.message="Processing ..."}]),branchManager.controller("logoutCtrl",["$scope","$window",function(a,b){a.logout=function(){b.sessionStorage.removeItem("psId"),b.sessionStorage.removeItem("pcId"),b.sessionStorage.removeItem("userId"),b.location="index.html"}}]),branchManager.controller("passwordCtrl",["$scope","branchManagerFactory","$state","$timeout","$window",function(a,b,c,d,e){var f={username:"",oldPassword:"",newPassword:"",confirmPassword:""};a.passwordChange=function(){a.response_msg="",a.response_msg1="",a.add=angular.copy(f)},a.changePassword=function(){var c=e.sessionStorage.getItem("userId");console.log("udi "+c);var d=a.add,f=' { "username":"'+d.username+'","oldPassword" :"'+d.oldPassword+'","newPassword" :"'+d.newPassword+'","confirmPassword" :"'+d.confirmPassword+'"}',g=window.btoa(c),h=b.changePassword(g);h.pass({},f,function(a){200==a.status&&(alert("Password Changed successfully!!!"),e.location="index.html")},function(b){409==b.status?a.response_msg1=b.data.errorMessage:a.response_msg1="Password change is unsuccessful !!!"})},a.cancel=function(){a.response_msg="",a.response_msg1="",c.go("dash")}}]),branchManager.controller("dialogeCtrl",["$scope","$modalInstance","data",function(a,b,c){null==c.title?a.message=c.message:null==c.message?a.title=c.title:(a.message=c.message,a.title=c.title),a.ok=function(){b.close(!0)},a.cancel=function(){b.dismiss("cancel")},a.close=function(){b.close(!1)}}]),branchManager.factory("dashFactory",["$resource","br_Manager_Config","$window",function(a,b,c){var d={},e=b.getAssetAPI(),f=b.getMainAPI(),g=c.localStorage.getItem("authCode");return d.fetchAssetList=function(){return a(e,{},{fetch:{method:"get",isArray:!1,headers:{Authorization:g},interceptor:{response:function(a){return a}}}})},d.vehiclegrowth=function(){return a(f+"/dashboard/numberoFvehicales",{},{fetch:{method:"get",isArray:!1,headers:{Authorization:g},interceptor:{response:function(a){return a}}}})},d.facultygrowth=function(){return a(f+"/dashboard/numberoFfaculties",{},{fetch:{method:"get",isArray:!1,headers:{Authorization:g},interceptor:{response:function(a){return a}}}})},d.fetchAdmissionsCount=function(){return a(f+"/dashboard/newadmissions",{},{fetch:{method:"get",isArray:!1,headers:{Authorization:g},interceptor:{response:function(a){return a}}}})},d}]),branchManager.controller("dashCtrl",["$scope","$interval","dashFactory",function(a,b,c){function d(){c.vehiclegrowth().fetch({},function(b){if(a.data1=[],(200==b.status||201==b.status)&&void 0!=b.data.vehicales.length){var c=angular.fromJson(b.data.vehicales);a.data1=c}},function(b){a.data1=[],console.log(b.status)})}function e(){c.facultygrowth().fetch({},function(b){if(a.faculty_info=[],(200==b.status||201==b.status)&&void 0!=b.data.facultyListWithYear.length){var c=angular.fromJson(b.data.facultyListWithYear);a.data=c}},function(b){a.faculty_info=[],console.log(b.status)})}function f(){c.fetchAdmissionsCount().fetch({},function(b){if(a.chart_info=[],200==b.status&&void 0!=b.data){var c=angular.fromJson(b.data);a.chart_info=c,a.values=a.chart_info.studentCountWithYearDTO}},function(b){a.chart_info=[],console.log(b.status)})}a.fetchAssetList=function(){a.response_msg="",c.fetchAssetList().fetch({},function(b){if(console.log(b),a.asset_info=[],200==b.status&&void 0!=b.data){var c=angular.fromJson(b.data);a.asset_info=c}},function(b){a.asset_info=[]})},d(),e(),f()}]),branchManager.directive("pieChart",function(){return{restrict:"E",scope:{data1:"="},link:function(a,b,c){a.$watch("data1",function(a){if(a){var b={top:40,right:5,bottom:20,left:30},c=300-b.left-b.right,d=250-b.top-b.bottom,e=Math.min(c,d)/2,f=d3.scale.ordinal().range(["#ff3300","#0066ff","#009933","#8000ff","#00e6e6","#004080","#b35900"]),g=d3.svg.arc().outerRadius(e-10).innerRadius(0),h=d3.svg.arc().innerRadius(0).outerRadius(e),i=d3.layout.pie().sort(null).value(function(a){return a.vehicleCount}),j=d3.select("#piechart").append("svg").attr("width",c).attr("height",d).append("g").attr("transform","translate("+c/2+","+d/2+")"),k=j.selectAll(".arc").data(i(a)).enter().append("g").attr("class","arc");k.append("path").attr("d",g).style("fill",function(a){return f(a.data.year)}).on("mouseover",function(a){d3.select(this).transition().duration(500).attr("d",h)}).on("mouseout",function(a){d3.select(this).transition().duration(500).attr("d",g)}),k.append("text").attr("transform",function(a){return"translate("+g.centroid(a)+")"}).attr("dy",".35em").style("text-anchor","middle").text(function(a){return a.data.year})}})}}}),branchManager.directive("barChart",function(){return{restrict:"E",scope:{values:"="},link:function(a,b,c){a.$watch("values",function(a){if(a){var b={top:30,right:5,bottom:20,left:30},c=300-b.left-b.right,d=250-b.top-b.bottom,e=5,f=d3.scale.ordinal().range(["#00ff00","#ff9900","#666633","#6666ff","#ff5050","#006699","#993333"]),g=d3.scale.linear().domain([0,a.length]).range([0,c]),h=d3.scale.linear().domain([0,d3.max(a,function(a){return a.studentCount})]).range([d,0]),i=(d3.svg.axis().scale(g).orient("bottom"),d3.tip().attr("class","d3-tip").offset([-10,0]).html(function(a){return"<strong>Student Count:</strong> <span style='color:red'>"+a.studentCount+"</span><br/><strong>Year:</strong> <span style='color:red'>"+a.year+"</span>"})),j=d3.select("#barchart").append("svg").attr("width",c+b.left+b.right).attr("height",d+b.top+b.bottom).attr("id","barChartPlot");j.call(i);var k=j.append("g").attr("transform","translate("+b.left+","+b.top+")");k.selectAll("rect").data(a).enter().append("rect").attr("x",function(a,b){return g(b)}).on("mouseover",i.show).on("mouseout",i.hide).attr("width",c/a.length-e).attr("height",0).transition().duration(2e3).delay(function(a,b){return 50*b}).attr("y",function(a){return h(a.studentCount)}).attr("height",function(a){return d-h(a.studentCount)}).attr("fill",function(a){return f(a.year)}),k.selectAll("text").data(a).enter().append("text").text(function(a){return a.studentCount}).attr("text-anchor","middle").attr("x",function(b,d){return d*(c/a.length)+(c/a.length-e)/2}).attr("y",function(a){return h(a.studentCount)+14}).attr("class","yAxis");var l=j.append("g").attr("transform","translate("+b.left+","+(b.top+d)+")");l.selectAll("text.xAxis").data(a).enter().append("text").text(function(a){return a.year}).attr("text-anchor","middle").attr("x",function(b,d){return d*(c/a.length)+(c/a.length-e)/2}).attr("y",15).style("fill","#000").attr("class","xAxis")}})}}}),branchManager.directive("donutChart",function(){return{restrict:"E",scope:{data:"="},link:function(a,b,c){a.$watch("data",function(a){if(a){console.log("data from directive: ",a);var b={top:40,right:5,bottom:20,left:30},c=300-b.left-b.right,d=250-b.top-b.bottom,e=Math.min(c,d)/2,f=d3.scale.ordinal().range(["#0000ff","#ff3300","#00ff00","#ff00ff","#ff0080","#6600ff","#ff5500"]),g=d3.svg.arc().outerRadius(e-10).innerRadius(e/2),h=d3.svg.arc().innerRadius(e/2-15).outerRadius(e-10),i=d3.layout.pie().sort(null).value(function(a){return a.facultyCount}),j=d3.select("#donutchart").append("svg").attr("width",c).attr("height",d).append("g").attr("transform","translate("+c/2+","+d/2+")"),k=j.selectAll(".arc").data(i(a)).enter().append("g").attr("class","arc");k.append("path").attr("d",g).style("fill",function(a){return f(a.data.year)}).on("mouseover",function(a){d3.select(this).transition().duration(500).attr("d",h)}).on("mouseout",function(a){d3.select(this).transition().duration(500).attr("d",g)}),k.append("text").attr("transform",function(a){return"translate("+g.centroid(a)+")"}).attr("dy",".35em").style("text-anchor","middle").text(function(a){return a.data.facultyCount})}})}}}),branchManager.directive("lineChart",function(){return{restrict:"E",scope:{values:"="},link:function(a,b,c){a.$watch("values",function(a){if(a){var a=[{studentCount:"102",year:"2000"},{studentCount:"215",year:"2001"},{studentCount:"179",year:"2002"},{studentCount:"199",year:"2003"},{studentCount:"134",year:"2003"},{studentCount:"176",year:"2010"}],b={top:30,right:5,bottom:20,left:30},c=300-b.left-b.right,d=250-b.top-b.bottom,e=d3.scale.linear().range([b.left,c-b.right]).domain([2e3,2010]),f=d3.scale.linear().range([d-b.top,b.bottom]).domain([0,d3.max(a,function(a){return a.studentCount})]),g=d3.svg.axis().scale(e).ticks(5),h=d3.svg.axis().scale(f).orient("left"),i=d3.select("#linechart").append("svg").attr("width",c).attr("height",d);i.append("g").attr("class","axis").attr("transform","translate(0,"+(d-b.bottom)+")").call(g),i.append("g").attr("class","axis").attr("transform","translate("+b.left+",0)").call(h);var j=d3.svg.line().x(function(a){return e(a.year)}).y(function(a){return f(a.studentCount)}).interpolate("basis");i.append("path").attr("d",j(a)).attr("stroke","green").attr("stroke-width",2).attr("fill","none")}})}}}),branchManager.factory("classroomFactory",["$resource","br_Manager_Config","$window",function(a,b,c){var d={},e=b.getMainAPI(),f=c.localStorage.getItem("authCode");return d.assignFaculty=function(b,c){return a(e+"/faculty/"+b+"/classRoom/"+c,{},{assign:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d.removeTeacher=function(b){return a(e+"/classroom/"+b+"/faculty",{},{remove:{method:"delete",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d.getFacultyList=function(){return a(e+"/faculty/getFacultyId",{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d.listSubjects=function(b){return a(e+"/subject/classroom/"+b,{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d.fetchClassroomPdfReport=function(b){return a(e+"/classroom/reports/year/"+b,{},{fetch:{method:"get",responseType:"arraybuffer",headers:{Authorization:f},interceptor:{response:function(a){return console.log("Report Generated for Vehicle !!!"),a}}}})},d.createClassroom=function(){return console.log(f),a(e+"/classroom",{},{add:{method:"POST",headers:{Authorization:f,"Content-Type":"application/json"},isArray:!1,interceptor:{response:function(a){return console.log("inside createClassroom !!!"),a}}}})},d.fetchStandardList=function(b){return a(e+"/classroom/year/"+b,{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d.fetchSectionList=function(b,c){return a(e+"/classroom/standard/"+b+"/section/year/"+c,{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d.updateClassroom=function(b){return a(e+"/classroom/"+b+"/update",{},{edit:{method:"PUT",headers:{Authorization:f,"Content-Type":"application/json"},isArray:!1,interceptor:{response:function(a){return console.log("update success!!!!"),a}}}})},d.deleteClassroom=function(b){return console.log("Classroom Id: "+b),a(e+"/classroom/"+b+"/deactivate",{},{remove:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return console.log("deleted success!!!!"),a}}}})},d}]),branchManager.controller("classroomManagementCtrl",["$scope","classroomFactory","br_manager_appConfig","$state","$modal",function(a,b,c,d,e){var f={syllabus:"",section:"",standard:"",year:"",classRoomId:"",maxcount:"",maxCount:""};a.fetchYearList=function(){a.year_list=["2016-17","2017-18","2018-19","2019-20","2020-21"],a.classroom_list=[],a.sub_list=[]},a.fetchStandardList=function(c){a.response_msg="",a.response_msg1="";var d=window.btoa(c);b.fetchStandardList(d).fetch({},function(b){if(a.standard_list=[],(200==b.status||201==b.status)&&void 0!=b.data.standards){var c=angular.fromJson(b.data.standards);a.standard_list=c}},function(b){a.standard_list=[],a.classroom_list=[],a.respnose_msg1="No Classes Found"})},a.fetchSectionList=function(c,d){a.response_msg1="";var e=window.btoa(d),f=window.btoa(c);b.fetchSectionList(f,e).fetch({},function(b){if(a.classroom_list=[],(200==b.status||201==b.status)&&void 0!=b.data.classRoomLists){var c=angular.fromJson(b.data.classRoomLists);a.classroom_list=c,a.$parent.setBaseContentHeight(a.classroom_list.length)}},function(b){a.classroom_list=[],a.response_msg1="No Classrooms Found",a.$parent.setBaseContentHeight(-1)})},a.listSubjects=function(c,d){a.response_msg1="";var e=window.btoa(c.classRoomId);b.listSubjects(e).fetch({},function(b){if(a.sub_list=[],(200==b.status||201==b.status)&&void 0!=b.data.subjects){var c=angular.fromJson(b.data.subjects);a.sub_list=c}},function(b){a.sub_list=[],a.response_msg1="No Subjects Found"})},a.assignClassTeacher=function(b){a.assign=angular.copy(f),angular.forEach(a.classroom_list,function(c){b==c.classRoomId&&(a.assign.classRoomId=c.classRoomId,a.assign.standard=c.standard,a.assign.section=c.section,a.assign.year=c.year,a.getFacultyList())})},a.assignFaculty=function(c,e){a.response_msg1="",a.response_msg="";var c=window.btoa(c),f=window.btoa(e.facultyId);b.assignFaculty(f,c).assign({},function(b){a.classroom_list=[],200!=b.status&&201!=b.status||(a.standard_list=[],a.fetchYearList()),d.go("^.list"),
a.response_msg="Class Teacher assigned successfully !!!."},function(b){a.response_msg1="Class Teacher assigning is  Unsuccessful !!!."})},a.removeTeacher=function(c,d){a.response_msg1="",a.response_msg="";var f=window.btoa(c.classRoomId),g="Are you sure to Remove the Class Teacher ??",h=show_dialoge(e,a,g,"dialoge_content.html");h.result.then(function(d){d?(console.log(c.classRoomId),b.removeTeacher(f).remove({},function(b){200!=b.status&&201!=b.status||(a.standard_list=[],a.fetchYearList(),console.log("deleted")),a.response_msg="Teacher Removed successfully!!!"},function(b){console.log(b.status),404==b.status?a.response_msg1=b.data.errorMessage:a.response_msg1="Removing the class teacher is failed !!!"})):a.response_msg1="Removing the class teacher is failed !!!"})},a.getFacultyList=function(){b.getFacultyList().fetch({},function(b){if(a.faculty_list=[],(200==b.status||201==b.status)&&void 0!=b.data.faculties){var c=angular.fromJson(b.data.faculties);a.faculty_list=c,a.faculty=a.faculty_list[0]}},function(b){a.faculty_list=[],a.response_msg1="No Faculties Found"})},a.syllabus_list={data:[{id:"id1",name:"CBSE"},{id:"id2",name:"ICSE"},{id:"id3",name:"State Syllabus"}]},a.standards=["Pre-Nursery","L.K.G","U.K.G","M0","M1","M2","M3","First","Second","Third","Fourth","Fifth","Sixth","Seventh","Eighth","Ninth","Tenth"],a.addClassroom=function(){a.response_msg="",a.response_msg1="",a.add=angular.copy(f)},a.createClassroom=function(){a.response_msg="",a.response_msg1="";var c=a.add,e=' { "standard":"'+c.standard+'","section" :"'+c.section+'","maxcount" :"'+c.maxcount+'","syllabus" :"'+c.syllabus.name+'","year" :"'+c.year+'"},',f=b.createClassroom();f.add({},e,function(b){200!=b.status&&201!=b.status||(d.go("^.list"),a.fetchYearList()),a.response_msg="Classroom added successfully !!!"},function(b){404==b.status?a.response_msg1=b.data.errorMessage:a.response_msg1="Addition of Classroom is unsuccessful !!!"})},a.editClassroom=function(b){a.edit=angular.copy(f),angular.forEach(a.classroom_list,function(c){b==c.classRoomId&&(a.edit.classRoomId=c.classRoomId,a.edit.standard=c.standard,a.edit.section=c.section,a.edit.maxcount=c.maxCount,a.edit.syllabus=c.syllabus,a.edit.year=c.year)})},a.updateClassroom=function(c){a.response_msg="",a.response_msg1="";var e=a.edit,f=' { "standard":"'+e.standard+'","section" :"'+e.section+'","maxcount" :"'+e.maxcount+'","syllabus" :"'+e.syllabus+'","year" :"'+e.year+'"}',g=window.btoa(c),h=b.updateClassroom(g);h.edit({},f,function(b){200!=b.status&&201!=b.status||(d.go("^.list"),a.fetchYearList()),a.response_msg="Classroom Updated Successfully !!"},function(b){404==b.status?a.response_msg1=b.data.errorMessage:a.response_msg1="Updation of Classroom is unsuccessful !!"})},a.deleteClassroom=function(c,f){a.response_msg="",a.response_msg1="";var g="Are you sure to delete the Classroom ??",h=show_dialoge(e,a,g,"dialoge_content.html");h.result.then(function(e){if(e){var f=window.btoa(c.classRoomId);b.deleteClassroom(f).remove({},function(b){200==b.status&&(a.fetchYearList(),a.response_msg="classroom deleted successfully !!!"),d.go("^.list")},function(b){a.response_msg1="classroom Deletion failed !!!"})}else a.response_msg1="classroom Deletion failed !!!"})},a.$on("$viewContentLoaded",function(){"classroom"==d.current.name&&void 0!=a.classroom_list&&a.$parent.setBaseContentHeight(a.classroom_list.length)}),a.cancel=function(){a.response_msg="",a.response_msg1="",d.go("^.list")}}]),branchManager.controller("classroomReportsCtrl",["$scope","classroomFactory","$state",function(a,b,c){a.fetchYearList=function(){a.year_list=["2016-17","2017-18","2018-19","2019-20","2020-21"]},a.generateClassroomReport=function(c){if(void 0==c)window.alert("Please select the Year");else{var d=window.btoa(c);b.fetchClassroomPdfReport(d).fetch({},function(b){if(a.success=!1,b.status=200)if(b.data.byteLength>0){a.success=!0,console.log("Reponse.data.byteLength = "+b.data.byteLength);var c=new Blob([b.data],{type:"application/pdf"});a.fileURL=URL.createObjectURL(c),a.renderPDF(a.fileURL,document.getElementById("pdf-holder"))}else console.log("Reponse.data.byteLength = "+b.data.byteLength)},function(a){console.log("Error Unable to download the page")})}},a.renderPDF=function(a,b){function c(a){var c=a.getViewport(e),d=document.createElement("canvas"),f=d.getContext("2d"),g={canvasContext:f,viewport:c};d.height=c.height,d.width=c.width,b.appendChild(d),a.render(g)}function d(a){for(var b=1;b<=a.numPages;b++)a.getPage(b).then(c)}var e=1.7;PDFJS.getDocument(a).then(d)},a.downloadPdf=function(){window.open(a.fileURL)},a.back=function(){a.response_msg="",a.response_msg1="",c.go("classroomreports.main")}}]),branchManager.factory("subjectFactory",["$resource","br_Manager_Config","$window",function(a,b,c){var d={},e=b.getMainAPI(),f=c.localStorage.getItem("authCode");return d.fetchSubjectsPdfReport=function(b){return a(e+"/subject/reports/classroom/"+b,{},{fetch:{method:"get",responseType:"arraybuffer",headers:{Authorization:f},interceptor:{response:function(a){return console.log("Report Generated  !!!"),a}}}})},d.fetchStandardList=function(b){return console.log("authorize "+f),a(e+"/classroom/year/"+b,{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d.fetchSectionList=function(b,c){return a(e+"/classroom/standard/"+b+"/section/year/"+c,{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d.createSubject=function(b){return a(e+"/subject",{},{add:{method:"POST",headers:{Authorization:f,"Content-Type":"application/json"},isArray:!1,interceptor:{response:function(a){return console.log("post successful !!"),a}}}})},d.fetchSubjectList=function(b,c){return console.log("authorize "+f),a(e+"/subject/std/"+b+"/syllubus/"+c,{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d.updateSubject=function(b){return console.log("authorize "+f),a(e+"/subject/"+b+"/update",{},{edit:{method:"PUT",headers:{Authorization:f,"Content-Type":"application/json"},isArray:!1,interceptor:{response:function(a){return a}}}})},d.deleteSubject=function(b){return console.log("sub: "+b),a(e+"/subject/"+b+"/deactivate",{},{remove:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return console.log("deleted"),a}}}})},d.assigntoClassroom=function(b,c){return console.log("sub: "+b),a(e+"/subject/"+b+"/classroom/"+c,{},{assign:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return console.log("assigned"),a}}}})},d}]),branchManager.controller("subjectManagementCtrl",["$scope","subjectFactory","br_manager_appConfig","$state","$modal",function(a,b,c,d,e){var f={subjectId:"",year:"",subjectName:"",syllubusType:"",standard:"",subjectCode:"",category:"",type:""};a.subjectDetails={subjectLists:[],numPerPage:25,currentPage:1,startValue:0},a.fetchYearList=function(){a.year_list=["2016-17","2017-18","2018-19","2019-20","2020-21"],a.standard_list=[],a.subjects_list=[]},a.fetchStandardList=function(c){a.response_msg="";var d=window.btoa(c);b.fetchStandardList(d).fetch({},function(b){if(a.standard_list=[],a.subjects_list=[],(200==b.status||201==b.status)&&void 0!=b.data.standards){var c=angular.fromJson(b.data.standards);a.standard_list=c,console.log("standards:- "+a.standard_list)}},function(b){a.standard_list=void 0,a.response_msg1="There is no Standards found for this year.",console.log(b.status)})},a.fetchSectionList=function(c,d){a.response_msg="";var e=window.btoa(c),f=window.btoa(d);b.fetchSectionList(e,f).fetch({},function(b){if(a.classroom_list=[],console.log(b),(200==b.status||201==b.status)&&void 0!=b.data.classRoomLists){var c=angular.fromJson(b.data.classRoomLists);a.classroom_list=c}},function(b){a.classroom_list=[],a.response_msg1="No classrooms found for this Standard.",a.$parent.setBaseContentHeight(-1),console.log(b.status)})},a.fetchSyllabusList=function(){a.subjects_list=[],a.syllabus_list=["CBSE","ICSE","State Syllabus"],a.response_msg="",a.response_msg1=""},a.fetchSubjectList=function(c,d){var e=window.btoa(c),f=window.btoa(d);b.fetchSubjectList(e,f).fetch({},function(b){if(a.subjects_list=[],console.log(b),200==b.status&&void 0!=b.data.subjects){var c=angular.fromJson(b.data.subjects);a.subjects_list=c}},function(b){a.subjects_list=void 0,a.response_msg1="Subjects Not Found.",console.log(b.status)})},a.addSubject=function(){a.response_msg="",a.response_msg1="",a.add=angular.copy(f)},a.createSubject=function(c){var e=a.add,f=' { "standard":"'+e.standard+'","subjectName" :"'+e.subjectName+'","syllubusType" :"'+c+'","subjectCode" :"'+e.subjectCode+'","type" :"'+e.type+'","category" :"'+e.category+'"}',g=b.createSubject();g.add({},f,function(b){200!=b.status&&201!=b.status||(d.go("^.list"),a.fetchYearList()),a.response_msg="Subject added successfully !!!"},function(b){a.response_msg1=b.data.errorMessage})},a.assignSubject=function(b){console.log("subjectId "+b),a.response_msg="",a.assign=angular.copy(f),angular.forEach(a.subjects_list,function(c){b==c.subjectId&&(a.assign.subjectId=c.subjectId,a.assign.subjectName=c.subjectName,a.assign.syllubusType=c.syllubusType,a.assign.subjectCode=c.subjectCode,a.assign.standard=c.standard,a.assign.category=c.category,a.assign.year=c.year)})},a.assigntoClassroom=function(c,e){a.response_msg="",a.response_msg1="",console.log("inside assign function !!");var f=window.btoa(c),g=window.btoa(e);b.assigntoClassroom(f,g).assign({},function(b){200==b.status&&(d.go("^.list"),a.fetchYearList()),a.response_msg="Subject assigned successfully !!!"},function(b){a.response_msg1=b.data.errorMessage,console.log(b.status)})},a.editSubject=function(b){console.log("subjectId "+b),a.response_msg="",a.edit=angular.copy(f),angular.forEach(a.subjects_list,function(c){console.log("subject: "+c.subjectId),b==c.subjectId&&(a.edit.subjectId=c.subjectId,a.edit.subjectName=c.subjectName,a.edit.syllubusType=c.syllubusType,a.edit.subjectCode=c.subjectCode,a.edit.standard=c.standard,a.edit.type=c.type,a.edit.category=c.category,a.edit.year=c.year)})},a.updateSubject=function(c){a.response_msg="",a.response_msg1="";var e=a.edit,f=' { "standard":"'+e.standard+'","subjectName" :"'+e.subjectName+'","syllubusType" :"'+e.syllubusType+'","subjectCode" :"'+e.subjectCode+'","type" :"'+e.type+'","category" :"'+e.category+'"}',g=window.btoa(c),h=b.updateSubject(g);h.edit({},f,function(b){200!=b.status&&201!=b.status||(d.go("^.list"),a.fetchYearList()),a.response_msg="Subject updated successfully !!!"},function(b){a.response_msg1=b.data.errorMessage})},a.deleteSubject=function(c,d){a.response_msg="",a.response_msg1="";var f=window.btoa(c.subjectId);console.log("inside delete function !!");var g="Are you sure to delete the Subject ??",h=show_dialoge(e,a,g,"dialoge_content.html");h.result.then(function(d){console.log("Flag value:"+d),d?(console.log(c.subjectId),b.deleteSubject(f).remove({},function(b){200==b.status&&(a.fetchYearList(),console.log("deleted"))},function(b){a.response_msg="Subject assigned to a classroom can't deactivate !!!",console.log(b.status)})):console.log("Failed to delete")})},a.$on("$viewContentLoaded",function(){"subject"==d.current.name&&void 0!=a.subjects_list&&a.$parent.setBaseContentHeight(a.subjects_list.length)}),a.init=function(){a.catogories=["General","Cultural"],a.types=["Academic","General"],a.standards=["Pre-Nursery","L.K.G","U.K.G","M0","M1","M2","M3","First","Second","Third","Fourth","Fifth","Sixth","Seventh","Eighth","Ninth","Tenth"]},a.cancel=function(){a.response_msg="",a.response_msg1="",d.go("^.list")},a.init()}]),branchManager.controller("subjectReportsCtrl",["$scope","subjectFactory","$state",function(a,b,c){a.fetchYearList=function(){a.year_list=["2016-17","2017-18","2018-19","2019-20","2020-21"],a.standard_list=[],a.classroom_list=[]},a.fetchStandardList=function(c){var d=window.btoa(c);b.fetchStandardList(d).fetch({},function(b){if(a.standard_list=[],a.classroom_list=[],console.log(a.standard_list),(200==b.status||201==b.status)&&void 0!=b.data.standards){var c=angular.fromJson(b.data.standards);a.standard_list=c}},function(b){a.standard_list=void 0,console.log(b.status)})},a.fetchSectionList=function(c,d){a.response_msg="";var e=window.btoa(c),f=window.btoa(d);b.fetchSectionList(e,f).fetch({},function(b){if(a.classroom_list=[],console.log(b),(200==b.status||201==b.status)&&void 0!=b.data.classRoomLists){var c=angular.fromJson(b.data.classRoomLists);a.classroom_list=c}},function(b){a.classroom_list=[],a.$parent.setBaseContentHeight(-1),console.log(b.status)})},a.classroomSucjectReport=function(c){console.log("Inside classStudent Report()");var d=window.btoa(c);void 0==c?window.alert("Please Select Year, Class, Section"):b.fetchSubjectsPdfReport(d).fetch({},function(b){if(a.success=!1,b.status=200)if(b.data.byteLength>0){a.success=!0,console.log("response status 200 !!"),console.log("Reponse.data.byteLength = "+b.data.byteLength);var c=new Blob([b.data],{type:"application/pdf"});a.fileURL=URL.createObjectURL(c),a.renderPDF(a.fileURL,document.getElementById("pdf-holder"))}else console.log("Reponse.data.byteLength = "+b.data.byteLength)},function(a){console.log("Error Unable to download the page")})},a.renderPDF=function(a,b){function c(a){var c=a.getViewport(e),d=document.createElement("canvas"),f=d.getContext("2d"),g={canvasContext:f,viewport:c};d.height=c.height,d.width=c.width,b.appendChild(d),a.render(g)}function d(a){for(var b=1;b<=a.numPages;b++)a.getPage(b).then(c)}var e=1.7;console.log("Render PDF !!"),PDFJS.getDocument(a).then(d)},a.downloadPdf=function(){window.open(a.fileURL)},a.back=function(){a.response_msg="",a.response_msg1="",c.go("subjects.main")}}]),branchManager.factory("timeTableFactory",["$resource","br_Manager_Config","$window",function(a,b,c){var d={},e=b.getMainAPI(),f=c.localStorage.getItem("authCode");return d.fetchStandardList=function(b){return a(e+"/classroom/year/"+b,{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d.fetchSectionList=function(b,c){return a(e+"/classroom/standard/"+c+"/section/year/"+b,{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d.fetchTimeTable=function(b){return console.log("class "+b),a(e+"/classRoom/"+b+"/timetable",{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d.createTimeTable=function(b){return console.log("class: "+e+"/classRoom/"+b+"/timetable"),a(e+"/classRoom/"+b+"/timetable",{},{add:{method:"POST",headers:{Authorization:f,"Content-Type":"application/json"},isArray:!1,interceptor:{response:function(a){return console.log("posted successfully"),a}}}})},d.deleteTimetable=function(b){return a(e+"/classRoom/"+b+"/timetable",{},{remove:{method:"Delete",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d}]),branchManager.controller("timeTableCtrl",["$scope","timeTableFactory","br_manager_appConfig","$state","$modal",function(a,b,c,d,e){var f={monday:"",tuesday:"",year:"",wednesday:"",thursday:"",friday:"",saturday:"",subject:"",firstStart:"",secondStart:"",thirdStart:"",fourthStart:"",fifthStart:"",sixthStart:"",seventhStart:"",periodStartTime:"",subjectName1:"",subjectName2:"",subjectName3:"",subjectName4:"",subjectName5:"",subjectName6:"",subjectName7:"",subjectName8:"",subjectName9:"",subjectName10:""};a.timetableDetails={timetable_lists:[],numPerPage:25,currentPage:1,startValue:0},a.fetchYearList=function(){a.year_list=["2016-17","2017-18","2018-19","2019-20","2020-21"]},a.fetchStandardList=function(c){a.response_msg1="",a.response_msg="",a.timetable="",a.section_list=[];var d=window.btoa(c);b.fetchStandardList(d).fetch({},function(b){if(a.standard_list=[],(200==b.status||201==b.status)&&void 0!=b.data.standards){var c=angular.fromJson(b.data.standards);a.standard_list=c,console.log(a.standard_list)}},function(b){a.standard_list="",a.timetable="",a.response_msg1="No classes found for this year.",console.log(b.status)})},a.fetchSectionList=function(c,d){a.response_msg1="",a.timetable="";var e=window.btoa(c),f=window.btoa(d);console.log(c),console.log(c),b.fetchSectionList(e,f).fetch({},function(b){if(a.section_list=[],console.log(b),(200==b.status||201==b.status)&&void 0!=b.data.classRoomLists){var c=angular.fromJson(b.data.classRoomLists);a.section_list=c}},function(b){a.section_List="",a.timetable="",a.response_msg1="No Section found for this standard.",console.log(b.status)})},a.fetchTimeTable=function(c){a.response_msg1="";var d=window.btoa(c.classRoomId);b.fetchTimeTable(d).fetch({},function(b){if(a.timetable={},console.log(b),(200==b.status||201==b.statu)&&void 0!=b.data){var c=angular.fromJson(b.data);console.log(c),a.timetable=c}},function(b){a.response_msg1="No Time Table found for this section.",a.timetable=""})},a.addTimetable=function(){a.response_msg1="",a.add=angular.copy(f),console.log("Initials Copied !!!")},a.createTimeTable=function(c){var e=a.add,f=' { "monday":[{"subject" :"'+e.mon.subjectName1+'","periodStartTime" :"'+e.firstStart+'","periodEndTime" :"'+e.firstEnd+'"},{"subject" :"'+e.mon.subjectName2+'","periodStartTime" :"'+e.secondStart+'","periodEndTime" :"'+e.secondEnd+'"},{"subject" :"'+e.mon.subjectName3+'","periodStartTime" :"'+e.thirdStart+'","periodEndTime" :"'+e.thirdEnd+'"},{"subject" :"'+e.mon.subjectName4+'","periodStartTime" :"'+e.fourthStart+'","periodEndTime" :"'+e.fourthEnd+'"},{"subject" :"'+e.mon.subjectName5+'","periodStartTime" :"'+e.fifthStart+'","periodEndTime" :"'+e.fifthEnd+'"},{"subject" :"'+e.mon.subjectName6+'","periodStartTime" :"'+e.sixthStart+'","periodEndTime" :"'+e.sixthEnd+'"},{"subject" :"'+e.mon.subjectName7+'","periodStartTime" :"'+e.seventhStart+'","periodEndTime" :"'+e.seventhEnd+'"},{"subject" :"'+e.mon.subjectName8+'","periodStartTime" :"'+e.eighthStart+'","periodEndTime" :"'+e.eighthEnd+'"},{"subject" :"'+e.mon.subjectName9+'","periodStartTime" :"'+e.eighthStart+'","periodEndTime" :"'+e.eighthEnd+'"}],"tuesday":[{"subject" :"'+e.tue.subjectName1+'","periodStartTime" :"'+e.firstStart+'","periodEndTime" :"'+e.firstEnd+'"},{"subject" :"'+e.tue.subjectName2+'","periodStartTime" :"'+e.secondStart+'","periodEndTime" :"'+e.secondEnd+'"},{"subject" :"'+e.tue.subjectName3+'","periodStartTime" :"'+e.thirdStart+'","periodEndTime" :"'+e.thirdEnd+'"},{"subject" :"'+e.tue.subjectName4+'","periodStartTime" :"'+e.fourthStart+'","periodEndTime" :"'+e.fourthEnd+'"},{"subject" :"'+e.tue.subjectName5+'","periodStartTime" :"'+e.fifthStart+'","periodEndTime" :"'+e.fifthEnd+'"},{"subject" :"'+e.tue.subjectName6+'","periodStartTime" :"'+e.sixthStart+'","periodEndTime" :"'+e.sixthEnd+'"},{"subject" :"'+e.tue.subjectName7+'","periodStartTime" :"'+e.seventhStart+'","periodEndTime" :"'+e.seventhEnd+'"},{"subject" :"'+e.tue.subjectName8+'","periodStartTime" :"'+e.eighthStart+'","periodEndTime" :"'+e.eighthEnd+'"},{"subject" :"'+e.tue.subjectName9+'","periodStartTime" :"'+e.eighthStart+'","periodEndTime" :"'+e.eighthEnd+'"}],"wednesday":[{"subject" :"'+e.wed.subjectName1+'","periodStartTime" :"'+e.firstStart+'","periodEndTime" :"'+e.firstEnd+'"},{"subject" :"'+e.wed.subjectName2+'","periodStartTime" :"'+e.secondStart+'","periodEndTime" :"'+e.secondEnd+'"},{"subject" :"'+e.wed.subjectName3+'","periodStartTime" :"'+e.thirdStart+'","periodEndTime" :"'+e.thirdEnd+'"},{"subject" :"'+e.wed.subjectName4+'","periodStartTime" :"'+e.fourthStart+'","periodEndTime" :"'+e.fourthEnd+'"},{"subject" :"'+e.wed.subjectName5+'","periodStartTime" :"'+e.fifthStart+'","periodEndTime" :"'+e.fifthEnd+'"},{"subject" :"'+e.wed.subjectName6+'","periodStartTime" :"'+e.sixthStart+'","periodEndTime" :"'+e.sixthEnd+'"},{"subject" :"'+e.wed.subjectName7+'","periodStartTime" :"'+e.seventhStart+'","periodEndTime" :"'+e.seventhEnd+'"},{"subject" :"'+e.wed.subjectName8+'","periodStartTime" :"'+e.eighthStart+'","periodEndTime" :"'+e.eighthEnd+'"},{"subject" :"'+e.wed.subjectName9+'","periodStartTime" :"'+e.eighthStart+'","periodEndTime" :"'+e.eighthEnd+'"}],"thursday":[{"subject" :"'+e.thu.subjectName1+'","periodStartTime" :"'+e.firstStart+'","periodEndTime" :"'+e.firstEnd+'"},{"subject" :"'+e.thu.subjectName2+'","periodStartTime" :"'+e.secondStart+'","periodEndTime" :"'+e.secondEnd+'"},{"subject" :"'+e.thu.subjectName3+'","periodStartTime" :"'+e.thirdStart+'","periodEndTime" :"'+e.thirdEnd+'"},{"subject" :"'+e.thu.subjectName4+'","periodStartTime" :"'+e.fourthStart+'","periodEndTime" :"'+e.fourthEnd+'"},{"subject" :"'+e.thu.subjectName5+'","periodStartTime" :"'+e.fifthStart+'","periodEndTime" :"'+e.fifthEnd+'"},{"subject" :"'+e.thu.subjectName6+'","periodStartTime" :"'+e.sixthStart+'","periodEndTime" :"'+e.sixthEnd+'"},{"subject" :"'+e.thu.subjectName7+'","periodStartTime" :"'+e.seventhStart+'","periodEndTime" :"'+e.seventhEnd+'"},{"subject" :"'+e.thu.subjectName8+'","periodStartTime" :"'+e.eighthStart+'","periodEndTime" :"'+e.eighthEnd+'"},{"subject" :"'+e.thu.subjectName9+'","periodStartTime" :"'+e.eighthStart+'","periodEndTime" :"'+e.eighthEnd+'"}],"friday":[{"subject" :"'+e.fri.subjectName1+'","periodStartTime" :"'+e.firstStart+'","periodEndTime" :"'+e.firstEnd+'"},{"subject" :"'+e.fri.subjectName2+'","periodStartTime" :"'+e.secondStart+'","periodEndTime" :"'+e.secondEnd+'"},{"subject" :"'+e.fri.subjectName3+'","periodStartTime" :"'+e.thirdStart+'","periodEndTime" :"'+e.thirdEnd+'"},{"subject" :"'+e.fri.subjectName4+'","periodStartTime" :"'+e.fourthStart+'","periodEndTime" :"'+e.fourthEnd+'"},{"subject" :"'+e.fri.subjectName5+'","periodStartTime" :"'+e.fifthStart+'","periodEndTime" :"'+e.fifthEnd+'"},{"subject" :"'+e.fri.subjectName6+'","periodStartTime" :"'+e.sixthStart+'","periodEndTime" :"'+e.sixthEnd+'"},{"subject" :"'+e.fri.subjectName7+'","periodStartTime" :"'+e.seventhStart+'","periodEndTime" :"'+e.seventhEnd+'"},{"subject" :"'+e.fri.subjectName8+'","periodStartTime" :"'+e.eighthStart+'","periodEndTime" :"'+e.eighthEnd+'"},{"subject" :"'+e.fri.subjectName9+'","periodStartTime" :"'+e.eighthStart+'","periodEndTime" :"'+e.eighthEnd+'"}],"saturday":[{"subject" :"'+e.sat.subjectName1+'","periodStartTime" :"'+e.firstStart1+'","periodEndTime" :"'+e.firstEnd1+'"},{"subject" :"'+e.sat.subjectName2+'","periodStartTime" :"'+e.secondStart1+'","periodEndTime" :"'+e.secondEnd1+'"},{"subject" :"'+e.sat.subjectName3+'","periodStartTime" :"'+e.thirdStart1+'","periodEndTime" :"'+e.thirdEnd1+'"},{"subject" :"'+e.sat.subjectName4+'","periodStartTime" :"'+e.fourthStart1+'","periodEndTime" :"'+e.fourthEnd1+'"},{"subject" :"'+e.sat.subjectName5+'","periodStartTime" :"'+e.fifthStart1+'","periodEndTime" :"'+e.fifthEnd1+'"},{"subject" :"'+e.sat.subjectName6+'","periodStartTime" :"'+e.fifthStart1+'","periodEndTime" :"'+e.fifthEnd1+'"}]}';console.log("read the inputs !!");var g=window.btoa(c.classRoomId),h=b.createTimeTable(g);console.log("response "+h);h.add({},f,function(b){200!=b.status&&201!=b.status||a.fetchYearList(),d.go("^.list"),a.response_msg="Time Table Added Successfully !!!"},function(b){404==b.status?a.response_msg1=b.data.errorMessage:a.response_msg1="Addition of time table is unsuccessful !!!"})},a.deleteTimetable=function(c){a.response_msg="",a.response_msg1="",console.log(c);var c=window.btoa(c),f="Are you sure to delete the Time Table ??",g=show_dialoge(e,a,f,"dialoge_content.html");g.result.then(function(e){console.log("Flag value:"+e),e?b.deleteTimetable(c).remove({},function(b){console.log(b.status),200!=b.status&&201!=b.status&&204!=b.status||(a.timetable=void 0,a.monday=[],a.tuesday=[],a.wednesday=[],a.thursday=[],a.friday=[],a.saturday=[],console.log("Time Table Deleted successfully"),a.response_msg="Time Table Deleted successfully !!!"),d.go("^.list"),a.response_msg="Time Table Deleted successfully !!!"},function(b){b.data.errorMessage?a.response_msg1=b.data.errorMessage:a.response_msg1="Deletion of time table unsuccessful !!",console.log(b.status)}):console.log("Failed to delete")})},a.init=function(){},a.cancel=function(){a.response_msg="",a.response_msg1="",d.go("^.list")},a.init()}]),branchManager.factory("studentManageFactory",["$resource","br_Manager_Config","$window","$http",function(a,b,c,d){var e={},f=b.getMainAPI(),g=c.localStorage.getItem("authCode");return e.studentPhoto=function(a){return url=f+"/image/student/"+a},e.fetchStudentsPdfReport=function(b){var c;return null!=b&&(c=f+"/student/reports/classroom/"+b),a(c,{},{fetch:{method:"get",responseType:"arraybuffer",headers:{Authorization:g},interceptor:{response:function(a){return a}}}})},e.fetchStandardList=function(b){return a(f+"/classroom/year/"+b,{},{fetch:{method:"get",isArray:!1,headers:{Authorization:g},interceptor:{response:function(a){return a}}}})},e.fetchClassRoomlist=function(b,c){return a(f+"/classroom/standard/"+b+"/section/year/"+c,{},{fetch:{method:"get",isArray:!1,headers:{Authorization:g},interceptor:{response:function(a){return a}}}})},e.fetchSectionList=function(b,c){return a(f+"/classroom/standard/"+c+"/year/"+b+"/sectionnames",{},{fetch:{method:"get",isArray:!1,headers:{Authorization:g},interceptor:{response:function(a){return a}}}})},e.fetchStudents=function(b,c,d,e,h){return a(f+"/student/year/"+b+"/std/"+c+"/sec/"+d+"/students?offset="+e+"&limit="+h,{},{fetch:{method:"get",isArray:!1,headers:{Authorization:g},interceptor:{response:function(a){return a}}}})},e.fetchStudentList=function(b,c,d){return a(f+"/student/year/"+b+"/std/"+c+"/sec/"+d+"/basicinfo",{},{fetch:{method:"get",isArray:!1,headers:{Authorization:g},interceptor:{response:function(a){return a}}}})},e.fetchStudentDetails=function(b){return a(f+"/student/"+b+"/abstract",{},{fetch:{method:"get",isArray:!1,headers:{Authorization:g},interceptor:{response:function(a){return a}}}})},e.validateUsername=function(b){return a(f+"/student/userName/"+b,{},{fetch:{method:"get",isArray:!1,headers:{Authorization:g},interceptor:{response:function(a){return a}}}})},e.fetchPhoto=function(b){return a(f+"/image/student/"+b,{},{fetch:{method:"get",isArray:!1,headers:{Authorization:g},interceptor:{response:function(a){return a}}}})},e.createStudent=function(){return a(f+"/student",{},{add:{method:"POST",headers:{Authorization:g,"Content-Type":"application/json"},isArray:!1,interceptor:{response:function(a){return a}}}})},e.studentReadmission=function(b){return a(f+"/student/"+b+"/readmission",{},{read:{method:"POST",headers:{Authorization:g,"Content-Type":"application/json"},isArray:!1,interceptor:{response:function(a){return a}}}})},e.assignStudentsVehicle=function(b,c){return a(f+"/student/"+b+"/vehicle/"+c+"/assign",{},{assign:{method:"get",isArray:!1,headers:{Authorization:g},interceptor:{response:function(a){return a}}}})},e.getVehicles=function(){return console.log("Autorize: "+g),a(f+"/vehicle/getVehicleIds",{},{fetch:{method:"get",isArray:!1,headers:{Authorization:g},interceptor:{response:function(a){return a}}}})},e.fetchMode=function(b){return console.log("Autorize: "+g),a(f+"/expandfees/classroom/"+b+"/studentfeestructuretype",{},{fetch:{method:"get",isArray:!1,headers:{Authorization:g},interceptor:{response:function(a){return a}}}})},e.choosePaymentMode=function(b){return a(f+"/student/"+b+"/feesmode",{},{add:{method:"POST",headers:{Authorization:g,"Content-Type":"application/json"},isArray:!1,interceptor:{response:function(a){return a}}}})},e}]),branchManager.controller("studentManageCtrl",["$scope","studentManageFactory","br_manager_appConfig","$state","$filter","$modal","fileUpload",function(a,b,c,d,e,f,g){var h={studentId:"",studentFirstName:"",studentLastName:"",dateOfBirth:"",fatherFirstName:"",fatherLastName:"",motherFirstName:"",motherLasttName:"",caste:"",nationality:"",phoneNumber:"",email:"",year:"",rollnumber:"",yearOfJoining:"",classRoomId:"",religion:"",userName:"",password:"",correspondingYear:"",localAddress:"",permanentAddress:"",admissionDate:"",vehicleRegNumber:""};a.studentDetails={studentList:[],numPerPage:10,currentPage:1,startValue:0},a.standards=["Pre-Nursery","L.K.G","U.K.G","M0","M1","M4","M3","First","Second","Third","Fourth","Fifth","Sixth","Seventh","Eighth","Ninth","Tenth"],a.fetchYearList=function(){a.year_list=["2016-17","2017-18","2018-19","2019-20","2020-21"],a.stud="",a.section_list="",a.standard_list="",a.student_list="",a.student_details={}},a.fetchStandardList=function(c){a.response_msg1="",a.response_msg="",a.section_list="",a.student_list="",a.student_details={};var d=window.btoa(c);b.fetchStandardList(d).fetch({},function(b){if(a.standard_list=[],(200==b.status||201==b.status)&&void 0!=b.data.standards){var c=angular.fromJson(b.data.standards);a.standard_list=c}},function(b){a.standard_list=[],a.response_msg1="No Standards found for this year.",console.log(b.status)})},a.fetchSectionList=function(c,d){a.response_msg1="",a.response_msg="";var e=window.btoa(c),f=window.btoa(d);b.fetchSectionList(e,f).fetch({},function(b){if(a.section_list=[],a.student_list=[],a.student_details={},console.log(b),(200==b.status||201==b.status)&&void 0!=b.data.sections){var c=angular.fromJson(b.data.sections);a.section_list=c}},function(b){a.section_List=[],a.response_msg1="No Section found for this standard.",console.log(b.status)})},a.fetchStudents=function(c,d,e,f,g){a.response_msg1="",a.response_msg="";var h=window.btoa(c),i=window.btoa(d),j=window.btoa(e.section);console.log(c+":"+d+":"+e.section),b.fetchStudents(h,i,j,f,g).fetch({},function(b){if(a.student_list=[],a.student_details={},console.log(b),(200==b.status||201==b.status)&&(a.count=b.data.total,console.log(a.count),void 0!=b.data.students)){var c=angular.fromJson(b.data.students);a.student_list=c,a.totalPages=Math.ceil(a.count/a.studentDetails.numPerPage),a.$parent.setBaseContentHeight(a.student_list.length),console.log("data:-"+a.student_list.length)}},function(b){a.student_list=[],a.$parent.setBaseContentHeight(-1),console.log(b.status)})},a.fetchStudentList=function(c,d,e,f,g){a.response_msg1="",a.response_msg="";var h=window.btoa(c),i=window.btoa(d),j=window.btoa(e.section);console.log(c+":"+d+":"+e.section),b.fetchStudentList(h,i,j,f,g).fetch({},function(b){if(a.student_list=[],a.student_details={},console.log(b),(200==b.status||201==b.status)&&void 0!=b.data.students){var c=angular.fromJson(b.data.students);a.student_list=c,console.log("data:-"+a.student_list.length)}},function(b){a.student_list=[],a.response_msg1="No students found for this section.",console.log(b.status)})},a.fetchStudentDetails=function(c){a.response_msg="",a.response_msg1="";var d=window.btoa(c.studentId);b.fetchStudentDetails(d).fetch({},function(b){if(a.student_details={},console.log(b),200==b.status||201==b.status){if(void 0!=b.data){var c=angular.fromJson(b.data);a.student_details=c,a.stud=a.student_details,a.studentId=a.student_details.studentId,a.fname=a.student_details.studentFirstName,a.lname=a.student_details.studentLastName,a.fatherFname=a.student_details.fatherFirstName,a.fatherLname=a.student_details.fatherLastName,a.motherFname=a.student_details.motherFirstName,a.motherLname=a.student_details.motherLastName,a["class"]=a.student_details.currentClass,a.branchName=a.student_details.branchName,a.currentYear=a.student_details.currentYear,a.joiningYear=a.student_details.yearOfJoining,a.phoneNumber=a.student_details.phoneNumbers[0].phoneNumber,a.email=a.student_details.emails[0].email,a.result=a.student_details.promote,a.dob=a.student_details.dob,a.caste=a.student_details.caste,a.religion=a.student_details.religion,a.nationality=a.student_details.nationality,a.rollNumber=a.student_details.rollNumber,a.section=a.student_details.section,a.localAddress=a.student_details.localAddress,a.permanentAddress=a.student_details.permanentAddress,console.log(a.studentId),a.fetchPhoto(a.studentId)}a.student_details=void 0}},function(b){a.student_details=void 0,console.log(b.status)})},a.getVehicles=function(){a.response_msg1="",b.getVehicles().fetch({},function(b){if(a.vehicle_list=[],console.log(b),
(200==b.status||201==b.status)&&void 0!=b.data.vehicles){var c=angular.fromJson(b.data.vehicles);a.vehicle_list=c,a.vehicle=a.vehicle_list[0],console.log(a.vehicle_list)}})},a.assignVehicle=function(b){console.log("class id:"+b),a.response_msg="",a.assign=angular.copy(h),angular.forEach(a.student_list,function(c){b==c.studentId&&(a.assign.studentFirstName=c.studentFirstName,a.assign.studentId=c.studentId,a.assign.standard=c.currentClass,a.assign.year=c.year,a.assign.section=c.section,a.getVehicles())})},a.assignStudentsVehicle=function(c,e){a.response_msg="",a.response_msg1="";var c=window.btoa(c),f=window.btoa(e.vehicleId);b.assignStudentsVehicle(c,f).assign({},function(b){a.classroom_list=[],console.log(b),200!=b.status&&201!=b.status||(d.go("^.list"),a.fetchYearList()),a.response_msg="Student assigned to vehicle successfully !!!."},function(b){a.response_msg1="Student assigning to vehicle is  Unsuccessful !!!."})},a.chooseMode=function(c,d,e){a.name=c.studentFirstName,a.studId=c.studentId;var f=window.btoa(e.classRoomId);b.fetchMode(f).fetch({},function(b){if(a.mode_list=[],console.log(b),(200==b.status||201==b.status)&&void 0!=b.data.feeTypes){var c=angular.fromJson(b.data.feeTypes);a.mode_list=c}},function(a){console.log("errorrrrrr")}),a.add=angular.copy(h)},a.choosePaymentMode=function(c){a.response_msg1="",a.response_msg="";var e=' { "mode" :"'+c+'"}',f=window.btoa(a.studId),g=b.choosePaymentMode(f);g.add({},e,function(b){200!=b.status&&201!=b.status||(d.go("^.list"),a.fetchYearList()),a.response_msg="Fees Mode Added Successfully !!!"},function(b){404==b.status?a.response_msg1=b.data.errorMessage:a.response_msg1="Selecting Fees Mode is unsuccessful !!!"})},a.image=!1,a.fetchPhoto=function(c){a.photo={};var d=window.btoa(c);b.fetchPhoto(d).fetch({},function(b){a.success=!1,console.log(b),console.log("Response length"+b.data.byteLength),200!=b.status&&201!=b.status||(a.photo=b.data,a.image=!0)},function(b){a.image=!1,console.log("errorrrrrr")})},a.validateUsername=function(c){var d=window.btoa(c);b.validateUsername(d).fetch({},function(b){200!=b.status&&201!=b.status||(a.availability="Available !!")},function(b){a.availability=b.data.errorMessage})},a.addStudent=function(){a.response_msg="",a.response_msg1="",a.discountAmount=0,a.add=angular.copy(h)},a.createStudent=function(c,f,g){a.response_msg1="",a.response_msg="";var h=a.add;a.add.dateOfBirth.Value=e("date")(new Date(h.dateOfBirth),"yyyy-MM-dd"),a.add.admissionDate.Value=e("date")(new Date(h.admissionDate),"yyyy-MM-dd");var i=' { "yearOfJoining" :"'+c+'","section" :"'+g.section+'","standard" :"'+f+'","studentFirstName":"'+h.studentFirstName+'","studentLastName" :"'+h.studentLastName+'","dateOfBirth" :"'+a.add.dateOfBirth.Value+'","admissionDate" :"'+a.add.admissionDate.Value+'","discountAmount" :"'+a.discountAmount+'","fatherFirstName" :"'+h.fatherFirstName+'","fatherLastName" :"'+h.fatherLastName+'","motherFirstName" :"'+h.motherFirstName+'","motherLastName" :"'+h.motherLastName+'","localAddress" :"'+h.localAddress+'","permanentAddress" :"'+h.permanentAddress+'","religion" :"'+h.religion+'","nationality" :"'+h.nationality+'","caste" :"'+h.caste+'","correspondingYear" :"'+c+'","classRoomId" :"'+g.classRoomId+'","rollnumber" :"'+h.rollnumber+'","userName" :"'+h.userName+'","password" :"'+h.password+'","emails":[{"email" :"'+h.email+'","type" :"'+h.type+'"}],"phoneNumbers":[{"phoneNumber" :"'+h.phoneNumber+'","type" :"'+h.type+'"}]}';console.log("Inputs read  !!");var j=b.createStudent();j.add({},i,function(b){200!=b.status&&201!=b.status||(a.response_msg="Student Admission successfully !!!",d.go("^.list")),a.response_msg="Student Admission successfully !!!"},function(b){404==b.status?a.response_msg1=b.data.errorMessage:409==b.status?(console.log(b.data),a.response_msg1=b.data):a.response_msg1="Addition of Student is unsuccessful !!!"})},a.readStudent=function(){a.response_msg="",a.response_msg1="",a.discountPercentage=0,a.read=angular.copy(h),console.log("Inside readStudent !!!")},a.studentReadmission=function(c,f){a.response_msg1="",a.response_msg="";var g=a.read;a.read.admissionDate.Value=e("date")(new Date(g.admissionDate),"yyyy-MM-dd"),console.log(a.read.admissionDate.Value);var h=' { "rollnumber" :"'+g.rollnumber+'","correspondingYear" :"'+g.correspondingYear+'","standard" :"'+g.standard+'","discountAmount" :"'+f+'","admissionDate" :"'+a.read.admissionDate.Value+'","section":"'+g.section+'"}',i=window.btoa(c.studentId),j=b.studentReadmission(i);j.read({},h,function(b){200!=b.status&&201!=b.status||d.go("^.list"),a.response_msg="Student Re-Admission Successful !!!"},function(b){404==b.status?a.response_msg1=b.data.errorMessage:a.response_msg1="Re-Admission of Student is unsuccessful !!!"})},a.$on("$viewContentLoaded",function(){"student"==d.current.name&&void 0!=a.student_list&&a.$parent.setBaseContentHeight(a.student_list.length)}),a.init=function(){a.studentDetails.numPerPage=parseInt(a.studentDetails.numPerPage),a.maxSize=5},a.cancel=function(){a.response_msg="",a.response_msg1="",a.photo=[],d.go("sm.list")},a.back=function(){a.response_msg="",a.response_msg1="",a.photo=[],d.go("sm.list")},a.init(),a.pageChanged=function(b,c,d){a.studentDetails.startValue=(a.studentDetails.currentPage-1)*a.studentDetails.numPerPage,a.fetchStudents(b,c,d,a.studentDetails.startValue,a.studentDetails.numPerPage)}}]),branchManager.controller("studentReportsCtrl",["$scope","studentManageFactory","$state",function(a,b,c){a.fetchYearList=function(){a.year_list=["2016-17","2017-18","2018-19","2019-20","2020-21"]},a.fetchStandardList=function(c){var d=window.btoa(c);b.fetchStandardList(d).fetch({},function(b){if(a.classroom_list=[],a.standard_list=[],console.log(a.standard_list),(200==b.status||201==b.status)&&void 0!=b.data.standards){var c=angular.fromJson(b.data.standards);a.standard_list=c,a.standard_list.length>0&&console.log("standard list")}},function(b){a.standard_list=[],console.log(b.status)})},a.fetchClassRoomlist=function(c,d){a.response_msg="";var e=window.btoa(c),f=window.btoa(d);b.fetchClassRoomlist(e,f).fetch({},function(b){if(a.classroom_list=[],console.log(b),(200==b.status||201==b.status)&&void 0!=b.data.classRoomLists){var c=angular.fromJson(b.data.classRoomLists);a.classroom_list=c}},function(b){a.classroom_list=[],console.log(b.status)})},a.generateStudentReport=function(c){console.log("Inside classStudent Report()");var d=window.btoa(c);void 0==c?window.alert("Please Select Year, Class, Section "):b.fetchStudentsPdfReport(d).fetch({},function(b){if(a.success=!1,b.status=200)if(b.data.byteLength>0){a.success=!0,console.log("response status 200 !!"),console.log("Reponse.data.byteLength = "+b.data.byteLength);var c=new Blob([b.data],{type:"application/pdf"});a.fileURL=URL.createObjectURL(c),a.renderPDF(a.fileURL,document.getElementById("pdf-holder"))}else console.log("Reponse Length = "+b.data.byteLength)},function(a){console.log("Error Unable to download the page")})},a.renderPDF=function(a,b){function c(a){var c=a.getViewport(e),d=document.createElement("canvas"),f=d.getContext("2d"),g={canvasContext:f,viewport:c};d.height=c.height,d.width=c.width,b.appendChild(d),a.render(g)}function d(a){for(var b=1;b<=a.numPages;b++)a.getPage(b).then(c)}var e=1.7;console.log("Render PDF !!"),PDFJS.getDocument(a).then(d)},a.downloadPdf=function(){window.open(a.fileURL)},a.back=function(){a.response_msg="",a.response_msg1="",c.go("students.main")}}]),branchManager.factory("studentPromotionFactory1",["$resource","br_Manager_Config","$window",function(a,b,c){var d={},e=b.getMainAPI(),f=c.localStorage.getItem("authCode");return d.checkFeesPaid=function(b,c){return a(e+"/expandfeetransactions/year/"+b+"/student/"+c+"/isFeePaid",{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d.studentPromotion=function(b,c,d,g){return a(e+"/student/"+b+"/studentrecords/standard/"+c+"/section/"+d+"/year/"+g+"/promote",{},{pms:{method:"PUT",headers:{Authorization:f,"Content-Type":"application/json"},isArray:!1,interceptor:{response:function(a){return a}}}})},d.fetchStandardList=function(b){return a(e+"/classroom/year/"+b,{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d.fetchStudentList=function(b,c,d){return a(e+"/student/year/"+b+"/std/"+c+"/sec/"+d+"/basicinfo",{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return console.log("student list got: "),a}}}})},d.fetchSectionList=function(b,c){return a(e+"/classroom/standard/"+c+"/year/"+b+"/sectionnames",{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return console.log("replication"),a}}}})},d.fetchStudentDetails=function(b){return a(e+"/student/"+b+"/abstract",{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d}]),branchManager.controller("studentPromotionsManagementCtrl1",["$scope","studentPromotionFactory1","br_manager_appConfig","$state","$modal",function(a,b,c,d,e){var f={studentFirstName:"",studentLastName:"",dateOfBirth:"",fatherFirstName:"",fatherLastName:"",motherFirstName:"",motherLasttName:"",caste:"",nationality:"",phoneNumber:"",email:"",year:"",yearOfJoining:"",classRoomId:"",religion:"",userName:"",password:"",correspondingYear:"",localAddress:"",permanentAddress:"",rollNumber:"",promote:""};a.studentDetails={studentList:[],numPerPage:25,currentPage:1,startValue:0},a.fetchYearList=function(){a.response_msg="",a.response_msg1="",a.year_list=["2016-17","2017-18","2018-19","2019-20","2020-21"],a.standard_list="",a.section_list="",a.student_list="",a.student_details=""},a.fetchStandardList=function(c){a.response_msg="",a.response_msg1="",a.section_list="",a.student_list="",a.student_details="";var d=window.btoa(c);b.fetchStandardList(d).fetch({},function(b){if(a.standard_list=[],(200==b.status||201==b.status)&&void 0!=b.data.standards){var c=angular.fromJson(b.data.standards);a.standard_list=c}},function(b){a.standard_list=[],a.response_msg1="No Standards found for this year.",console.log(b.status)})},a.fetchSectionList=function(c,d){a.response_msg1="",a.student_list="",a.student_details=void 0;var e=window.btoa(c),f=window.btoa(d);b.fetchSectionList(e,f).fetch({},function(b){if(a.section_list=[],console.log(b),(200==b.status||201==b.status)&&void 0!=b.data.sections){var c=angular.fromJson(b.data.sections);a.section_list=c}},function(b){a.section_List=[],a.response_msg1="No Section found for this standard.",console.log(b.status)})},a.fetchStudentList=function(c,d,e){a.response_msg1="",a.student_details=void 0;var f=window.btoa(c),g=window.btoa(d),h=window.btoa(e.section);b.fetchStudentList(f,g,h).fetch({},function(b){if(a.student_list=[],console.log(b),(200==b.status||201==b.status)&&void 0!=b.data.students){var c=angular.fromJson(b.data.students);console.log("date:"+c),a.student_list=c}},function(b){a.student_list=[],a.response_msg1="Student not found for this Section.",console.log(b.status)})},a.fetchStudentDetails=function(c){var d=window.btoa(c.studentId);b.fetchStudentDetails(d).fetch({},function(b){if(console.log(b),(200==b.status||201==b.status)&&void 0!=b.data){var c=angular.fromJson(b.data);a.student_details=c}},function(b){a.student_details=void 0,console.log(b.status)})},a.promotion=["Yes","No"],a.promoteStudent=function(b){a.promote=a.promotion[0],console.log("studentId "+b),a.response_msg="",a.pms=angular.copy(f),angular.forEach(a.student_list,function(c){console.log("subject: "+c.studentId),b==c.studentId&&(a.pms.studentId=c.studentId,a.pms.Fname=c.studentFirstName,a.pms.Lname=c.studentLastName,a.pms.standard=c.currentClass,a.pms.section=c.section,a.pms.year=c.year)})},a.checkFeesPaid=function(c,d){var e=window.btoa(c),f=window.btoa(d);b.checkFeesPaid(e,f).fetch({},function(b){if(console.log(b),(200==b.status||201==b.status)&&void 0!=b.data){angular.fromJson(b.data);a.response_msg1="Fees Paid You Can Continue To Promote"}},function(b){404==b.status?a.response_msg1=b.data.errorMessage:a.response_msg1="Please Check whether student paid all fees."})},a.studentPromotion=function(c,e,f,g,h){var i=(a.pms,' { "promote":"'+h+'"}'),g=window.btoa(g),e=window.btoa(e),f=window.btoa(f),j=window.btoa(c),k=b.studentPromotion(j,e,f,g);k.pms({},i,function(b){200!=b.status&&201!=b.status||(a.student_details=void 0,d.go("^.list")),a.response_msg="Student Promotion successful !!!"},function(b){409==b.status?a.response_msg1=b.data.errorMessage:404==b.status?a.response_msg1=b.data:a.response_msg1="Student Promotion is unsuccessful !!!"})},a.$on("$viewContentLoaded",function(){"spm"==d.current.name&&void 0!=a.student_list&&a.$parent.setBaseContentHeight(a.student_list.length)}),a.init=function(){a.student_details=void 0},a.cancel=function(){a.response_msg="",a.response_msg1="",d.go("^.list")},a.studentDetails=function(){a.response_msg="",a.response_msg1="",d.go("^.studentdetails")},a.init()}]),branchManager.factory("photoFactory",["$resource","br_Manager_Config","$window","$http",function(a,b,c,d){var e={},f=c.localStorage.getItem("authCode"),g=b.getMainAPI();return e.fetchFacultyList=function(b,c){return a(g+"/faculty?offset="+b+"&limit="+c,{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},e.studentPhoto=function(a){return url=g+"/image/student/"+a},e.fetchStandardList=function(b){return a(g+"/classroom/year/"+b,{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},e.fetchSectionList=function(b,c){return a(g+"/classroom/standard/"+c+"/year/"+b+"/sectionnames",{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},e.fetchStudentList=function(b,c,d){return a(g+"/student/year/"+b+"/std/"+c+"/sec/"+d+"/basicinfo",{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},e.facultyPhoto=function(a,b){var c=new FormData;c.append("file",a),console.log("faculty id "+b),d.post(g+"/image/faculty/"+b,c,{transformRequest:angular.identity,headers:{Authorization:f,"Content-Type":void 0}}).success(function(){alert("Photo uploaded Successfully !!!")}).error(function(){alert("Uploading photo is unsuccessful !!!")})},e.uploadFileToUrl=function(a,b){var c=new FormData;c.append("file",a),console.log("student id "+b),d.post(g+"/image/student/"+b,c,{transformRequest:angular.identity,headers:{Authorization:f,"Content-Type":void 0}}).success(function(){alert("Photo uploaded Successfully !!!")}).error(function(){alert("Uploading photo is unsuccessful !!!")})},e}]),branchManager.directive("fileModel",["$parse",function(a){return{restrict:"A",link:function(b,c,d){var e=a(d.fileModel),f=e.assign;c.bind("change",function(){b.$apply(function(){f(b,c[0].files[0])})})}}}]),branchManager.controller("photoCtrl",["$scope","photoFactory","br_manager_appConfig","$state","$modal","fileUpload",function(a,b,c,d,e,f){a.uploadStudentphoto=function(c){if(a.response_msg="",void 0!=a.studentPhoto){var d=a.studentPhoto;console.log("file is "),console.dir(d);var e=window.btoa(c.studentId);b.uploadFileToUrl(d,e)}else window.alert("Please select the file !!")},a.uploadFacultyPhoto=function(c){if(void 0!=a.facultyPhoto){var d=a.facultyPhoto;console.log("file is "),console.dir(d);var e=window.btoa(c.facultyId);b.facultyPhoto(d,e)}else window.alert("Please select the file !!")},a.facultyDetails={facultyList:[],numPerPage:25,currentPage:1,startValue:0},a.fetchFacultyList=function(c,d){a.response_msg="",b.fetchFacultyList(c,d).fetch({},function(b){if(a.faculty_list=[],console.log(b),200==b.status&&(a.count=b.data.total,void 0!=b.data.faculties)){var c=angular.fromJson(b.data.faculties);a.faculty_list=c}},function(b){a.faculty_list=[],a.$parent.setBaseContentHeight(-1),console.log(b.status)})},a.fetchYearList=function(){a.year_list=["2016-17","2017-18","2018-19","2019-20","2020-21"]},a.fetchStandardList=function(c){a.response_msg="";var d=window.btoa(c);b.fetchStandardList(d).fetch({},function(b){if(a.standard_list=[],(200==b.status||201==b.status)&&void 0!=b.data.standards){var c=angular.fromJson(b.data.standards);a.standard_list=c}},function(b){a.standard_list=[],a.response_msg="No Standards found for this year.",console.log(b.status)})},a.fetchSectionList=function(c,d){console.log(c+" "+d);var e=window.btoa(c),f=window.btoa(d);b.fetchSectionList(e,f).fetch({},function(b){if(a.section_list=[],(200==b.status||201==b.status)&&void 0!=b.data.sections){var c=angular.fromJson(b.data.sections);a.section_list=c,a.section_list.length>0}},function(b){a.section_list=[],a.response_msg="No classrooms found for this standard.",console.log(b.status)})},a.fetchStudentList=function(c,d,e){var f=window.btoa(c),g=window.btoa(d),h=window.btoa(e.section);b.fetchStudentList(f,g,h).fetch({},function(b){if(a.student_list=[],console.log(b),(200==b.status||201==b.status)&&void 0!=b.data.students){var c=angular.fromJson(b.data.students);a.student_list=c}},function(b){a.student_list=[],a.response_msg="Students Not found"})}}]),branchManager.factory("feeManagementFactory",["$resource","br_Manager_Config","$window",function(a,b,c){var d={},e=b.getMainAPI(),f=c.localStorage.getItem("authCode");return d.fetchStandardList=function(b){return a(e+"/classroom/year/"+b,{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d.fetchClassRoomlist=function(b,c){return a(e+"/classroom/standard/"+c+"/section/year/"+b,{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d.assignFeeClassroom=function(b,c){return a(e+"/expandfees/"+c+"/classroom/"+b+"/feestructure",{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d.fetchSectionList=function(b,c){return a(e+"/classroom/standard/"+b+"/section/year/"+c,{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d.fetchFeesPdfReport=function(b){return a(e+"/feesstruture/reports/classroom/"+b+"/feeStructure",{},{fetch:{method:"get",responseType:"arraybuffer",headers:{Authorization:f},interceptor:{response:function(a){return console.log("Response recieved !!!"),a}}}})},d.fetchFeeList=function(b){return a(e+"//expandfees/year/"+b+"/feestructuresbasedonmode",{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d.createBranchFees=function(){return a(e+"/expandfees",{},{add:{method:"POST",headers:{Authorization:f,"Content-Type":"application/json"},isArray:!1,interceptor:{response:function(a){return console.log("posting  branch fees successful!!!"),a}}}})},d.addOneTimeFees=function(b){return a(e+"/expandfees/feeId/"+b+"/onetimefee",{},{add:{method:"PUT",headers:{Authorization:f,"Content-Type":"application/json"},isArray:!1,interceptor:{response:function(a){return console.log("Update Successful!!"),a}}}})},d.addRecurringFees=function(b){return a(e+"/expandfees/feeId/"+b+"/recuringfees",{},{add:{method:"PUT",headers:{Authorization:f,"Content-Type":"application/json"},isArray:!1,interceptor:{response:function(a){return console.log("Update Successful!!"),a}}}})},d.updateFees=function(b){return a(e+"/expandfees/"+b+"/feestructure",{},{edit:{method:"PUT",headers:{Authorization:f,"Content-Type":"application/json"},isArray:!1,interceptor:{response:function(a){return console.log("Update Successful!!"),a}}}})},d.deleteFee=function(b){return a(e+"/expandfees/feeStructure/"+b+"/deactivatefeeStructure",{},{remove:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d.deactivateRecurringFee=function(b){return a(e+"/expandfees/recurringFee/"+b+"/deActivateRecurringFee",{},{remove:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d.deactivateOneTimeFee=function(b){return a(e+"/expandfees/oneTimeFee/"+b+"/deActivateOneTimeFee",{},{remove:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d}]),branchManager.controller("feeManagementCtrl",["$scope","$filter","feeManagementFactory","br_manager_appConfig","$state","$modal",function(a,b,c,d,e,f){var g={standard:"",admissionFees:"",monthlyFees:"",sportsFees:"",booksFees:"",vanFees:"",feesId:"",year:""};a.fetchYearList=function(){a.year_list=["2016-17","2017-18","2018-19","2019-20","2020-21"],a.fee_list=[],a.syllabus_list=[]},a.fetchFeeList=function(b){a.response_msg="",a.response_msg1="";var d=window.btoa(b);c.fetchFeeList(d).fetch({},function(b){if(a.fee_list=[],console.log(b),(200==b.status||201==b.status)&&void 0!=b.data.feeStructure){var c=angular.fromJson(b.data.feeStructure);a.fee_list=c,a.$parent.setBaseContentHeight(a.fee_list.length)}},function(b){a.fee_list=[],a.$parent.setBaseContentHeight(-1),console.log(b.status)})},a.viewDetails=function(b,c){for(a.feeDetails=a.fee_list[c],a.totalOneTimeFees=0,i=0;i<a.feeDetails.oneTimeFees.length;i++)a.totalOneTimeFees=a.totalOneTimeFees+a.feeDetails.oneTimeFees[i].amount;a.onModeChange=function(b){if(a.rec_list=[],a.totalRecurringFees=0,"Monthly"==b){for(a.rec_list=a.feeDetails.monthyFees,i=0;i<a.feeDetails.monthyFees.length;i++)a.totalRecurringFees=a.totalRecurringFees+a.feeDetails.monthyFees[i].amount*a.feeDetails.monthyFees[i].noOfInstalments;console.log(a.totalRecurringFees)}else if("Quarterly"==b){for(a.rec_list=a.feeDetails.quterlyFees,i=0;i<a.feeDetails.quterlyFees.length;i++)a.totalRecurringFees=a.totalRecurringFees+a.feeDetails.quterlyFees[i].amount*a.feeDetails.quterlyFees[i].noOfInstalments;console.log(a.totalRecurringFees)}else if("Half-Yearly"==b){for(a.rec_list=a.feeDetails.halfYearlyFees,i=0;i<a.feeDetails.halfYearlyFees.length;i++)a.totalRecurringFees=a.totalRecurringFees+a.feeDetails.halfYearlyFees[i].amount*a.feeDetails.halfYearlyFees[i].noOfInstalments;console.log(a.totalRecurringFees)}else if("Yearly"==b){for(a.rec_list=a.feeDetails.yearlyFees,i=0;i<a.feeDetails.yearlyFees.length;i++)a.totalRecurringFees=a.totalRecurringFees+a.feeDetails.yearlyFees[i].amount*a.feeDetails.yearlyFees[i].noOfInstalments;console.log(a.totalRecurringFees)}}},a.addBranchFees=function(){a.response_msg="",a.response_msg1="",a.choices=[{id:"choice1"},{id:"choice2"}],a.modes=[{id:"mode1"},{id:"mode2"}],a.addNewChoice=function(){var b=a.choices.length+1;a.choices.push({id:"choice"+b})},a.removeChoice=function(){var b=a.choices.length-1;a.choices.splice(b)},a.addNewMode=function(){var b=a.modes.length+1;a.modes.push({id:"mode"+b})},a.removeMode=function(){var b=a.modes.length-1;a.modes.splice(b)},a.add=angular.copy(g),console.log("inside addBranchFees")},a.mode_list=["Monthly","Quarterly","Half-Yearly","Yearly"],a.createBranchFees=function(){a.response_msg="",a.response_msg1="";var d=a.add;a.choices.forEach(function(a){delete a.id,a.payByDate=b("date")(new Date(a.payByDate),"yyyy-MM-dd")}),a.modes.forEach(function(a){delete a.id});var f={name:d.feeName,year:d.year,oneTimeFees:a.choices,recurringFees:a.modes},g=c.createBranchFees();g.add({},f,function(b){200!=b.status&&201!=b.status||(e.go("^.list"),a.fetchYearList()),a.response_msg="Fee structure added successfully !!!"},function(b){404==b.status?a.response_msg1=b.data.errorMessage:a.response_msg1="Addition of Fee structure is unsuccessful !!!"})},a.readValues=function(b){a.response_msg="",a.response_msg1="",a.choices=[{id:"choice1"},{id:"choice2"}],a.addNewChoice=function(){var b=a.choices.length+1;a.choices.push({id:"choice"+b})},a.removeChoice=function(){var b=a.choices.length-1;a.choices.splice(b)},a.add=angular.copy(g),a.feesId=b},a.addOneTimeFees=function(d){a.response_msg="",a.response_msg1="",a.choices.forEach(function(a){delete a.id,a.payByDate=b("date")(new Date(a.payByDate),"yyyy-MM-dd")});var f={oneTimeFees:a.choices},g=window.btoa(d),h=c.addOneTimeFees(g);h.add({},f,function(b){200!=b.status&&201!=b.status||(e.go("^.list"),a.fetchYearList()),a.response_msg="One Time Fee Added successfully !!!"},function(b){404==b.status?a.response_msg1=b.data.errorMessage:a.response_msg1="Addition of One Time Fee is unsuccessful !!!"})},a.readRecurringValues=function(b){a.response_msg="",a.response_msg1="",a.modes=[{id:"mode1"},{id:"mode2"}],a.addNewMode=function(){var b=a.modes.length+1;a.modes.push({id:"mode"+b})},a.removeMode=function(){var b=a.modes.length-1;a.modes.splice(b)},a.add=angular.copy(g),a.feesId=b},a.addRecurringFees=function(b){a.response_msg="",a.response_msg1="",a.modes.forEach(function(a){delete a.id});var d={recurringFees:a.modes},f=window.btoa(b),g=c.addRecurringFees(f);g.add({},d,function(b){200!=b.status&&201!=b.status||(e.go("^.list"),a.fetchYearList()),a.response_msg="Recurring Fee Added successfully !!!"},function(b){404==b.status?a.response_msg1=b.data.errorMessage:a.response_msg1="Addition of Recurring Fee is unsuccessful !!!"})},a.editFees=function(b,c){a.response_msg="",a.feeDetails=a.fee_list[c],a.onetime=a.fee_list[c].oneTimeFees,a.rec_monthly=a.feeDetails.monthyFees,a.rec_quaterly=a.feeDetails.quterlyFees,a.rec_half=a.feeDetails.halfYearlyFees,a.rec_year=a.feeDetails.yearlyFees,a.new_list=a.rec_monthly.concat(a.rec_quaterly),a.new_list=a.new_list.concat(a.rec_half),a.new_list=a.new_list.concat(a.rec_year),a.onetime.forEach(function(a){a.payByDate=new Date(a.payByDate)}),a.updateone=a.onetime,a.recurring=a.new_list,console.log("list - "+a.recurring),a.edit=angular.copy(g)},a.updateFees=function(d){a.response_msg="",a.response_msg1="";a.edit;a.updateone.forEach(function(a){a.payByDate=b("date")(new Date(a.payByDate),"yyyy-MM-dd")}),console.log(a.updateone),console.log(a.recurring);var f={name:a.feeDetails.name,year:a.feeDetails.year,oneTimeFees:a.updateone,recurringFees:a.recurring},g=window.btoa(d),h=c.updateFees(g);h.edit({},f,function(b){200!=b.status&&201!=b.status||(e.go("^.list"),a.fetchYearList()),a.response_msg="Fee Structure updated successfully !!!"},function(b){404==b.status?a.response_msg1=b.data.errorMessage:a.response_msg1="Updation of Fee Structure is unsuccessful !!!"})},a.assignFees=function(b,c){a.response_msg="",a.details=a.fee_list[c],a.assign=angular.copy(g),a.assign.feeId=b.feeId,a.assign.name=b.name},a.fetchStandardList=function(b){a.response_msg="";var d=window.btoa(b);c.fetchStandardList(d).fetch({},function(b){if(a.standard_list=[],(200==b.status||201==b.status)&&void 0!=b.data.standards){var c=angular.fromJson(b.data.standards);a.standard_list=c}},function(b){a.standard_list=[],a.response_msg="No Standards found for this year.",console.log(b.status)})},a.fetchClassRoomlist=function(b,d){var e=window.btoa(b),f=window.btoa(d);c.fetchClassRoomlist(e,f).fetch({},function(b){if(a.section_list=[],200==b.status&&void 0!=b.data.classRoomLists){var c=angular.fromJson(b.data.classRoomLists);a.section_list=c}},function(b){a.section_list=[],a.response_msg="No Section found for this standard.",console.log(b.status)})},a.assignFeeClassroom=function(b,d){a.response_msg="",a.response_msg1="";var f=window.btoa(b),g=window.btoa(d.classRoomId);c.assignFeeClassroom(g,f).fetch({},function(b){console.log(b),200==b.status&&(void 0!=b.data&&(e.go("^.list"),a.fetchYearList()),a.response_msg="Assigned Successfully !!!")},function(b){404==b.status?a.response_msg1=b.data.errorMessage:a.response_msg1="Assigning Fee Structure is unsuccessful !!!"})},a.deleteFee=function(b,d){a.response_msg="",a.response_msg1="",console.log("inside delete Fee");var b=window.btoa(b.feeId),g="Are you sure to delete the Fee ??",h=show_dialoge(f,a,g,"dialoge_content.html");h.result.then(function(d){console.log("Flag value:"+d),d?c.deleteFee(b).remove({},function(b){200!=b.status&&201!=b.status||(e.go("^.list"),a.fetchYearList())},function(b){404==b.status?a.response_msg1=b.data.errorMessage:a.response_msg1="Fee Deletion failed !!!",console.log(b.status)}):console.log("Failed to delete")})},a.deactivateRecurringFee=function(b,d){a.response_msg="",a.response_msg1="",console.log("inside delete Fee");var g=window.btoa(b.recurringId),h="Are you sure to delete the Fee ??",i=show_dialoge(f,a,h,"dialoge_content.html");i.result.then(function(b){console.log("Flag value:"+b),b?c.deactivateRecurringFee(g).remove({},function(b){200!=b.status&&201!=b.status||(e.go("^.list"),a.fetchYearList(),a.response_msg1="Recurring Fee Deactivated !!!")},function(b){404==b.status?a.response_msg1=b.data.errorMessage:a.response_msg1="Recurring Fee Deletion failed !!!",console.log(b.status)}):console.log("Failed to delete")})},a.deactivateOneTimeFee=function(b,d){a.response_msg="",a.response_msg1="",console.log("inside delete Fee");var g=window.btoa(b.oneTimeFeeId),h="Are you sure to delete the One Time Fee ??",i=show_dialoge(f,a,h,"dialoge_content.html");i.result.then(function(b){console.log("Flag value:"+b),b?c.deactivateOneTimeFee(g).remove({},function(b){200!=b.status&&201!=b.status||(e.go("^.list"),a.response_msg1="One Time Fee Deactivated !!!",a.fetchYearList())},function(b){404==b.status?a.response_msg1=b.data.errorMessage:a.response_msg1="One Time Fee Deactivation failed !!!",console.log(b.status)}):console.log("Failed to delete")})},a.cancel=function(){a.response_msg="",a.response_msg1="",e.go("^.list")},a.init=function(){},a.init()}]),branchManager.controller("feeStructureReportsCtrl",["$scope","feeManagementFactory","$state",function(a,b,c){a.fetchYearList=function(){a.year_list=["2016-17","2017-18","2018-19","2019-20","2020-21"]},a.fetchStandardList=function(c){a.response_msg="";var d=window.btoa(c);b.fetchStandardList(d).fetch({},function(b){if(a.standard_list=[],(200==b.status||201==b.status)&&void 0!=b.data.standards){var c=angular.fromJson(b.data.standards);a.standard_list=c}},function(b){a.standard_list=[],a.response_msg="No Standards found for this year.",console.log(b.status)})},a.fetchClassRoomlist=function(c,d){var e=window.btoa(c),f=window.btoa(d);b.fetchClassRoomlist(e,f).fetch({},function(b){if(a.section_list=[],console.log(b),200==b.status&&void 0!=b.data.classRoomLists){var c=angular.fromJson(b.data.classRoomLists);a.section_list=c}},function(b){a.section_list=[],a.response_msg="No Section found for this standard.",console.log(b.status)})},a.generateFeesReport=function(c){if(void 0==c)window.alert("Please Select Year, Class, Section");else{console.log(c.classRoomId);var d=window.btoa(c.classRoomId);b.fetchFeesPdfReport(d).fetch({},function(b){if(a.success=!1,b.status=200)if(b.data.byteLength>0){a.success=!0,console.log("response status = 0");var c=new Blob([b.data],{type:"application/pdf"});a.fileURL=URL.createObjectURL(c),a.renderPDF(a.fileURL,document.getElementById("pdf-holder"))}else console.log("Reponse.data.byteLength = "+b.data.byteLength)},function(a){alert("Error Unable to download the page")})}},a.renderPDF=function(a,b){function c(a){var c=a.getViewport(e),d=document.createElement("canvas"),f=d.getContext("2d"),g={canvasContext:f,viewport:c};d.height=c.height,d.width=c.width,b.appendChild(d),a.render(g)}function d(a){for(var b=1;b<=a.numPages;b++)a.getPage(b).then(c)}var e=1.7;console.log("Render PDF !!"),PDFJS.getDocument(a).then(d)},a.downloadPdf=function(){window.open(a.fileURL)},a.back=function(){a.response_msg="",a.response_msg1="",c.go("feeReport.main")}}]),branchManager.factory("feeTransactionFactory",["$resource","br_Manager_Config","$window",function(a,b,c){var d={},e=b.getMainAPI(),f=c.localStorage.getItem("authCode");return d.fetchStandardList=function(b){return a(e+"/classroom/year/"+b,{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d.fetchClassRoomlist=function(b,c){return a(e+"/classroom/standard/"+c+"/section/year/"+b,{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d.fetchStudentList=function(b,c,d){return a(e+"/student/year/"+b+"/std/"+c+"/sec/"+d+"/basicinfo",{},{fetch:{method:"get",isArray:!1,
headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d.fetchTransactionList=function(b){return a(e+"/expandfeetransactions/year/"+b+"/branchfeestructures",{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d.fetchStudentFeeList=function(b,c){return a(e+"/expandfeetransactions/year/"+b+"/student/"+c+"/studentfeestructures",{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d.fecthfeeMode=function(b){return a(e+"/student/"+b+"/feesmodes",{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d.festchStudentFeesStructure=function(b,c){return a(e+"/expandfees/student/"+c+"/studentfeestructure",{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d.createFeesTransaction=function(b){return a(e+"/expandfeetransactions/student/"+b,{},{add:{method:"POST",isArray:!1,headers:{Authorization:f,"Content-Type":"application/json"},interceptor:{response:function(a){return console.log("posting of fees transaction !!!"),a}}}})},d.deleteTransaction=function(b,c){return a(e+"/student/"+c+"/feestransactions/"+b,{},{remove:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d}]),branchManager.controller("feeTransactionCtrl",["$scope","feeTransactionFactory","br_manager_appConfig","$state","$modal",function(a,b,c,d,e){var f={admissionFees:"",academicYear:"",transactionId:"",amount:"",transactionDate:"",studentId:"",standard:"",section:"",periodicity:"",period:""};a.transaction_type=["One Time Fees","Recurring Fees"],a.payment_type=["Cash","Cheque","Demand Draft","Other"],a.fetchYearList=function(){a.year_list=["2016-17","2017-18","2018-19","2019-20","2020-21"],a.standard_list=[],a.section_list=[],a.student_list=[],a.fee_list=[]},a.fetchStandardList=function(c){a.response_msg="";var d=window.btoa(c);b.fetchStandardList(d).fetch({},function(b){if(a.standard_list=[],a.section_list=[],a.student_list=[],a.fee_list=[],(200==b.status||201==b.status)&&void 0!=b.data.standards){var c=angular.fromJson(b.data.standards);a.standard_list=c}},function(b){a.standard_list=[],a.response_msg="No Standards found for this year.",console.log(b.status)})},a.fetchClassRoomlist=function(c,d){var e=window.btoa(c),f=window.btoa(d);b.fetchClassRoomlist(e,f).fetch({},function(b){if(a.section_list=[],a.student_list=[],a.fee_list=[],console.log(b),200==b.status&&void 0!=b.data.classRoomLists){var c=angular.fromJson(b.data.classRoomLists);a.section_list=c}},function(b){a.section_list=[],a.response_msg="No Section found for this standard.",console.log(b.status)})},a.fetchStudentList=function(c,d,e){var f=window.btoa(c),g=window.btoa(d),h=window.btoa(e.section);b.fetchStudentList(f,g,h).fetch({},function(b){if(a.student_list=[],a.fee_list=[],console.log(b),(200==b.status||201==b.status)&&void 0!=b.data.students){var c=angular.fromJson(b.data.students);a.student_list=c}},function(b){a.student_list=[],a.response_msg=" Studentds not found for this section.",console.log(b.status)})},a.fetchTransactionList=function(c){a.response_msg="";var d=window.btoa(c);b.fetchTransactionList(d).fetch({},function(b){if(console.log(b),200==b.status&&void 0!=b.data.transactions){var c=angular.fromJson(b.data.transactions);a.fee_list=c,a.$parent.setBaseContentHeight(a.fee_list.length)}},function(b){a.fee_list=[],a.$parent.setBaseContentHeight(-1),console.log(b.status)})},a.fetchStudentFeeList=function(c,d){a.response_msg="",a.response_msg1="";var e=window.btoa(c),f=window.btoa(d.studentId);b.fetchStudentFeeList(e,f).fetch({},function(b){if(console.log(b),200==b.status&&void 0!=b.data.transactions){var c=angular.fromJson(b.data.transactions);a.fee_list=c,a.$parent.setBaseContentHeight(a.fee_list.length)}},function(b){a.fee_list=[],a.$parent.setBaseContentHeight(-1),console.log(b.status)})},a.viewTransaction=function(b,c){a.trans_list=b.feeDetails,console.log(b),console.log(a.trans_list)},a.festchStudentFeesStructure=function(c,d){var e=window.btoa(d.studentId),c=window.btoa(c);b.festchStudentFeesStructure(c,e).fetch({},function(b){if(console.log(b),a.structure_list,(200==b.status||201==b.status)&&void 0!=b.data){var c=angular.fromJson(b.data);a.structure_list=c,a.onetime_type=a.structure_list.oneTimeFees,a.recurring_type=a.structure_list.recurringFees}},function(b){a.structure_list=[]})},a.getDetails=function(b){console.log(b),a.onetimes=b.oneTimeFees,a.recurrings=b.recurringFees},a.addFeesTransaction=function(){a.response_msg="",a.response_msg1="",a.installments=function(b){a.installment_list=b.installmentDetails},a.otfs=[],a.modes=[],a.addOneTime=function(){var b=a.otfs.length+1;a.otfs.push({id:"otf"+b,mode:"OneTimeFee",type:""})},a.removeOneTime=function(){var b=a.otfs.length-1;a.otfs.splice(b)},a.addNewMode=function(){var b=a.modes.length+1;a.modes.push({id:"mode"+b,type:""})},a.removeMode=function(){var b=a.modes.length-1;a.modes.splice(b)},a.add=angular.copy(f)},a.createFeesTransaction=function(c,e,f){a.response_msg="",a.response_msg1="",a.otfs.forEach(function(a){delete a.id,a.type=a.feeId.type,a.feeId=a.feeId.oneTimeFeeId}),a.modes.forEach(function(a){delete a.id,a.type=a.feeId.type,a.feeId=a.feeId.recurringId,a.mode=a.mode.mode}),a.transaction=a.modes.concat(a.otfs);var g=a.add,h={year:e,paymentDetails:g.paymentDetails,modeOfpayment:f,receivedBy:g.recievedBy,receiptId:g.recieptId,feeDetails:a.transaction},c=window.btoa(c.studentId),i=b.createFeesTransaction(c);i.add({},h,function(b){200!=b.status&&201!=b.status||d.go("^.lists"),a.response_msg="Fee transaction complete !!!"},function(b){404==b.status?a.response_msg1=b.data.errorMessage:a.response_msg1="Fee Transaction incomplete !!!"})},a.deleteTransaction=function(c,d){a.response_msg="",a.response_msg1="";var f=window.btoa(c.studentId),g=window.btoa(c.transactionId),h="Are you sure to delete the Transaction ??",i=show_dialoge(e,a,h,"dialoge_content.html");i.result.then(function(d){d?(console.log(c.transactionId),b.deleteTransaction(g,f).remove({},function(b){200==b.status&&a.fetchYearList()},function(b){a.response_msg1="Fee Transaction Deletion Failed !!"})):console.log("Failed to delete")})},a.cancel=function(){a.response_msg="",a.response_msg1="",a.structure_list="",d.go("feeTran.lists")},a.init=function(){a.structure_list=""},a.init()}]),branchManager.factory("facultyManagementFactory",["$resource","br_Manager_Config","$window",function(a,b,c){var d={},e=b.getMainAPI(),f=c.localStorage.getItem("authCode");return d.fetchLeaveList=function(b,c,d){return a(e+"/facultyleave/year/"+b+"/newState?offset="+c+"&limit="+d,{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d.rejectLeave=function(b,c){return a(e+"/facultyleave/"+b+"/state/"+c+"/approvalorrejected",{},{remove:{method:"put",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d.approveLeave=function(b,c){return a(e+"/facultyleave/"+b+"/state/"+c+"/approvalorrejected",{},{remove:{method:"put",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d.fetchPhoto=function(b){return a(e+"/image/faculty/"+b,{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d.validateUsername=function(b){return a(e+"/faculty/userName/"+b,{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d.fetchClassrooms=function(b){return a(e+"/faculty/"+b+"/getClassRooms",{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d.fetchFacultyList=function(b,c){return a(e+"/faculty?offset="+b+"&limit="+c,{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d.fetchFacultyPdfReport=function(){return a(e+"/faculty/reports",{},{fetch:{method:"get",responseType:"arraybuffer",headers:{Authorization:f},interceptor:{response:function(a){return console.log("Report Generated !!!"),a}}}})},d.updateFacultyEntry=function(b){return a(e+"/faculty/"+b,{},{edit:{method:"PUT",headers:{Authorization:f,"Content-Type":"application/json"},isArray:!1,interceptor:{response:function(a){return a}}}})},d.deleteFaculty=function(b){return console.log("Id: "+b),a(e+"/faculty/"+b+"/deactivate",{},{remove:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return console.log("Data: "+a),a}}}})},d.createFacultyEntry=function(){return a(e+"/faculty",{},{add:{method:"POST",headers:{Authorization:f,"Content-Type":"application/json"},isArray:!1,interceptor:{response:function(a){return console.log("data posted successfully !!"),a}}}})},d}]),branchManager.controller("facultyManagementCtrl",["$scope","facultyManagementFactory","br_manager_appConfig","$state","$filter","$modal",function(a,b,c,d,e,f){var g={firstName:"",lastName:"",qualification:"",dateOfJoining:"",dateOfBirth:"",comments:"",emails:"",phoneNumber:"",phoneNumbers:"",fatherFirstName:"",fatherlastName:"",emailType:"",phoneNumberType:"",email:"",localAddress:"",permanentAddress:""};a.facultyDetails={facultyList:[],numPerPage:10,currentPage:1,startValue:0},a.fetchFacultyList=function(c,d){a.response_msg1="",b.fetchFacultyList(c,d).fetch({},function(b){if(a.faculty_list=[],console.log(b),200==b.status&&(a.count=b.data.total,void 0!=b.data.faculties)){var c=angular.fromJson(b.data.faculties);a.faculty_list=c,a.totalPages=Math.ceil(a.count/a.facultyDetails.numPerPage),a.$parent.setBaseContentHeight(a.faculty_list.length)}},function(b){a.faculty_list=[],a.$parent.setBaseContentHeight(-1),console.log(b.status)})},a.fetchFacultyInfo=function(b){console.log("facultyId "+b),a.response_msg="",a.info={},a.classrooms=[],angular.forEach(a.faculty_list,function(c){b==c.facultyId&&(a.info=c,a.classrooms=a.fetchClassrooms(b),a.fetchPhoto(a.info.facultyId))})},a.image=!1,a.fetchPhoto=function(c){a.photo=[];var d=window.btoa(c);b.fetchPhoto(d).fetch({},function(b){a.success=!1,console.log(b),console.log("Response length"+b.data.byteLength),(b.status=200)&&(a.photo=b.data,a.image=!0)},function(b){a.image=!1,console.log("errorrrrrr")})},a.fetchClassrooms=function(c){var d=[],e=window.btoa(c);console.log(c),b.fetchClassrooms(e).fetch({},function(b){if(console.log(b),b.status=200){if(void 0!=b.data.classRoomLists){var c=angular.fromJson(b.data.classRoomLists);a.classes=c,console.log(a.classes)}return d}},function(a){console.log("errorrrrrr")})},a.validateUsername=function(c){var d=window.btoa(c);b.validateUsername(d).fetch({},function(b){200!=b.status&&201!=b.status||(a.availability="Available !!")},function(b){a.availability=b.data.errorMessage})},a.addFacultyEntry=function(){a.response_msg="",a.response_msg1="",a.noOfExperience=0,a.add=angular.copy(g),console.log("inside addFacultyEntry !!")},a.createFacultyEntry=function(){var c=a.add;a.add.dateOfJoining.Value=e("date")(new Date(c.dateOfJoining),"yyyy-MM-dd"),a.add.dateOfBirth.Value=e("date")(new Date(c.dateOfBirth),"yyyy-MM-dd");var f=' { "firstName":"'+c.firstName+'","lastName" :"'+c.lastName+'","dateOfBirth" :"'+a.add.dateOfBirth.Value+'","qualification" :"'+c.qualification+'","designation" :"'+c.designation+'","noOfExperience" :"'+a.noOfExperience+'","dateOfJoining" :"'+a.add.dateOfJoining.Value+'","fatherFirstName" :"'+c.fatherFirstName+'","fatherlastName" :"'+c.fatherlastName+'","localAddress" :"'+c.localAddress+'","permanentAddress" :"'+c.permanentAddress+'","userName" :"'+c.userName+'","password" :"'+c.password+'","comments" :"'+c.comments+'","emails":[{"email" :"'+c.email+'","type" :"'+c.type+'"}],"phoneNumbers":[{"phoneNumber" :"'+c.phoneNumber+'","type" :"'+c.type+'"}]}',g=b.createFacultyEntry();g.add({},f,function(b){200!=b.status&&201!=b.status||(d.go("^.list"),a.fetchFacultyList(0,a.facultyDetails.numPerPage)),a.response_msg="Faculty added successfully !!!"},function(b){404==b.status?a.response_msg1=b.data.errorMessage:a.response_msg1="Addition of Faculty is unsuccessful !!!"})},a.editFaculty=function(b){console.log("facultyId "+b),a.response_msg="",a.edit=angular.copy(g),angular.forEach(a.faculty_list,function(c){console.log("faculty: "+c.facultyId),b==c.facultyId&&(a.edit.facultyId=c.facultyId,a.edit.firstName=c.firstName,a.edit.lastName=c.lastName,a.edit.dateOfBirth=new Date(c.dateOfBirth),a.edit.dateOfJoining=new Date(c.dateOfJoining),a.edit.qualification=c.qualification,a.edit.designation=c.designation,a.edit.noOfExperience=c.noOfExperience,a.edit.comments=c.comments,a.edit.fatherFirstName=c.fatherFirstName,a.edit.fatherLastName=c.fatherLastName,a.edit.localAddress=c.localAddress,a.edit.permanentAddress=c.permanentAddress,a.edit.email=c.emails[0].email,a.edit.phoneNumber=c.phoneNumbers[0].phoneNumber)})},a.updateFacultyEntry=function(c){var f=a.edit;a.edit.dateOfJoining.Value=e("date")(new Date(f.dateOfJoining),"yyyy-MM-dd"),a.edit.dateOfBirth.Value=e("date")(new Date(f.dateOfBirth),"yyyy-MM-dd");var g=' { "firstName":"'+f.firstName+'","lastName" :"'+f.lastName+'","dateOfBirth" :"'+a.edit.dateOfBirth.Value+'","qualification" :"'+f.qualification+'","dateOfJoining" :"'+a.edit.dateOfJoining.Value+'","noOfExperience" :"'+f.noOfExperience+'","designation" :"'+f.designation+'","fatherFirstName" :"'+f.fatherFirstName+'","fatherLastName" :"'+f.fatherLastName+'","localAddress" :"'+f.localAddress+'","permanentAddress" :"'+f.permanentAddress+'","comments" :"'+f.comments+'","emails":[{"email" :"'+f.email+'","type" :"'+f.type+'"}],"phoneNumbers":[{"phoneNumber" :"'+f.phoneNumber+'","type" :"'+f.type+'"}]}',h=window.btoa(c),i=b.updateFacultyEntry(h);i.edit({},g,function(b){200!=b.status&&201!=b.status||d.go("^.list"),a.response_msg="Faculty updated successfully !!!"},function(b){404==b.status?a.response_msg1=b.data.errorMessage:a.response_msg1="Updation of Faculty is unsuccessful !!!"})},a.deleteFaculty=function(c,e){a.response_msg="",a.response_msg1="";var c=window.btoa(c.facultyId),g="Are you sure to delete the Faculty ??",h=show_dialoge(f,a,g,"dialoge_content.html");h.result.then(function(e){console.log("Flag value:"+e),e?(console.log(c.facultyId),b.deleteFaculty(c).remove({},function(b){200!=b.status&&201!=b.status||(d.go("^.list"),a.fetchFacultyList(0,a.facultyDetails.numPerPage),console.log("deleted"))},function(b){404==b.status?a.response_msg1=b.data.errorMessage:a.response_msg1="Faculty deletion unsuccessful !!!"})):console.log("Failed to delete")})},a.$on("$viewContentLoaded",function(){"faculty"==d.current.name&&void 0!=a.faculty_list&&a.$parent.setBaseContentHeight(a.faculty_list.length)}),a.init=function(){a.facultyDetails.numPerPage=parseInt(a.facultyDetails.numPerPage),a.maxSize=5,a.fetchFacultyList(0,a.facultyDetails.numPerPage)},a.cancel=function(){a.response_msg="",a.response_msg1="",a.photo=[],d.go("^.list")},a.init(),a.pageChanged=function(){a.facultyDetails.startValue=(a.facultyDetails.currentPage-1)*a.facultyDetails.numPerPage,a.fetchFacultyList(a.facultyDetails.startValue,a.facultyDetails.numPerPage)}}]),branchManager.controller("facultyLeaveCtrl",["$scope","facultyManagementFactory","br_manager_appConfig","$state","$filter","$modal",function(a,b,c,d,e,f){a.fetchYearList=function(){a.year_list=["2016-17","2017-18","2018-19","2019-20","2020-21"]},a.leaveDetails={leaveList:[],numPerPage:10,currentPage:1,startValue:0},a.fetchLeaveList=function(c,d,e){var f=window.btoa(c);a.response_msg1="",a.response_msg="",b.fetchLeaveList(f,d,e).fetch({},function(b){if(a.leave_list=[],console.log(b),200==b.status&&(a.count=b.data.total,void 0!=b.data.facultyLeaveResponseDTO)){var c=angular.fromJson(b.data.facultyLeaveResponseDTO);a.leave_list=c,a.totalPages=Math.ceil(a.count/a.leaveDetails.numPerPage),a.$parent.setBaseContentHeight(a.leave_list.length)}},function(b){a.leave_list=[],a.$parent.setBaseContentHeight(-1),console.log(b.status)})},a.$on("$viewContentLoaded",function(){"leave"==d.current.name&&void 0!=a.leave_list&&a.$parent.setBaseContentHeight(a.leave_list.length)}),a.rejectLeave=function(c,e){var g=window.btoa("Rejected");a.response_msg="",a.response_msg1="";var h=window.btoa(c),i=window.btoa(e),j="Are you sure you want to Reject the Leave ??",k=show_dialoge(f,a,j,"dialoge_content.html");k.result.then(function(c){console.log("Flag value:"+c),c?b.rejectLeave(h,g).remove({},function(b){200==b.status&&(a.fetchLeaveList(i,0,a.leaveDetails.numPerPage),console.log("Cancelled")),d.go("^.list"),a.response_msg="Leave Rejected successfully !!!"},function(b){409==b.status?a.response_msg1="Leave Rejection failed !!!":404==b.status?a.response_msg1=b.data.errorMessage:(a.response_msg1="Leave Rejection failed !!!",console.log(b.status))}):console.log("Failed to Reject")})},a.approveLeave=function(c,e){var g=window.btoa("Approval");a.response_msg="",a.response_msg1="";var h=window.btoa(c),i=window.btoa(e),j="Are you sure you want to Approve the Leave ??",k=show_dialoge(f,a,j,"dialoge_content.html");k.result.then(function(c){console.log("Flag value:"+c),c?b.approveLeave(h,g).remove({},function(b){200==b.status&&(a.fetchLeaveList(i,0,a.leaveDetails.numPerPage),console.log("Approved")),d.go("^.list"),a.response_msg="Leave Approval is successfully !!!"},function(b){409==b.status?a.response_msg1="Leave Approval is failed !!!":404==b.status?a.response_msg1=b.data.errorMessage:(a.response_msg1="Leave Approval is failed !!!",console.log(b.status))}):console.log("Failed to Approve")})},a.init=function(b){a.leaveDetails.numPerPage=parseInt(a.leaveDetails.numPerPage),a.maxSize=5,a.fetchLeaveList(b,0,a.leaveDetails.numPerPage),console.log("Selected Item Per Page: "+a.leaveDetails.numPerPage)},a.init(),a.pageChanged=function(b){a.leaveDetails.startValue=(a.leaveDetails.currentPage-1)*a.leaveDetails.numPerPage,a.fetchLeaveList(b,a.leaveDetails.startValue,a.leaveDetails.numPerPage)}}]),branchManager.controller("facultyReportCtrl",["$scope","facultyManagementFactory","$state",function(a,b,c){a.generateFacultyReport=function(){console.log("Inside generateFacultyReport()"),b.fetchFacultyPdfReport().fetch({},function(b){if(a.success=!1,b.status=200)if(b.data.byteLength>0){a.success=!0,console.log("response status 200 !!"),console.log("Reponse.data.byteLength = "+b.data.byteLength);var c=new Blob([b.data],{type:"application/pdf"});a.fileURL=URL.createObjectURL(c),a.renderPDF(a.fileURL,document.getElementById("pdf-holder"))}else console.log("Reponse.data.byteLength = "+b.data.byteLength)},function(a){console.log("Error Unable to download the page")})},a.renderPDF=function(a,b){function c(a){var c=a.getViewport(e),d=document.createElement("canvas"),f=d.getContext("2d"),g={canvasContext:f,viewport:c};d.height=c.height,d.width=c.width,b.appendChild(d),a.render(g)}function d(a){for(var b=1;b<=a.numPages;b++)a.getPage(b).then(c)}var e=1.7;console.log("Render PDF !!"),PDFJS.getDocument(a).then(d)},a.downloadPdf=function(){window.open(a.fileURL)},a.back=function(){a.response_msg="",a.response_msg1="",c.go("facultyreports.main")}}]),branchManager.factory("inventoryManagementFactory",["$resource","br_Manager_Config","$window",function(a,b,c){var d={},e=b.getMainAPI(),f=c.localStorage.getItem("authCode");return d.fetchInventaryPdfReport=function(b){return a(e+"/inventory/reports/category/"+b,{},{fetch:{method:"get",responseType:"arraybuffer",headers:{Authorization:f},interceptor:{response:function(a){return console.log("Report Generated for Inventary !!!"),a}}}})},d.fetchInventoryList=function(b,c){return a(e+"/inventory?offset="+b+"&limit="+c,{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d.createInventoryEntry=function(){return a(e+"/inventory",{},{add:{method:"POST",headers:{Authorization:f,"Content-Type":"application/json"},isArray:!1,interceptor:{response:function(a){return a}}}})},d.updateInventory=function(b){return console.log("id: "+b),a(e+"/inventory/"+b+"/update",{},{edit:{method:"PUT",headers:{Authorization:f,"Content-Type":"application/json"},isArray:!1,interceptor:{response:function(a){return console.log("updated !!"),a}}}})},d.deleteInventory=function(b){return a(e+"/inventory/"+b+"/dectivate",{},{remove:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d}]),branchManager.controller("inventoryManagementCtrl",["$scope","inventoryManagementFactory","br_manager_appConfig","$state","$filter","$modal",function(a,b,c,d,e,f){var g={inventoryType:"",approximateCost:"",category:"",serialNumber:"",inventoryId:"",yearOfManufacturer:"",dateOfPurchase:""};a.inventoryDetails={inventoryList:[],numPerPage:10,currentPage:1,startValue:0},a.fetchInventoryList=function(c,d){a.response_msg1="",b.fetchInventoryList(c,d).fetch({},function(b){if(a.year_list=["2016-17","2017-18","2018-19","2019-20","2020-21"],a.inventory_list=[],console.log(b),200==b.status&&(a.count=b.data.total,console.log(a.count),void 0!=b.data.inventoryLists)){var c=angular.fromJson(b.data.inventoryLists);console.log(c),a.inventory_list=c,a.totalPages=Math.ceil(a.count/a.inventoryDetails.numPerPage),a.$parent.setBaseContentHeight(a.inventory_list.length)}},function(b){a.inventory_list=[],a.$parent.setBaseContentHeight(-1),console.log(b.status)})},a.$on("$viewContentLoaded",function(){"inventory"==d.current.name&&void 0!=a.inventory_list&&a.$parent.setBaseContentHeight(a.inventory_list.length)}),a.addInventoryEntry=function(){a.response_msg="",a.response_msg1="",a.add=angular.copy(g)},a.category=["Electronic","Sports","Furniture","General"],a.createInventoryEntry=function(){var c=a.add;a.add.dateOfPurchase.Value=e("date")(new Date(c.dateOfPurchase),"yyyy-MM-dd");var f=' { "inventoryType":"'+c.inventoryType+'","yearOfManufacturer":"'+c.yearOfManufacturer+'","dateOfPurchase" :"'+a.add.dateOfPurchase.Value+'","approximateCost" :"'+c.approximateCost+'","serialNumber" :"'+c.serialNumber+'","category" :"'+c.category+'"}',g=b.createInventoryEntry();g.add({},f,function(b){200!=b.status&&201!=b.status||a.fetchInventoryList(0,a.inventoryDetails.numPerPage),d.go("^.list"),a.response_msg="Inventory added successfully !!!"},function(b){409==b.status?(a.add.inventoryType="",a.response_msg1=b.data.errorMessage):a.response_msg1="Addition of Inventory is unsuccessful !!!"})},a.editInventoryEntry=function(b){console.log("inventoryId "+b),a.response_msg="",a.edit=angular.copy(g),angular.forEach(a.inventory_list,function(c){console.log("inventory: "+c.inventoryId),b==c.inventoryId&&(a.edit.inventoryId=c.inventoryId,a.edit.inventoryType=c.inventoryType,a.edit.dateOfPurchase=new Date(c.dateOfPurchase),a.edit.approximateCost=c.approximateCost,a.edit.yearOfManufacturer=c.yearOfManufacturer,a.edit.serialNumber=c.serialNumber,a.edit.category=c.category)})},a.updateInventory=function(c){var f=a.edit;a.edit.dateOfPurchase.Value=e("date")(new Date(f.dateOfPurchase),"yyyy-MM-dd");var g=' { "yearOfManufacturer":"'+f.yearOfManufacturer+'","inventoryType":"'+f.inventoryType+'","approximateCost" :"'+f.approximateCost+'","dateOfPurchase" :"'+a.edit.dateOfPurchase.Value+'","serialNumber" :"'+f.serialNumber+'","category" :"'+f.category+'"}',h=window.btoa(c),i=b.updateInventory(h);i.edit({},g,function(b){200==b.status&&(console.log("response"+b.status),a.fetchInventoryList(0,a.inventoryDetails.numPerPage)),d.go("^.list"),a.response_msg="Inventory updated successfully !!!"},function(b){409==b.status?a.response_msg1=b.data.errorMessage:a.response_msg1="Updation of Inventory is unsuccessful !!!"})},a.deleteInventory=function(c,d){a.response_msg="",a.response_msg1="";var c=window.btoa(c.inventoryId);console.log("inside delete function !!");var e="Are you sure to delete the Inventary ??",g=show_dialoge(f,a,e,"dialoge_content.html");g.result.then(function(d){console.log("Flag value: "+d),d?(console.log(c.inventoryId),b.deleteInventory(c).remove({},function(b){200==b.status&&(a.fetchInventoryList(0,a.inventoryDetails.numPerPage),console.log("deleted"))},function(b){a.response_msg1="inventory Deletion failed !!!",console.log(b.status)})):console.log("Failed to delete")})},a.init=function(){a.inventoryDetails.numPerPage=parseInt(a.inventoryDetails.numPerPage),a.maxSize=5,a.fetchInventoryList(0,a.inventoryDetails.numPerPage)},a.cancel=function(){a.response_msg="",a.response_msg1="",d.go("^.list")},a.init(),a.pageChanged=function(){a.inventoryDetails.startValue=(a.inventoryDetails.currentPage-1)*a.inventoryDetails.numPerPage,a.fetchInventoryList(a.inventoryDetails.startValue,a.inventoryDetails.numPerPage)}}]),branchManager.controller("inventaryReportsCtrl",["$scope","inventoryManagementFactory","$state",function(a,b,c){a.inventaryReport=function(){a.category=["Electronic","Sports","Furniture","General"]},a.generateInventaryReport=function(c){if(void 0==c)window.alert("Please select the Category");else{var c=window.btoa(c);b.fetchInventaryPdfReport(c).fetch({},function(b){if(a.success=!1,b.status=200)if(b.data.byteLength>0){a.success=!0;var c=new Blob([b.data],{type:"application/pdf"});a.fileURL=URL.createObjectURL(c),a.renderPDF(a.fileURL,document.getElementById("pdf-holder"))}else console.log("Reponse.data.byteLength = "+b.data.byteLength)},function(a){console.log("Error Unable to download the page")})}},a.renderPDF=function(a,b){function c(a){var c=a.getViewport(e),d=document.createElement("canvas"),f=d.getContext("2d"),g={canvasContext:f,viewport:c};d.height=c.height,d.width=c.width,b.appendChild(d),a.render(g)}function d(a){for(var b=1;b<=a.numPages;b++)a.getPage(b).then(c);console.log("Render Pages !!")}var e=1.7;console.log("Render PDF !!"),PDFJS.getDocument(a).then(d)},a.downloadPdf=function(){window.open(a.fileURL)},a.back=function(){a.response_msg="",a.response_msg1="",c.go("intryreport.main")}}]),branchManager.factory("vehicleManagementFactory",["$resource","br_Manager_Config","$window",function(a,b,c){var d={},e=b.getMainAPI(),f=c.localStorage.getItem("authCode");return d.fetchVehiclePdfReport=function(){return a(e+"/vehicle/reports",{},{fetch:{method:"get",responseType:"arraybuffer",headers:{Authorization:f},interceptor:{response:function(a){return console.log("Report Generated for Vehicle !!!"),a}}}})},d.fetchVehicleList=function(b,c){return a(e+"/vehicle?offset="+b+"&limit="+c,{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d.createVehicleEntry=function(){return a(e+"/vehicle",{},{add:{method:"POST",headers:{Authorization:f,"Content-Type":"application/json"},isArray:!1,interceptor:{response:function(a){return a}}}})},d.editVehicleEntry=function(b){return a(e+"/vehicle/"+b+"/update",{},{edit:{method:"PUT",headers:{Authorization:f,"Content-Type":"application/json"},isArray:!1,interceptor:{response:function(a){return a}}}})},d.deleteVehicle=function(b){return a(e+"/vehicle/"+b+"/deactivate",{},{remove:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d.vehicleStudents=function(){return console.log("Autorize: "+f),a(e+"/vehicle/getVehicleIds",{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d.studendsForVehicle=function(b){return a(e+"/vehicle/reports/routeName/"+b,{},{fetch:{method:"get",responseType:"arraybuffer",headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d}]),branchManager.controller("vehicleManagementCtrl",["$scope","vehicleManagementFactory","br_manager_appConfig","$state","$filter","$modal",function(a,b,c,d,e,f){var g={vehicleId:"",vehicleType:"",vehicleRegNo:"",vehicleModel:"",yearOfManufacter:"",insuranceRenewal:"",nextRenewalDate:"",seatCapacity:"",routeName:"",routeNumber:""};a.vehicleDetails={vehicleList:[],numPerPage:10,currentPage:1,startValue:0},a.fetchVehicleList=function(c,d){a.response_msg1="",b.fetchVehicleList(c,d).fetch({},function(b){if(a.vehicle_list=[],console.log(b),200==b.status&&(a.count=b.data.total,void 0!=b.data.vehicles)){var c=angular.fromJson(b.data.vehicles);a.vehicle_list=c,a.totalPages=Math.ceil(a.count/a.vehicleDetails.numPerPage),a.$parent.setBaseContentHeight(a.vehicle_list.length)}},function(b){a.vehicle_list=[],a.$parent.setBaseContentHeight(-1),console.log(b.status)})},a.$on("$viewContentLoaded",function(){"vehicle"==d.current.name&&void 0!=a.vehicle_list&&a.$parent.setBaseContentHeight(a.vehicle_list.length)}),a.addVehicle=function(){a.response_msg="",a.response_msg1="",a.add=angular.copy(g)},a.createVehicleEntry=function(){var c=a.add;a.add.dateOfPurchase.Value=e("date")(new Date(c.dateOfPurchase),"yyyy-MM-dd"),a.add.insuranceRenewal.Value=e("date")(new Date(c.insuranceRenewal),"yyyy-MM-dd"),a.add.nextRenewalDate.Value=e("date")(new Date(c.nextRenewalDate),"yyyy-MM-dd");var f=' { "vehicleType":"'+c.vehicleType+'","vehicleRegNo" :"'+c.vehicleRegNo+'","vehicleModel" :"'+c.vehicleModel+'","seatCapacity" :"'+c.seatCapacity+'","driverName" :"'+c.driverName+'","routeName" :"'+c.routeName+'","routeNumber" :"'+c.routeNumber+'","phoneNumbers":{"phoneNumber" :"'+c.phoneNumber+'","type" :"'+c.type+'"},"yearOfManufacter" :"'+c.yearOfManufacter+'","dateOfPurchase" :"'+a.add.dateOfPurchase.Value+'","insuranceRenewal" :"'+a.add.insuranceRenewal.Value+'","nextRenewalDate" :"'+a.add.nextRenewalDate.Value+'"}',g=b.createVehicleEntry();g.add({},f,function(b){200!=b.status&&201!=b.status||d.go("^.list"),a.response_msg="Vehicle added successfully !!!"},function(b){409==b.status?a.response_msg1=b.data.errorMessage:a.response_msg1="Addition of Vehicle is unsuccessful !!!"})},a.editVehicle=function(b){console.log("vehicleId "+b),a.response_msg="",a.edit=angular.copy(g),angular.forEach(a.vehicle_list,function(c){console.log("vehicle: "+c.vehicleId),b==c.vehicleId&&(a.edit.vehicleId=c.vehicleId,a.edit.vehicleType=c.vehicleType,a.edit.vehicleRegNo=c.vehicleRegNo,a.edit.seatCapacity=c.seatCapacity,a.edit.driverName=c.driverName,a.edit.routeName=c.routeName,a.edit.routeNumber=c.routeNumber,a.edit.phoneNumber=c.phoneNumbers.phoneNumber,a.edit.vehicleModel=c.vehicleModel,a.edit.yearOfManufacter=c.yearOfManufacter,a.edit.dateOfPurchase=new Date(c.dateOfPurchase),a.edit.insuranceRenewal=new Date(c.insuranceRenewal),a.edit.nextRenewalDate=new Date(c.nextRenewalDate))})},a.editVehicleEntry=function(c){var f=a.edit;a.edit.dateOfPurchase.Value=e("date")(new Date(f.dateOfPurchase),"yyyy-MM-dd"),a.edit.insuranceRenewal.Value=e("date")(new Date(f.insuranceRenewal),"yyyy-MM-dd"),a.edit.nextRenewalDate.Value=e("date")(new Date(f.nextRenewalDate),"yyyy-MM-dd");var g=' { "vehicleType":"'+f.vehicleType+'","vehicleRegNo" :"'+f.vehicleRegNo+'","vehicleModel" :"'+f.vehicleModel+'","seatCapacity" :"'+f.seatCapacity+'","driverName" :"'+f.driverName+'","routeName" :"'+f.routeName+'","routeNumber" :"'+f.routeNumber+'","phoneNumbers":{"phoneNumber" :"'+f.phoneNumber+'","type" :"'+f.type+'"},"yearOfManufacter" :"'+f.yearOfManufacter+'","dateOfPurchase" :"'+a.edit.dateOfPurchase.Value+'","insuranceRenewal" :"'+a.edit.insuranceRenewal.Value+'","nextRenewalDate" :"'+a.edit.nextRenewalDate.Value+'"}',h=window.btoa(c),i=b.editVehicleEntry(h);i.edit({},g,function(b){200!=b.status&&201!=b.status||d.go("^.list"),a.response_msg="Vehicle Details Updated successfully !!!"},function(b){404==b.status?a.response_msg1=b.data.errorMessage:a.response_msg1="Updation of Vehicle details is unsuccessful !!!"})},a.deleteVehicle=function(c,d){a.response_msg="",a.response_msg1="";var c=window.btoa(c.vehicleId);console.log("inside delete function !!");var e="Are you sure to delete the Vehicle ??",g=show_dialoge(f,a,e,"dialoge_content.html");g.result.then(function(d){console.log("Flag value:"+d),d?(console.log(c.vehicleId),b.deleteVehicle(c).remove({},function(b){200!=b.status&&201!=b.status||(a.fetchVehicleList(0,a.vehicleDetails.numPerPage),console.log("deleted")),a.response_msg="Vehicle deleted successfully !!!"},function(b){404==b.status?a.response_msg1=b.data.errorMessage:a.response_msg1="Deletion of Vehicle details is unsuccessful !!!";
})):console.log("Failed to delete")})},a.init=function(){a.vehicleDetails.numPerPage=parseInt(a.vehicleDetails.numPerPage),a.maxSize=5,a.fetchVehicleList(0,a.vehicleDetails.numPerPage)},a.cancel=function(){a.response_msg="",a.response_msg1="",d.go("^.list")},a.init(),a.pageChanged=function(){a.vehicleDetails.startValue=(a.vehicleDetails.currentPage-1)*a.vehicleDetails.numPerPage,a.fetchVehicleList(a.vehicleDetails.startValue,a.vehicleDetails.numPerPage)}}]),branchManager.controller("vehicleReportsCtrl",["$scope","vehicleManagementFactory","$state",function(a,b,c){a.vehicleReport=function(){a.generateVehicleReport(),console.log("Inside vehicleReports()")},a.generateVehicleReport=function(){console.log("Inside generateVehicleReport()"),b.fetchVehiclePdfReport().fetch({},function(b){if(a.success=!1,b.status=200)if(b.data.byteLength>0){a.success=!0,console.log("response status 200 !!"),console.log("Download Complete !!!"),console.log("Content length = "+b.data.byteLength);var c=new Blob([b.data],{type:"application/pdf"});a.fileURL=URL.createObjectURL(c),a.renderPDF(a.fileURL,document.getElementById("pdf-holder"))}else console.log("Content length = "+b.data.byteLength)},function(a){console.log("Error Unable to download the page")})},a.vehicleStudents=function(){a.response_msg="",b.vehicleStudents().fetch({},function(b){if(a.vehicle_list=[],console.log(b),(200==b.status||201==b.status)&&void 0!=b.data.vehicles){var c=angular.fromJson(b.data.vehicles);a.vehicle_list=c}},function(b){a.vehicle_list=[],console.log(b.status)})},a.studendsForVehicle=function(c){if(void 0==c)window.alert("Please select the Route Name");else{console.log(c.routeName);var d=window.btoa(c.routeName);b.studendsForVehicle(d).fetch({},function(b){if(a.success=!1,200==b.status||201==b.status)if(b.data.byteLength>0){a.success=!0,console.log("Download Complete !!!"),console.log("content length = "+b.data.byteLength);var c=new Blob([b.data],{type:"application/pdf"});a.fileURL=URL.createObjectURL(c),a.renderPDF(a.fileURL,document.getElementById("pdf-holder"))}else console.log("content length = "+b.data.byteLength)},function(a){console.log("Error Unable to download the page")})}},a.renderPDF=function(a,b){function c(a){var c=a.getViewport(e),d=document.createElement("canvas"),f=d.getContext("2d"),g={canvasContext:f,viewport:c};d.height=c.height,d.width=c.width,b.appendChild(d),a.render(g)}function d(a){for(var b=1;b<=a.numPages;b++)a.getPage(b).then(c)}var e=1.7;console.log("Render PDF !!"),PDFJS.getDocument(a).then(d)},a.downloadPdf=function(){window.open(a.fileURL)},a.back=function(){a.response_msg="",a.response_msg1="",c.go("vehiclereports.main")}}]),branchManager.factory("fuelbookManagementFactory",["$resource","br_Manager_Config","$window",function(a,b,c){var d={},e=b.getMainAPI(),f=c.localStorage.getItem("authCode");return d.fetchFuelbookTime=function(b,c,d){return a(e+"/vehicle/"+b+"/fuelbook/fetch?offset="+c+"&limit="+d,{},{retrieve:{method:"POST",isArray:!1,headers:{Authorization:f,"Content-Type":"application/json"},interceptor:{response:function(a){return console.log("data fetched from database"),a}}}})},d.fetchVehicleList=function(b,c){return a(e+"/vehicle?offset="+b+"&limit="+c,{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d.createFuelbookEntry=function(b){return a(e+"/vehicle/"+b+"/fuelbook",{},{add:{method:"POST",headers:{Authorization:f,"Content-Type":"application/json"},isArray:!1,interceptor:{response:function(a){return a}}}})},d.deleteFuelbookEntry=function(b,c,d){return a(e+"/vehicle//"+b+"/fuelbook/date/"+d+"/kms/"+c+"/dectivate",{},{remove:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d}]),branchManager.controller("fuelbookManagementCtrl",["$scope","fuelbookManagementFactory","br_manager_appConfig","$state","$filter","$modal",function(a,b,c,d,e,f){var g={driverName:"",date:"",kmsReading:"",costOfFuel:"",typeOfFuel:"",startTime:"",endTime:"",fuelbookId:""};a.fetchVehicleList=function(c,d){a.response_msg1="",b.fetchVehicleList(c,d).fetch({},function(b){if(a.vehicle_list=[],a.fuelbook_lists=[],console.log(b),(200==b.status||201==b.status)&&(a.count=b.data.total,void 0!=b.data.vehicles)){var c=angular.fromJson(b.data.vehicles);a.vehicle_list=c}},function(b){a.vehicle_list=[],a.$parent.setBaseContentHeight(-1),console.log(b.status)})},a.fuelbookDetails={fuelBookLists:[],numPerPage:10,currentPage:1,startValue:0},a.fetchFuelbookTime=function(c,d,f,g,h){a.response_msg1="",a.response_msg="";var i=e("date")(new Date(d),"yyyy-MM-dd"),j=e("date")(new Date(f),"yyyy-MM-dd"),k=' { "startTime":"'+i+'","endTime" :"'+j+'"}',l=window.btoa(c.vehicleId),m=b.fetchFuelbookTime(l,g,h);m.retrieve({},k,function(b){if((200==b.status||201==b.status)&&(a.count=b.data.total,console.log(a.count),void 0!=b.data.fuelBookLists)){var c=angular.fromJson(b.data.fuelBookLists);a.fuelbook_lists=c,a.$parent.setBaseContentHeight(a.fuelbook_lists.length)}},function(b){409==b.status?(a.fuelbook_lists=[],a.$parent.setBaseContentHeight(-1),console.log(b.status)):(a.fuelbook_lists=[],console.log(b.status))})},a.$on("$viewContentLoaded",function(){"fuelbook"==d.current.name&&void 0!=a.fuelbook_lists&&a.$parent.setBaseContentHeight(a.fuelbook_lists.length)}),a.fuel_type=["Petrol","Diesel","Gasoline"],a.addFuelbookEntry=function(){a.response_msg="",a.response_msg1="",a.add=angular.copy(g),console.log("Inside addFuelbookEntry")},a.createFuelbookEntry=function(c){var f=a.add;a.add.date.Value=e("date")(new Date(f.date),"yyyy-MM-dd"),console.log("add object contains: "+a.add);var g=' { "driverName":"'+f.driverName+'","date" :"'+a.add.date.Value+'","kmsReading" :"'+f.kmsReading+'","costOfFuel" :"'+f.costOfFuel+'","typeOfFuel" :"'+f.typeOfFuel+'"}',h=window.btoa(c.vehicleId),i=b.createFuelbookEntry(h);i.add({},g,function(b){200!=b.status&&201!=b.status||d.go("^.list"),a.response_msg="Fuel Book Entry added successfully !!!"},function(b){409==b.status?(a.add.inventoryType="",a.response_msg1=b.data.errorMessage):a.response_msg1="Addition of Fuel Book Entry is unsuccessful !!!"})},a.editFuelbook=function(b){console.log("fuelbook "+b),a.response_msg="",a.edit=angular.copy(g),angular.forEach(a.fuelbook_lists,function(c){console.log("date: "+c.date),angular.equals(b,c.date)&&(a.edit.vehicleId=c.vehicleId,a.edit.driverName=c.driverName,a.edit.date=new Date(c.date),a.edit.kmsReading=c.kmsReading,a.edit.costOfFuel=c.costOfFuel,a.edit.typeOfFuel=c.typeOfFuel)})},a.deleteFuelbookEntry=function(c,d){a.response_msg="",a.response_msg1="",console.log("inside delete function !!");var g="Are you sure to delete the entry ??",h=show_dialoge(f,a,g,"dialoge_content.html");h.result.then(function(d){if(console.log("Flag value: "+d),d){console.log(c.vehicleId);var f=e("date")(new Date(c.date),"yyyy-MM-dd");console.log(f),console.log(c.vehicleId),console.log(c.kmsReading);var g=window.btoa(f),h=window.btoa(c.vehicleId),i=window.btoa(c.kmsReading);b.deleteFuelbookEntry(h,i,g).remove({},function(b){200!=b.status&&201!=b.status||(a.fetchVehicleList(0,100),a.response_msg="Fuelbook Entry  Deletion Successfull !!!")},function(b){a.response_msg="Fuelbook Entry  Deletion failed !!!",console.log(b.status)})}else console.log("Failed to delete")})},a.$on("$viewContentLoaded",function(){"vehicle"==d.current.name&&void 0!=a.vehicle_list&&a.$parent.setBaseContentHeight(a.vehicle_list.length)}),a.init=function(){a.fuelbookDetails.numPerPage=parseInt(a.fuelbookDetails.numPerPage),a.maxSize=5,a.fuelbook_lists=[]},a.cancel=function(){a.response_msg="",a.response_msg1="",d.go("^.list")},a.init(),a.pageChanged=function(b,c,d){a.fuelbookDetails.startValue=(a.fuelbookDetails.currentPage-1)*a.fuelbookDetails.numPerPage,a.fetchFuelbookTime(b,c,d,a.fuelbookDetails.startValue,a.fuelbookDetails.numPerPage)}}]),branchManager.factory("libraryManagementFactory",["$resource","br_Manager_Config","$window",function(a,b,c){var d={},e=b.getMainAPI(),f=c.localStorage.getItem("authCode");return d.fetchStandardList=function(b){return a(e+"/classroom/year/"+b,{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d.fetchClassRoomlist=function(b,c){return a(e+"/classroom/standard/"+c+"/section/year/"+b,{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d.fetchStudentList=function(b,c,d){return a(e+"/student/year/"+b+"/std/"+c+"/sec/"+d+"/basicinfo",{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d.fetchFacultyList=function(b,c){return a(e+"/faculty?offset="+b+"&limit="+c,{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d.fetchLibraryReport=function(){return a(e+"/library/reports",{},{fetch:{method:"get",responseType:"arraybuffer",headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d.fetchDefaulterList=function(b,c){return a(e+"/library/defaulters?offset="+b+"&limit="+c,{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d.fetchLibraryList=function(b,c){return a(e+"/library/UnAssignedBooks?skip="+b+"&limit="+c,{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d.searchBooks=function(b,c,d,g){var h,i="Author",j="Publication",k="Book Name";return angular.equals(b,i)?h=e+"/library/author/"+c+"?skip="+d+"&limit="+g:angular.equals(b,j)?h=e+"/library/publication/"+c+"?skip="+d+"&limit="+g:angular.equals(b,k)&&(h=e+"/library/book/"+c),a(h,{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d.createLibraryBookEntry=function(b){return a(e+"/library/book/"+b,{},{add:{method:"POST",headers:{Authorization:f,"Content-Type":"application/json"},isArray:!1,interceptor:{response:function(a){return console.log("post successful !!"),a}}}})},d.assignTo=function(){return a(e+"/library/issuedTo",{},{assign:{method:"POST",headers:{Authorization:f,"Content-Type":"application/json"},isArray:!1,interceptor:{response:function(a){return console.log("post successful !!"),a}}}})},d.unissueBook=function(){return a(e+"/library/unissue",{},{ret:{method:"POST",headers:{Authorization:f,"Content-Type":"application/json"},isArray:!1,interceptor:{response:function(a){return console.log("post successful !!"),a}}}})},d.editLibraryBook=function(b){return a(e+"/library/"+b+"/update",{},{edit:{method:"PUT",headers:{Authorization:f,"Content-Type":"application/json"},isArray:!1,interceptor:{response:function(a){return a}}}})},d.deleteBook=function(b){return a(e+"/library/bookId/"+b,{},{remove:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d}]),branchManager.controller("libraryManagementCtrl",["$scope","libraryManagementFactory","br_manager_appConfig","$state","$filter","$modal",function(a,b,c,d,e,f){var g={bookId:"",bookName:"",author:"",publication:"",issuedTo:"",issuedDate:"",returnDate:"",approximateCost:"",bookVersion:""};a.libraryDetails={libraryList:[],numPerPage:10,currentPage:1,startValue:0},a.defaulterDetails={libraryList:[],numPerPage:10,currentPage:1,startValue:0},a.search_by_list=["Author","Publication","Book Name"],a.fetchLibraryList=function(c,d){a.response_msg1="",b.fetchLibraryList(c,d).fetch({},function(b){if(a.library_list=[],console.log(b),(200==b.status||201==b.status)&&(a.count=b.data.total,void 0!=b.data.libraryDetailsLists)){var c=angular.fromJson(b.data.libraryDetailsLists);a.library_list=c,a.totalPages=Math.ceil(a.count/a.libraryDetails.numPerPage),a.$parent.setBaseContentHeight(a.library_list.length)}},function(b){a.library_list=[],a.$parent.setBaseContentHeight(-1),console.log(b.status)})},a.searchBooks=function(c,d,e,f){console.log(c),console.log(d),a.response_msg="";var g=window.btoa(d);b.searchBooks(c,g,e,f).fetch({},function(b){if(a.library_list=[],console.log(b),(200==b.status||201==b.status)&&(a.count=b.data.total,void 0!=b.data.libraryDetailsLists)){var c=angular.fromJson(b.data.libraryDetailsLists);a.library_list=c,a.totalPages=Math.ceil(a.count/a.libraryDetails.numPerPage),a.$parent.setBaseContentHeight(a.library_list.length)}},function(b){a.library_list=[],a.$parent.setBaseContentHeight(-1),console.log(b.status)})},a.$on("$viewContentLoaded",function(){"library"==d.current.name&&void 0!=a.library_list&&a.$parent.setBaseContentHeight(a.library_list.length)}),a.fetchDefaulterList=function(c,d){a.response_msg="",b.fetchDefaulterList(c,d).fetch({},function(b){if(a.defaulter_list=[],console.log(b),(200==b.status||201==b.status)&&(a.count=b.data.total,void 0!=b.data.assignedBooks)){var c=angular.fromJson(b.data.assignedBooks);a.defaulter_list=c,a.totalPages=Math.ceil(a.count/a.defaulterDetails.numPerPage),a.$parent.setBaseContentHeight(a.defaulter_list.length)}},function(b){a.defaulter_list=[],a.$parent.setBaseContentHeight(-1),console.log(b.status)})},a.fetchYearList=function(){a.year_list=["2016-17","2017-18","2018-19","2019-20","2020-21"],a.standard_list=[],a.section_list=[],a.student_list=[],a.fee_list=[]},a.fetchStandardList=function(c){a.response_msg1="",a.response_msg="";var d=window.btoa(c);b.fetchStandardList(d).fetch({},function(b){if(a.standard_list=[],a.section_list=[],a.student_list=[],a.fee_list=[],(200==b.status||201==b.status)&&void 0!=b.data.standards){var c=angular.fromJson(b.data.standards);a.standard_list=c}},function(b){a.standard_list=[],a.response_msg="No Classes Found.",console.log(b.status)})},a.fetchClassRoomlist=function(c,d){a.response_msg1="",a.response_msg="";var e=window.btoa(c),f=window.btoa(d);b.fetchClassRoomlist(e,f).fetch({},function(b){if(a.section_list=[],a.student_list=[],a.fee_list=[],console.log(b),200==b.status&&void 0!=b.data.classRoomLists){var c=angular.fromJson(b.data.classRoomLists);a.section_list=c}},function(b){a.section_list=[],a.response_msg="No Section found for this standard.",console.log(b.status)})},a.fetchStudentList=function(c,d,e){a.response_msg1="",a.response_msg="";var f=window.btoa(c),g=window.btoa(d),h=window.btoa(e.section);b.fetchStudentList(f,g,h).fetch({},function(b){if(a.student_list=[],a.fee_list=[],console.log(b),(200==b.status||201==b.status)&&void 0!=b.data.students){var c=angular.fromJson(b.data.students);a.student_list=c}},function(b){a.student_list=[],a.response_msg=" Studentds not found for this section.",console.log(b.status)})},a.fetchFacultyList=function(c,d){a.response_msg1="",a.response_msg="",b.fetchFacultyList(c,d).fetch({},function(b){if(a.faculty_list=[],console.log(b),200==b.status&&(a.count=b.data.total,void 0!=b.data.faculties)){var c=angular.fromJson(b.data.faculties);a.faculty_list=c}},function(b){a.faculty_list=[],a.$parent.setBaseContentHeight(-1),console.log(b.status)})},a.addLibraryBook=function(){a.response_msg="",a.response_msg1="",a.add=angular.copy(g),console.log("inside addLibraryBook !!")},a.createLibraryBookEntry=function(c){var e=a.add;console.log("inside createLibraryBookEntry !!");var f=' { "publication":"'+e.publication+'","bookName" :"'+e.bookName+'","bookVersion" :"'+e.bookVersion+'","author" :"'+e.author+'","approximateCost" :"'+e.approximateCost+'"}';console.log("read the inputs !!");var g=window.btoa(c),h=b.createLibraryBookEntry(g);h.add({},f,function(b){200!=b.status&&201!=b.status||a.fetchLibraryList(0,a.libraryDetails.numPerPage),a.response_msg="LibraryBookEntry added successfully !!!",d.go("^.list")},function(b){404==b.status?(a.add.branchName="",a.response_msg1=b.data.errorMessage):a.response_msg1="Addition of LibraryBookEntry is unsuccessful !!!"})},a.editLibrary=function(b){a.response_msg="",a.response_msg1="",a.edit=angular.copy(g),angular.forEach(a.library_list,function(c){console.log("vehicle: "+c.bookId),b==c.bookId&&(a.edit.bookId=c.bookId,a.edit.bookName=c.bookName,a.edit.bookVersion=c.bookVersion,a.edit.author=c.author,a.edit.publication=c.publication,a.edit.approximateCost=c.approximateCost)})},a.editLibraryBook=function(c){var e=a.edit,f=' { "bookName" :"'+e.bookName+'","bookVersion" :"'+e.bookVersion+'","author" :"'+e.author+'","publication" :"'+e.publication+'","approximateCost" :"'+e.approximateCost+'"}',g=window.btoa(c),h=b.editLibraryBook(g);h.edit({},f,function(b){200!=b.status&&201!=b.status||(a.response_msg="Library Book updated successfully !!!",d.go("^.list"))},function(b){404==b.status?a.response_msg1=b.data.errorMessage:a.response_msg1="Updating Book is unsuccessful !!!"})},a.deleteBook=function(c,d){a.response_msg="",a.response_msg1="";var e=window.btoa(c.bookId);console.log("inside delete function !!");var g="Are you sure to delete the library ??",h=show_dialoge(f,a,g,"dialoge_content.html");h.result.then(function(d){console.log("Flag value: "+d),d?(console.log(c.bookId),b.deleteBook(e).remove({},function(b){200==b.status&&(a.fetchLibraryList(0,a.libraryDetails.numPerPage),console.log("deleted"))},function(b){404==b.status&&(a.response_msg1=b.data.errorMessage),a.response_msg1="Book Deletion failed !!!",console.log(b.status)})):console.log("Failed to delete")})},a.isVisibleS=!1,a.isVisibleF=!1,a.toStudent=function(b){a.isVisibleS="S"==b,a.isVisibleF=!1},a.toFaculty=function(b){a.isVisibleF="F"==b,a.fetchFacultyList(0,1e3),a.isVisibleS=!1},a.assignBook=function(b){angular.equals(b.issuedTo,"N/A")?(d.go("^.assign"),a.response_msg="",a.response_msg1="",a.assign=angular.copy(g),angular.forEach(a.library_list,function(c){console.log("book: "+c.bookId),b.bookId==c.bookId&&(a.assign.bookId=c.bookId,a.assign.bookName=c.bookName,a.assign.author=c.author,a.assign.publication=c.publication,a.assign.approximateCost=c.approximateCost)})):alert("This book is already assigned to someone")},a.assignTo=function(c){var f=function(b){return 1==a.isVisibleS?b.student.studentId:1==a.isVisibleF?b.faculty.facultyId:void 0},g=a.assign;a.assign.issueDate.Value=e("date")(new Date(g.issueDate),"yyyy-MM-dd"),a.assign.returnByDate.Value=e("date")(new Date(g.returnByDate),"yyyy-MM-dd");var h=' { "bookId" :"'+g.bookId+'","issuedTo" :"'+f(g)+'","returnByDate" :"'+a.assign.returnByDate.Value+'","issueDate" :"'+a.assign.issueDate.Value+'"}',i=window.btoa(c),j=b.assignTo(i);j.assign({},h,function(b){200!=b.status&&201!=b.status||(a.fetchLibraryList(0,a.libraryDetails.numPerPage),a.isVisibleS=!1,a.isVisibleF=!1),a.response_msg="Book assigned successfully !!!",d.go("^.list")},function(b){404==b.status?a.response_msg1=b.data.errorMessage:a.response_msg1="Assigning of book is unsuccessful !!!"})},a.returnBook=function(b){angular.equals(b.issuedTo,"N/A")?alert("This book is not assigned to anyone"):(d.go("^.ret"),a.response_msg="",a.response_msg1="",a.ret=angular.copy(g),angular.forEach(a.library_list,function(c){b.bookId==c.bookId&&(a.ret.bookId=c.bookId,a.ret.issuedTo=c.issuedTo)}))},a.unissueBook=function(c){console.log("book id: "+c);var f=a.ret;a.ret.returnDate.Value=e("date")(new Date(f.returnDate),"yyyy-MM-dd");var g=' { "bookId" :"'+f.bookId+'","studentId" :"'+f.issuedTo+'"}',h=window.btoa(c),i=b.unissueBook(h);i.ret({},g,function(b){200!=b.status&&201!=b.status||(a.fetchLibraryList(0,a.libraryDetails.numPerPage),a.isVisibleS=!1,a.isVisibleF=!1),a.response_msg="Book returned successfully !!!",d.go("^.list")},function(b){404==b.status?a.response_msg1=b.data.errorMessage:a.response_msg1="Book Returning is unsuccessful !!!"})},a.fetchLibraryReport=function(){console.log("Inside library report()"),b.fetchLibraryReport().fetch({},function(b){if(a.success=!1,b.status=200)if(b.data.byteLength>0){a.success=!0,console.log("response status 200 !!"),console.log("Download Complete !!! content length: "+b.data.byteLength);var c=new Blob([b.data],{type:"application/pdf"});a.fileURL=URL.createObjectURL(c),a.renderPDF(a.fileURL,document.getElementById("pdf-holder"))}else console.log("Reponse data-length = "+b.data.byteLength)},function(a){console.log("Error Unable to download the page")})},a.renderPDF=function(a,b){function c(a){var c=a.getViewport(e),d=document.createElement("canvas"),f=d.getContext("2d"),g={canvasContext:f,viewport:c};d.height=c.height,d.width=c.width,b.appendChild(d),a.render(g)}function d(a){for(var b=1;b<=a.numPages;b++)a.getPage(b).then(c);console.log("Render Pages !!")}var e=1.7;console.log("Render PDF !!"),PDFJS.getDocument(a).then(d)},a.downloadPdf=function(){window.open(a.fileURL)},a.init=function(){a.libraryDetails.numPerPage=parseInt(a.libraryDetails.numPerPage),a.defaulterDetails.numPerPage=parseInt(a.defaulterDetails.numPerPage),a.maxSize=5},a.back=function(){a.response_msg="",a.response_msg1="",d.go("reports.main")},a.cancel=function(){a.response_msg="",a.response_msg1="",d.go("^.list")},a.init(),a.pageChanged=function(){a.libraryDetails.startValue=(a.libraryDetails.currentPage-1)*a.libraryDetails.numPerPage,a.fetchLibraryList(a.libraryDetails.startValue,a.libraryDetails.numPerPage)},a.pageChanged1=function(){a.defaulterDetails.startValue=(a.defaulterDetails.currentPage-1)*a.defaulterDetails.numPerPage,a.fetchDefaulterList(a.defaulterDetails.startValue,a.defaulterDetails.numPerPage)},a.init1=function(b,c){void 0==b&&void 0==c?(a.libraryDetails.numPerPage=parseInt(a.libraryDetails.numPerPage),a.maxSize=5,a.fetchLibraryList(0,a.libraryDetails.numPerPage)):(a.libraryDetails.numPerPage=parseInt(a.libraryDetails.numPerPage),a.maxSize=5,a.searchBooks(b,c,0,a.libraryDetails.numPerPage))}}]),branchManager.factory("holidayManagementFactory",["$resource","br_Manager_Config","$window",function(a,b,c){var d={},e=b.getMainAPI(),f=c.localStorage.getItem("authCode");return d.fetchStandardList=function(b){return a(e+"/classroom/year/"+b,{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d.fetchSectionList=function(b,c){return a(e+"/classroom/standard/"+b+"/section/year/"+c,{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d.fetchHolidayList=function(b,c,d){return a(e+"/holidaylist/year/"+b+"/holidays?offset="+c+"&limit="+d,{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d.createHoliday=function(){return a(e+"/holidaylist",{},{add:{method:"POST",headers:{Authorization:f,"Content-Type":"application/json"},isArray:!1,interceptor:{response:function(a){return a}}}})},d.updateHoliday=function(b,c){return a(e+"/holidaylist/startTime/"+b+"/to/"+c,{},{edit:{method:"PUT",headers:{Authorization:f,"Content-Type":"application/json"},isArray:!1,interceptor:{response:function(a){return a}}}})},d.deleteHoliday=function(b,c,d){return a(e+"/holidaylist?startDate="+c+"&endDate="+d+"&year="+b,{},{remove:{method:"Delete",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d}]),branchManager.controller("holidaysManagementCtrl",["$scope","holidayManagementFactory","br_manager_appConfig","$state","$filter","$modal",function(a,b,c,d,e,f){var g={type:"",reason:"",classroomId:"",startTime:"",endTime:"",year:""};a.holidayDetails={holiday_lists:[],numPerPage:10,currentPage:1,startValue:0},a.fetchYearList=function(){a.year_list=["2016-17","2017-18","2018-19","2019-20","2020-21"],a.holiday_lists=""},a.fetchHolidayList=function(c,d,e){a.response_msg="",a.response_msg1="";var f=window.btoa(c);b.fetchHolidayList(f,d,e).fetch({},function(b){if(a.holiday_lists=[],console.log(b),200==b.status&&(a.count=b.data.total,console.log(a.count),void 0!=b.data.holidayLists)){var c=angular.fromJson(b.data.holidayLists);console.log(c),a.holiday_lists=c,a.totalPages=Math.ceil(a.count/a.holidayDetails.numPerPage),a.$parent.setBaseContentHeight(a.holiday_lists.length)}},function(b){a.holiday_lists=[],a.response_msg1="No Holidays found for this year.",a.$parent.setBaseContentHeight(-1),console.log(b.status)})},a.$on("$viewContentLoaded",function(){"holiday"==d.current.name&&void 0!=a.holidays_list&&a.$parent.setBaseContentHeight(a.holidays_list.length)}),a.fetchStandardList=function(c){a.response_msg1="";var d=window.btoa(c);b.fetchStandardList(d).fetch({},function(b){if(a.standard_list=[],console.log(a.standard_list),(200==b.status||201==b.status)&&void 0!=b.data.standards){var c=angular.fromJson(b.data.standards);a.standard_list=c}},function(b){a.standard_list=[],console.log(b.status)})},a.fetchSectionList=function(c,d){a.response_msg1="";var e=window.btoa(c),f=window.btoa(d);b.fetchSectionList(e,f).fetch({},function(b){if(a.classroom_list=[],console.log(b),(200==b.status||201==b.status)&&void 0!=b.data.classRoomLists){var c=angular.fromJson(b.data.classRoomLists);a.classroom_list=c}},function(b){a.classroom_list=[],console.log(b.status)})},a.addHoliday=function(){a.response_msg="",a.response_msg1="",a.add=angular.copy(g),a.other=0,a.holiday=function(b){hol_to="Class room",hol_to1="Class",angular.equals(hol_to,b)?(a.other=1,console.log("all change")):angular.equals(hol_to1,b)?(a.other=2,console.log("two change")):(a.other=0,console.log("No change"))},a.fetchStandardList(a.selectedYear)},a.holiday_type=["National Holiday","Study Holidays","Festival","Summer Holidays","Winter Holidays","Regional Holiday"],a.holiday_to=["School","Class","Class room"],a.createHoliday=function(){var c=a.add;a.add.startTime.Value=e("date")(new Date(c.startTime),"yyyy-MM-dd"),a.add.endTime.Value=e("date")(new Date(c.endTime),"yyyy-MM-dd");var f=function(){var b={};return b=angular.equals(c.to,"Class room")?{type:c.type,reason:c.reason,startTime:a.add.startTime.Value,endTime:a.add.endTime.Value,to:c.to,standard:c.standard,classroomId:c.classroom.classRoomId,year:c.year}:angular.equals(c.to,"Class")?{type:c.type,reason:c.reason,startTime:a.add.startTime.Value,endTime:a.add.endTime.Value,to:c.to,standard:c.standard,year:c.year}:{type:c.type,reason:c.reason,startTime:a.add.startTime.Value,endTime:a.add.endTime.Value,to:c.to,year:c.year}},g=f(),h=b.createHoliday();h.add({},g,function(b){200!=b.status&&201!=b.status||(d.go("^.list"),a.fetchYearList()),a.response_msg="Holiday added successfully !!!"},function(b){404==b.status?a.response_msg1=b.data.errorMessage:a.response_msg1="Addition of Holiday is unsuccessful !!!"})},a.editHoliday=function(b,c){a.response_msg="",a.response_msg1="",a.edit=b,a.edit.prevStartTime=b.startTime,a.edit.prevEndTime=b.endTime,a.edit.startTime=new Date(b.startTime),a.edit.endTime=new Date(b.endTime),console.log(a.edit.type),console.log(a.edit.reason),console.log(a.edit.standard),console.log(a.edit.classRoomId),console.log(a.edit.year),console.log(a.edit.startTime),console.log(a.edit.endTime)},a.updateHoliday=function(){var c=a.edit;a.edit.startTime=e("date")(new Date(a.edit.startTime),"yyyy-MM-dd"),a.edit.endTime=e("date")(new Date(a.edit.endTime),"yyyy-MM-dd"),console.log(a.edit.type),console.log(a.edit.reason),console.log(a.edit.standard),console.log(a.edit.classRoomId),console.log(a.edit.year),console.log(c.to),console.log(a.edit.startTime),console.log(a.edit.endTime);var f=' { "type":"'+c.type+'","reason":"'+c.reason+'","to":"'+c.to+'","standard":"'+c.standard+'","classroomId" :"'+c.classRoomId+'","year" :"'+c.year+'","startTime" :"'+a.edit.startTime+'","endTime" :"'+a.edit.endTime+'"}',g=window.btoa(a.edit.prevStartTime),h=window.btoa(c.to),i=b.updateHoliday(g,h);i.edit({},f,function(b){200!=b.status&&201!=b.status||(d.go("^.list"),a.fetchYearList()),a.response_msg="Holiday updated successfully !!!"},function(b){404==b.status?a.response_msg1=b.data.errorMessage:a.response_msg1="Updating of Holiday is unsuccessful !!!"})},a.deleteHoliday=function(c,e,g){a.response_msg="",a.response_msg1="",console.log(c.startTime),console.log(c.endTime),console.log(g);var h=window.btoa(c.startTime),i=window.btoa(c.endTime),g=window.btoa(c.year),j="Are you sure to delete the Holidy Entry ??",k=show_dialoge(f,a,j,"dialoge_content.html");k.result.then(function(c){console.log("Flag value:"+c),c?b.deleteHoliday(g,h,i).remove({},function(b){console.log(b.status),200!=b.status&&201!=b.status&&204!=b.status||(a.holiday_lists="",d.go("^.list"),a.fetchYearList(),a.response_msg="Holiday Entry Deleted successfully !!!")},function(b){a.response_msg1="Deletion of holiday unsuccessful !!",console.log(b.status)}):console.log("Failed to delete")})},a.$on("$viewContentLoaded",function(){"holiday"==d.current.name&&void 0!=a.holiday_lists&&a.$parent.setBaseContentHeight(a.holiday_lists.length)}),a.init=function(){a.holidayDetails.numPerPage=parseInt(a.holidayDetails.numPerPage),a.maxSize=5},a.cancel=function(){a.response_msg="",a.response_msg1="",d.go("^.list")},a.init(),a.pageChanged=function(b){a.holidayDetails.startValue=(a.holidayDetails.currentPage-1)*a.holidayDetails.numPerPage,a.fetchHolidayList(b,a.holidayDetails.startValue,a.holidayDetails.numPerPage)}}]),branchManager.factory("assessmentMangementFactory",["$resource","br_Manager_Config","$window",function(a,b,c){var d={},e=b.getMainAPI(),f=c.localStorage.getItem("authCode");return d.fecthAssesmentList=function(b){return a(e+"/classroom/"+b+"/assessment/fetch",{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d.fetchStandardList=function(b){return a(e+"/classroom/year/"+b,{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d.fetchSectionList=function(b,c){return a(e+"/classroom/standard/"+b+"/section/year/"+c,{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d.listExams=function(b,c){return a(e+"/classroom/"+b+"/assessment/"+c,{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d.fetchSubjectList=function(b){return a(e+"/subject/classroom/"+b,{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d.createAssessment=function(b){return a(e+"/classroom/"+b+"/assessment",{},{add:{method:"POST",headers:{Authorization:f,"Content-Type":"application/json"},isArray:!1,interceptor:{response:function(a){return console.log("data posted successfully !!"),a}}}})},d.updateAssessment=function(b,c){return a(e+"/classroom/"+b+"/assessment/"+c,{},{add:{method:"PUT",headers:{Authorization:f,"Content-Type":"application/json"},isArray:!1,interceptor:{response:function(a){return console.log("data posted successfully !!"),a}}}})},d.deactivateAssessment=function(b,c){return a(e+"/classroom/"+b+"/assessment/"+c+"/dectivate",{},{remove:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d}]),branchManager.controller("assessmentCtrl",["$scope","assessmentMangementFactory","br_manager_appConfig","$state","$filter","$modal",function(a,b,c,d,e,f){var g={assesmentName:"",year:"",classRoomId:"",assessmentId:"",maxMarks1:"",maxMarks2:"",maxMarks3:"",maxMarks4:"",maxMarks5:"",maxMarks6:"",maxMarks7:"",maxMarks8:"",maxMarks9:"",maxMarks10:""};a.assessmentDetails={assessmentList:[],numPerPage:25,currentPage:1,startValue:0},a.assessments_name=["First Test","Second Test","Midterm Exam","Prepratory Exam","Annual Exam","Other"],a.fetchYearList=function(){a.year_list=["2016-17","2017-18","2018-19","2019-20","2020-21"],a.standard_list="",a.assessment_list="",a.classroom_list=""},a.fetchStandardList=function(c){a.response_msg="",a.response_msg1="",a.assessment_list="",a.classroom_list="";var d=window.btoa(c);b.fetchStandardList(d).fetch({},function(b){if(a.standard_list=[],console.log(a.standard_list),(200==b.status||201==b.status)&&void 0!=b.data.standards){var c=angular.fromJson(b.data.standards);a.standard_list=c}},function(b){a.standard_list=[],a.response_msg1="There is no Class found for this year.",console.log(b.status)})},a.fetchSectionList=function(c,d){a.response_msg1="",a.response_msg="",a.assessment_list="";var e=window.btoa(c),f=window.btoa(d);b.fetchSectionList(e,f).fetch({},function(b){if(a.classroom_list=[],console.log(b),(200==b.status||201==b.status)&&void 0!=b.data.classRoomLists){
var c=angular.fromJson(b.data.classRoomLists);a.classroom_list=c}},function(b){a.classroom_list=[],a.response_msg1="There is no classrooms found for this standard.",console.log(b.status)})},a.fecthAssesmentList=function(c){a.response_msg1="";var d=window.btoa(c.classRoomId);b.fecthAssesmentList(d).fetch({},function(b){if(a.assessment_list=[],console.log(b),200==b.status&&(a.count=b.data.total,void 0!=b.data.assessmentLists)){var c=angular.fromJson(b.data.assessmentLists);a.assessment_list=c,a.$parent.setBaseContentHeight(a.assessment_list.length)}},function(b){a.assessment_list=[],a.response_msg1="There is no Assessments.",a.$parent.setBaseContentHeight(-1),console.log(b.status)})},a.fetchSubjectList=function(c){a.response_msg="";var d=window.btoa(c.classRoomId);b.fetchSubjectList(d).fetch({},function(b){if(a.sub_list=[],console.log(b),(200==b.status||201==b.status)&&void 0!=b.data.subjects){var c=angular.fromJson(b.data.subjects);a.sub_list=c,a.subjects=[],a.sub_list.forEach(function(b){a.subjects.push(b.subjectName)})}})},a.listExams=function(c,d,e,f){a.response_msg="";var g=window.btoa(c.classRoomId),h=window.btoa(d.assessmentId);b.listExams(g,h).fetch({},function(b){if(a.exams_list={},console.log(b),200==b.status&&void 0!=b.data){var e=angular.fromJson(b.data);a.exams_list=e,a.assessmentId=d.assessmentId,a.classRoomId=c.classRoomId,a.section=d.section,a.assesmentName=a.exams_list.assesmentName,a.eyear=f,a.Exams=a.exams_list.exams}})},a.addAssessment=function(){a.response_msg="",a.response_msg1="",a.add=angular.copy(g),console.log("inside addAssessment"),a.other=0,a.assess=function(b){name="Other",angular.equals(name,b)?(a.other=1,console.log("name change")):(a.other=0,console.log("No change"))},a.newExams=[{id:"ex1"}],a.addAssess=function(){var b=a.newExams.length+1;a.newExams.push({id:"ex"+b})},a.removeAssess=function(){var b=a.newExams.length-1;a.newExams.splice(b)}},a.createAssessment=function(c,f,g){a.response_msg="",a.response_msg1="";var h=a.add,i="",j=function(){return name="Other",i=angular.equals(f,name)?h.assessmentName1:f};a.newExams.forEach(function(a){delete a.id,a.date=e("date")(new Date(a.date),"yyyy-MM-dd")});var k={assesmentName:j(),year:g,exams:a.newExams};console.log("data read"),console.log(k);var l=window.btoa(c.classRoomId),m=b.createAssessment(l);m.add({},k,function(b){200!=b.status&&201!=b.status||(a.subjects=[],a.fetchYearList()),d.go("^.list"),a.response_msg="Assessment added successfully !!!"},function(b){404==b.status?(a.assessmentName="",a.response_msg1=b.data.errorMessage):a.response_msg1="Addition of Assessment is not successful !!!"})},a.editAssessment=function(c,d,e,f,h){a.response_msg="",a.response_msg1="",a.edit=angular.copy(g);var i=window.btoa(c.classRoomId),j=window.btoa(d.assessmentId);a.assessmentId=d.assessmentId,a.section=d.section,b.fetchSubjectList(i).fetch({},function(d){if(a.sub_list=[],console.log(d),200==d.status||201==d.status)if(void 0!=d.data.subjects){var e=angular.fromJson(d.data.subjects);a.sub_list=e,b.listExams(i,j).fetch({},function(b){if(a.exams_list={},console.log(b),200==b.status||201==b.status){if(void 0!=b.data){var d=angular.fromJson(b.data);a.exams_list=d,a.edit.classRoomId=c.classRoomId,a.assesmentName=a.exams_list.assesmentName,a.edit.eyear=f,a.edit.standard=h,a.exams_list.exams.forEach(function(a){a.date=new Date(a.date)}),a.subjects=[],a.sub_list.forEach(function(b){a.subjects.push(b.subjectName)}),a.removeExams=function(){var b=a.exams_list.exams.length-1,c=a.exams_list.exams.splice(b);a.deletedExams.push(c.pop()),console.log(a.deletedExams)},a.NewExams=[{id:"ex1"}],a.addExam=function(){var b=a.NewExams.length+1;a.NewExams.push({id:"ex"+b})},a.deletedExams=[],a.removeExam=function(){var b=a.NewExams.length-1;a.NewExams.splice(b)}}}else console.log(b.status),console.log("Exam list not fiound"),a.response_msg1="Exam list not fiound"})}else console.log(d.status),console.log("Subject list not fiound"),a.response_msg1="Subject list not fiound"})},a.updateAssessment=function(c,f){a.edit;a.exams_list.exams.forEach(function(a){a.date=e("date")(new Date(a.date),"yyyy-MM-dd")}),a.deletedExams.forEach(function(a){a.date=e("date")(new Date(a.date),"yyyy-MM-dd")}),a.NewExams.forEach(function(a){delete a.id,a.date=e("date")(new Date(a.date),"yyyy-MM-dd")});var g={assesmentName:a.assesmentName,year:a.edit.eyear,updatedExams:a.exams_list.exams,addedExams:a.NewExams,deletedExams:a.deletedExams},h=window.btoa(a.edit.classRoomId),i=window.btoa(a.assessmentId),j=b.updateAssessment(h,i);j.add({},g,function(b){200!=b.status&&201!=b.status||(a.subjects=[],a.assessment_list=""),d.go("^.list"),a.response_msg="Assessment Updated successfully !!!"},function(b){404==b.status?a.response_msg1=b.data.errorMessage:a.response_msg="Updating of Assessment is not successful !!!"})},a.$on("$viewContentLoaded",function(){"assessment"==d.current.name&&void 0!=a.assessment_list&&a.$parent.setBaseContentHeight(a.assessment_list.length)}),a.cancel=function(){a.response_msg="",a.response_msg1="",a.assessment_list=[],d.go("^.list")}}]),branchManager.factory("marksSheetfactory",["$resource","br_Manager_Config","$window",function(a,b,c){var d={},e=b.getMainAPI(),f=c.localStorage.getItem("authCode");return d.fecthAssesmentList=function(b){return a(e+"/classroom/"+b+"/assessment/fetch",{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d.fetchStudentList=function(b,c,d){return a(e+"/student/year/"+b+"/std/"+c+"/sec/"+d+"/basicinfo",{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d.fetchStandardList=function(b){return a(e+"/classroom/year/"+b,{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d.fetchSectionList=function(b,c){return a(e+"/classroom/standard/"+b+"/section/year/"+c,{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d.fetchclassroomMarksSheet=function(b,c){return a(e+"/classRoom/"+b+"/markssheet/report/assessment/"+c,{},{fetch:{method:"get",responseType:"arraybuffer",headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d.fetchstudentMarksheetPerYear=function(b,c,d){return a(e+"/classRoom/"+c+"/markssheet/report/student/"+d+"/year/"+b,{},{fetch:{method:"get",responseType:"arraybuffer",headers:{Authorization:f},interceptor:{response:function(a){return console.log("Report Generated !!!"),a}}}})},d.studentMarksListforAssess=function(b,c,d){return a(e+"/classRoom/"+b+"/markssheet/student/"+c+"/assessment/"+d,{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return console.log("result Generated !!!"),a}}}})},d.fetchMarksheetPerAssess=function(b,c,d){return a(e+"/classRoom/"+b+"/markssheet/report/student/"+c+"/assessment/"+d,{},{fetch:{method:"get",responseType:"arraybuffer",headers:{Authorization:f},interceptor:{response:function(a){return console.log("Report Generated !!!"),a}}}})},d.listExams=function(b,c){return a(e+"/classroom/"+b+"/assessment/"+c,{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d.addStudentMarks=function(b,c){return a(e+"/classRoom/"+b+"/markssheet/student/"+c,{},{add:{method:"POST",headers:{Authorization:f,"Content-Type":"application/json"},isArray:!1,interceptor:{response:function(a){return console.log("inside add student marks !!!"),a}}}})},d.fetchMarks=function(b,c,d){return a(e+"/classRoom/"+b+"/markssheet/student/"+d+"/assessment/"+c,{},{fetch:{method:"GET",headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d.updateStudentMarks=function(b,c){return a(e+"/classRoom/"+b+"/markssheet/student/"+c+"/update",{},{add:{method:"PUT",headers:{Authorization:f,"Content-Type":"application/json"},isArray:!1,interceptor:{response:function(a){return console.log("inside update student marks !!!"),a}}}})},d}]),branchManager.controller("marksSheetCtrl",["$scope","marksSheetfactory","$state",function(a,b,c){var d={assesmentName:"",assesmentId:"",year:"",classRoomId:"",assessmentId:"",marks1:"",marks2:"",marks3:"",marks4:"",marks5:"",marks6:"",marks7:"",marks8:"",marks9:"",marks10:""};a.fetchYearList=function(){a.year_list=["2016-17","2017-18","2018-19","2019-20","2020-21"],a.standard_list="",a.classroom_list="",a.student_list="",a.assessment_list="",a.marks_list="",a.marksObtained=""},a.fetchStandardList=function(c){a.response_msg1="",a.response_msg="",a.classroom_list="",a.student_list="",a.assessment_list="",a.marks_list="",a.marksObtained="";var d=window.btoa(c);b.fetchStandardList(d).fetch({},function(b){if(a.standard_list=[],console.log(a.standard_list),(200==b.status||201==b.status)&&void 0!=b.data.standards){var c=angular.fromJson(b.data.standards);a.standard_list=c}},function(b){a.standard_list=[],a.response_msg1="No Standards Found",console.log(b.status)})},a.fetchSectionList=function(c,d){a.response_msg1="",a.response_msg="",a.student_list="",a.assessment_list="",a.marks_list="",a.marksObtained="";var e=window.btoa(c),f=window.btoa(d);b.fetchSectionList(e,f).fetch({},function(b){if(a.classroom_list=[],console.log(b),(200==b.status||201==b.status)&&void 0!=b.data.classRoomLists){var c=angular.fromJson(b.data.classRoomLists);a.classroom_list=c}},function(b){a.classroom_list=[],console.log(b.status)})},a.fetchStudentList=function(c,d,e){a.response_msg1="",a.response_msg="",a.student_list="",a.assessment_list="",a.marks_list="",a.marksObtained="";var f=window.btoa(c),g=window.btoa(d),h=window.btoa(e.section);b.fetchStudentList(f,g,h).fetch({},function(b){if(a.student_list=[],console.log(b),(200==b.status||201==b.status)&&void 0!=b.data.students){var c=angular.fromJson(b.data.students);a.student_list=c}},function(b){a.response_msg1="No Students Found",console.log(b.status)})},a.fecthAssesmentList=function(c){a.response_msg1="",a.response_msg="",a.marks_list="",a.marksObtained="";var d=window.btoa(c.classRoomId);b.fecthAssesmentList(d).fetch({},function(b){if(a.assessment_list=[],console.log(b),200==b.status&&(a.count=b.data.total,void 0!=b.data.assessmentLists)){var c=angular.fromJson(b.data.assessmentLists);a.assessment_list=c}},function(b){a.assessment_list=[],a.response_msg1="No Assessments Found",a.$parent.setBaseContentHeight(-1),console.log(b.status)})},a.marksSheet=function(b,c){void 0!=c&&void 0!=b||window.alert("Please Select Year, Class, Section and Assessment");var d=c.assessmentId,e=b.classRoomId;a.fetchclassroomMarksSheet(e,d)},a.fetchclassroomMarksSheet=function(c,d){var c=window.btoa(c),e=window.btoa(d);b.fetchclassroomMarksSheet(c,e).fetch({},function(b){if(a.success=!1,b.status=200)if(b.data.byteLength>0){a.success=!0,console.log("response status 200 !!"),console.log("Download Complete !!! content length: "+b.data.byteLength);var c=new Blob([b.data],{type:"application/pdf"});a.fileURL=URL.createObjectURL(c),a.renderPDF(a.fileURL,document.getElementById("pdf-holder"))}else console.log("Reponse data Length = "+b.data.byteLength)},function(a){console.log("Error Unable to download the page")})},a.markssheetEachYear=function(b,c,d){void 0!=b&&void 0!=c&&void 0!=d||window.alert("Please Select Year, Class, Section and Student");var e=b,f=d.studentId,g=c.classRoomId;a.fetchstudentMarksheetPerYear(e,g,f)},a.fetchstudentMarksheetPerYear=function(c,d,e){console.log("Inside fetchstudentMarksheetPerYear()");var d=window.btoa(d),e=window.btoa(e),c=window.btoa(c);b.fetchstudentMarksheetPerYear(c,d,e).fetch({},function(b){if(a.success=!1,b.status=200)if(b.data.byteLength>0){a.success=!0,console.log("response status 200 !!"),console.log("Download Complete !!! content length: "+b.data.byteLength);var c=new Blob([b.data],{type:"application/pdf"});a.fileURL=URL.createObjectURL(c),a.renderPDF(a.fileURL,document.getElementById("pdf-holder"))}else console.log("Reponse.data.byteLength = "+b.data.byteLength)},function(a){console.log("Error Unable to download the page")})},a.marksSheetEachAssess=function(b,c,d){void 0!=b&&void 0!=c&&void 0!=d||window.alert("Please Select Year, Class, Section, Student and Assessment");var e=c.studentId,f=d.assessmentId,g=b.classRoomId;console.log(e+" "+f+" "+g),a.fetchMarksheetPerAssess(g,e,f)},a.fetchMarksheetPerAssess=function(c,d,e){var f=window.btoa(c),g=window.btoa(d),h=window.btoa(e);b.fetchMarksheetPerAssess(f,g,h).fetch({},function(b){if(a.success=!1,b.status=200)if(b.data.byteLength>0){a.success=!0;var c=new Blob([b.data],{type:"application/pdf"});a.fileURL=URL.createObjectURL(c),a.renderPDF(a.fileURL,document.getElementById("pdf-holder"))}else console.log("Reponse.data.byteLength = "+b.data.byteLength)},function(a){console.log("Error Unable to download the page")})},a.renderPDF=function(a,b){function c(a){var c=a.getViewport(e),d=document.createElement("canvas"),f=d.getContext("2d"),g={canvasContext:f,viewport:c};d.height=c.height,d.width=c.width,b.appendChild(d),a.render(g)}function d(a){for(var b=1;b<=a.numPages;b++)a.getPage(b).then(c);console.log("Render Pages !!")}var e=1.7;console.log("Render PDF !!"),PDFJS.getDocument(a).then(d)},a.downloadPdf=function(){window.open(a.fileURL)},a.addMarks=function(e,f,g){if(a.response_msg="",a.response_msg1="",void 0==e||void 0==f||void 0==g)alert("Please Select Year, Class, Section, Student and Assessment");else{c.go("^.add"),a.add=angular.copy(d);var h=window.btoa(e.classRoomId),i=window.btoa(f.assessmentId);b.listExams(h,i).fetch({},function(b){if(a.exams_list={},console.log(b),200==b.status&&void 0!=b.data){var c=angular.fromJson(b.data);a.exams_list=c,a.assessmentId=f.assessmentId,a.classRoomId=e.classRoomId,a.studentId=g.studentId,a.assesmentName=f.assessmentName,a.Exams=a.exams_list.exams,console.log(a.assesmentName),console.log(a.studentId),console.log(a.Exams.length)}})}},a.pass=["Yes","No"],a.addStudentMarks=function(d,e){var f=a.add;console.log(a.classRoomId),console.log(e);var g=window.btoa(a.classRoomId),h=window.btoa(e),i=function(){var b=[];console.log(a.Exams.length);for(var c=0;c<=a.Exams.length;c++)void 0==f.marks[c]&&null==f.marks[c]||void 0==a.Exams[c].subjectName&&null==a.Exams[c].subjectName||b.push({subject:a.Exams[c].subjectName,obtainedScore:f.marks[c],grade:f.grade[c],passed:f.passed[c],examId:a.Exams[c].examId});return console.log(b),b},j={assessmentId:a.assessmentId,assessmentName:a.assesmentName,scores:i(),passed:f.result,comments:f.comments},k=b.addStudentMarks(g,h);k.add({},j,function(b){200!=b.status&&201!=b.status||(c.go("^.result1"),a.fetchYearList()),a.response_msg="Marks added successfully !!!"},function(b){404==b.status?a.response_msg1=b.data.errorMessage:a.response_msg1="Addition of Marks is unsuccessful !!!"})},a.studentMarksListforAssess=function(c,d,e){a.response_msg="",a.response_msg1="";var f=window.btoa(c.classRoomId),g=window.btoa(d.studentId),h=window.btoa(e.assessmentId);a.marks_list={},a.scores=[],b.studentMarksListforAssess(f,g,h).fetch({},function(b){if(console.log(b),b.status=200){var c=angular.fromJson(b.data);a.marks_list=c,void 0!=a.marks_list&&(a.marksObtained=a.marks_list.scores)}},function(b){a.response_msg1="No Marks available",console.log(b.status)})},a.updateMarks=function(e,f,g){if(void 0==e||void 0==f||void 0==g)alert("Please Select Year, Class, Section, Student and Assessment");else{c.go("^.editMarks"),a.edit=angular.copy(d),a.std=g.studentId,a.cls=e.classRoomId;var h=window.btoa(e.classRoomId),i=window.btoa(f.assessmentId),j=window.btoa(g.studentId);b.studentMarksListforAssess(h,j,i).fetch({},function(b){if(console.log(b),b.status=200){var c=angular.fromJson(b.data);if(a.marks_list=c,void 0!=a.marks_list){a.marks=a.marks_list.scores,a.obtainedMarks=[],a.maxMarks=[];for(var d=0;d<a.marks.length;d++)a.obtainedMarks[d]=parseInt(a.marks[d].obtainedScore,10),a.maxMarks[d]=parseInt(a.marks[d].maxScore,10)}}},function(b){a.response_msg1="No Marks available",console.log(b.status)})}},a.updateStudentMarks=function(){var d=window.btoa(a.cls),e=window.btoa(a.std),f=function(){for(var b=[],c=0;c<a.marks.length;c++)void 0==a.maxMarks[c]&&null==a.maxMarks[c]||void 0==a.obtainedMarks[c]&&null==a.obtainedMarks[c]||void 0==a.marks[c].subject&&null==a.marks[c].subject||void 0==a.marks[c].passed||void 0==a.marks[c].grade||(b.push({subject:a.marks[c].subject,obtainedScore:a.obtainedMarks[c],grade:a.marks[c].grade,passed:a.marks[c].passed,examId:a.marks[c].examId}),console.log(a.marks[c].obtainedScore),console.log(a.marks[c].subject),console.log(a.marks[c].examId));return console.log(b),b},g={assessmentId:a.marks_list.assessmentId,assessmentName:a.marks_list.assessmentName,scores:f(),passed:a.marks_list.passed,comments:a.marks_list.comments};console.log("the data is"),console.log(g),console.log("Vaules read !!!");var h=b.updateStudentMarks(d,e);console.log("Response status is: "+h.status);h.add({},g,function(b){200!=b.status&&201!=b.status||(a.marks_list=void 0,a.marksObtained=void 0,c.go("^.result1"),a.fetchYearList()),a.response_msg="Marks Updated successfully !!!"},function(b){a.response_msg1=b.data.errorMessage})},a.cancel=function(){a.response_msg="",a.response_msg1="",a.marksObtained=void 0,c.go("^.result1")},a.back=function(){a.response_msg="",a.response_msg1="",c.go("^.main")}}]),branchManager.factory("eventManagementFactory",["$resource","br_Manager_Config","$window",function(a,b,c){var d={},e=b.getMainAPI(),f=c.localStorage.getItem("authCode");return d.fetchEventsPdfReport=function(b){return a(e+"/event/reports/year/"+b+"/fetch",{},{fetch:{method:"get",responseType:"arraybuffer",headers:{Authorization:f},interceptor:{response:function(a){return console.log("Report Generated  !!!"),a}}}})},d.fetchStandardList=function(b){return a(e+"/classroom/year/"+b,{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d.fetchSectionList=function(b,c){return a(e+"/classroom/standard/"+b+"/section/year/"+c,{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d.fetchEventList=function(b,c,d){return a(e+"/event/year/"+b+"/events?offset="+c+"&limit="+d,{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d.createEventEntry=function(){return a(e+"/event",{},{add:{method:"POST",headers:{Authorization:f,"Content-Type":"application/json"},isArray:!1,interceptor:{response:function(a){return a}}}})},d.updateEvents=function(b){return a(e+"/event/"+b,{},{edit:{method:"PUT",headers:{Authorization:f,"Content-Type":"application/json"},isArray:!1,interceptor:{response:function(a){return a}}}})},d.deleteEvent=function(b){return a(e+"/event/"+b,{},{remove:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d}]),branchManager.controller("eventManagementCtrl",["$scope","eventManagementFactory","br_manager_appConfig","$state","$filter","$modal",function(a,b,c,d,e,f){var g={eventType:"",date:"",time:"",standard:"",dressType:"",eventId:""};a.eventDetails={eventList:[],numPerPage:10,currentPage:1,startValue:0},a.fetchYearList=function(){a.year_list=["2016-17","2017-18","2018-19","2019-20","2020-21"],a.event_list=""},a.fetchEventList=function(c,d,e){a.response_msg="",a.response_msg1="";var c=window.btoa(c);console.log(c),b.fetchEventList(c,d,e).fetch({},function(b){if(console.log(b),200==b.status&&(a.count=b.data.total,console.log(a.count),void 0!=b.data.eventList)){var c=angular.fromJson(b.data.eventList);a.event_list=c,a.totalPages=Math.ceil(a.count/a.eventDetails.numPerPage),a.$parent.setBaseContentHeight(a.event_list.length)}},function(b){a.event_list=[],a.response_msg1="No Events found for this year.",a.$parent.setBaseContentHeight(-1),console.log(b.status)})},a.fetchStandardList=function(c){a.response_msg1="";var c=window.btoa(c);b.fetchStandardList(c).fetch({},function(b){if(a.standard_list=[],console.log(b),(200==b.status||201==b.status)&&void 0!=b.data.standards){var c=angular.fromJson(b.data.standards);a.standard_list=c}},function(b){a.standard_list=[],console.log(b.status)})},a.fetchSectionList=function(c,d){a.response_msg1="",console.log(c);var e=window.btoa(c),d=window.btoa(d);b.fetchSectionList(e,d).fetch({},function(b){if(a.classroom_list=[],console.log(b),(200==b.status||201==b.status)&&void 0!=b.data.classRoomLists){var c=angular.fromJson(b.data.classRoomLists);a.classroom_list=c}},function(b){a.classroom_list=[],console.log(b.status)})},a.addEvent=function(){a.response_msg="",a.response_msg1="",a.add=angular.copy(g),console.log("in add event")},a.other=0,a.event=function(b){hol_to="Class room",hol_to1="Class",angular.equals(hol_to,b)?(a.other=1,console.log("all change")):angular.equals(hol_to1,b)?(a.other=2,console.log("two change")):(a.other=0,console.log("No change"))},a.createEventEntry=function(c){a.response_msg="",a.response_msg1="";var f=a.add;a.add.date.Value=e("date")(new Date(f.date),"yyyy-MM-dd");var g=function(){var b={};return b=angular.equals(f.to,"Class room")?{eventType:f.eventType,date:a.add.date.Value,time:f.time,description:f.description,to:f.to,year:f.year,standard:f.standard,classRoomId:f.classroom.classRoomId,dressType:f.dressType}:angular.equals(f.to,"Class")?{eventType:f.eventType,date:a.add.date.Value,time:f.time,description:f.description,to:f.to,year:f.year,standard:f.standard,dressType:f.dressType}:{eventType:f.eventType,date:a.add.date.Value,time:f.time,description:f.description,to:f.to,year:f.year,dressType:f.dressType}},h=g(),i=b.createEventEntry();i.add({},h,function(b){200!=b.status&&201!=b.status||d.go("^.list"),a.response_msg="Event added Successfully !!!"},function(b){404==b.status?(a.add.eventType="",a.response_msg1=b.data.errorMessage):a.response_msg1="Addition of Event is Failed !!! "})},a.editEvents=function(b){a.response_msg="",a.response_msg1="",a.edit=angular.copy(g),angular.forEach(a.event_list,function(c){b==c.eventId&&(a.edit.eventId=c.eventId,a.edit.eventType=c.eventType,a.edit.date=new Date(c.date),a.edit.time=c.time,a.edit.description=c.description,a.edit.standard=c.standard,a.edit.section=c.section,a.edit.dressType=c.dressType,console.log("eventId "+b))})},a.updateEvents=function(c){a.response_msg="",a.response_msg1="";var f=a.edit;a.edit.date.Value=e("date")(new Date(f.date),"yyyy-MM-dd");var g=' { "eventType":"'+f.eventType+'","date" :"'+a.edit.date.Value+'","time" :"'+f.time+'","description" :"'+f.description+'","standard" :"'+f.standard+'","dressType" :"'+f.dressType+'"}',h=window.btoa(c),i=b.updateEvents(h);i.edit({},g,function(b){200!=b.status&&201!=b.status||(d.go("^.list"),a.fetchYearList()),a.response_msg="Event updated successfully !!!"},function(b){409==b.status?a.response_msg1=b.data.errorMessage:a.response_msg1="Updation of Event is unsuccessful !!!"})},a.deleteEvent=function(c,e){a.response_msg="",a.response_msg1="";var g=window.btoa(c.eventId),h="Are you sure to delete the event ??",i=show_dialoge(f,a,h,"dialoge_content.html");i.result.then(function(c){console.log("Flag value: "+c),c?b.deleteEvent(g).remove({},function(b){200!=b.status&&201!=b.status||(a.event_list="",d.go("^.list"),a.fetchYearList())},function(b){a.response_msg1="event Deletion failed !!!",console.log(b.status)}):console.log("Failed to delete")})},a.$on("$viewContentLoaded",function(){"event"==d.current.name&&void 0!=a.event_list&&a.$parent.setBaseContentHeight(a.event_list.length)}),a.init=function(){a.eventDetails.numPerPage=parseInt(a.eventDetails.numPerPage),a.maxSize=5,a.event_list=[],a.events_to=["School","Class","Class room"]},a.cancel=function(){a.event_list=[],a.response_msg="",a.response_msg1="",d.go("^.list")},a.init(),a.pageChanged=function(b){a.eventDetails.startValue=(a.eventDetails.currentPage-1)*a.eventDetails.numPerPage,a.fetchEventList(b,a.eventDetails.startValue,a.eventDetails.numPerPage)}}]),branchManager.controller("eventReportsCtrl",["$scope","eventManagementFactory","$state",function(a,b,c){a.year_list=["2016-17","2017-18","2018-19","2019-20","2020-21"],a.fetchYearList=function(){},a.generateEventsReport=function(c){if(console.log("Inside event Report()"),console.log(c),void 0==c)window.alert("Please select the Year");else{var c=window.btoa(c);b.fetchEventsPdfReport(c).fetch({},function(b){if(a.success=!1,200==b.status||201==b.status)if(b.data.byteLength>0){a.success=!0,console.log("response status 200 !!"),console.log("Reponse.data.byteLength = "+b.data.byteLength);var c=new Blob([b.data],{type:"application/pdf"});a.fileURL=URL.createObjectURL(c),a.renderPDF(a.fileURL,document.getElementById("pdf-holder"))}else console.log("data Length = "+b.data.byteLength)},function(a){console.log("Error Unable to download the page")})}},a.renderPDF=function(a,b){function c(a){var c=a.getViewport(e),d=document.createElement("canvas"),f=d.getContext("2d"),g={canvasContext:f,viewport:c};d.height=c.height,d.width=c.width,b.appendChild(d),a.render(g)}function d(a){for(var b=1;b<=a.numPages;b++)a.getPage(b).then(c)}var e=1.7;console.log("Render PDF !!"),PDFJS.getDocument(a).then(d)},a.downloadPdf=function(){window.open(a.fileURL)},a.back=function(){a.response_msg="",a.response_msg1="",c.go("events.main")}}]),branchManager.factory("notificationFactory",["$resource","br_Manager_Config","Config","$window",function(a,b,c,d){var e={},f=b.getMainAPI(),g=d.localStorage.getItem("authCode");return e.sendMail=function(b){return a(f+"/email/student/"+b+"/mail",{},{add:{method:"POST",headers:{Authorization:g,"Content-Type":"application/json"},isArray:!1,interceptor:{response:function(a){return a}}}})},e.fetchFacultyList=function(b,c){return a(f+"/faculty?offset="+b+"&limit="+c,{},{fetch:{method:"get",isArray:!1,headers:{Authorization:g},interceptor:{response:function(a){return a}}}})},e.notifyOneFaculty=function(b){return a(f+"/email/faculty/"+b+"/facultymail",{},{add:{method:"POST",headers:{Authorization:g,"Content-Type":"application/json"},isArray:!1,interceptor:{response:function(a){return a}}}})},e.notifyAllFaculty=function(){return a(f+"/email/facultymail",{},{add:{method:"POST",headers:{Authorization:g,"Content-Type":"application/json"},isArray:!1,interceptor:{response:function(a){return a}}}})},e.sendMailNotification=function(b){return a(f+"/email/classroom/"+b+"/emailToclassroom",{},{add:{method:"POST",headers:{Authorization:g,"Content-Type":"application/json"},isArray:!1,interceptor:{response:function(a){return a}}}})},e.schoolMailNotification=function(b){return a(f+"/email/year/"+b+"/mail",{},{add:{method:"POST",headers:{Authorization:g,"Content-Type":"application/json"},isArray:!1,interceptor:{response:function(a){return a}}}})},e.fetchStandardList=function(b){return a(f+"/classroom/year/"+b,{},{fetch:{method:"get",isArray:!1,headers:{Authorization:g},interceptor:{response:function(a){return a}}}})},e.fetchSectionList=function(b,c){return a(f+"/classroom/standard/"+b+"/section/year/"+c,{},{fetch:{method:"get",isArray:!1,headers:{Authorization:g},interceptor:{response:function(a){return a}}}})},e.fetchStudentList=function(b,c,d){return a(f+"/student/year/"+b+"/std/"+c+"/sec/"+d+"/basicinfo",{},{fetch:{method:"get",isArray:!1,headers:{Authorization:g},interceptor:{response:function(a){return a}}}})},e}]),branchManager.controller("notificationCtrl",["$scope","notificationFactory","br_manager_appConfig","$state","$modal",function(a,b,c,d,e){var f={studetId:"",subject:"",description:"",classRoomId:""};a.fetchYearList=function(){a.year_list=["2016-17","2017-18","2018-19","2019-20","2020-21"]},a.fetchStandardList=function(c){var d=window.btoa(c);b.fetchStandardList(d).fetch({},function(b){if(a.standard_list=[],console.log(a.standard_list),(200==b.status||201==b.status)&&void 0!=b.data.standards){var c=angular.fromJson(b.data.standards);a.standard_list=c}},function(b){a.standard_list=[],console.log(b.status)})},a.fetchSectionList=function(c,d){a.response_msg="";var e=window.btoa(c),f=window.btoa(d);b.fetchSectionList(e,f).fetch({},function(b){if(a.classroom_list=[],console.log(b),(200==b.status||201==b.status)&&void 0!=b.data.classRoomLists){var c=angular.fromJson(b.data.classRoomLists);a.classroom_list=c,a.classroom_list.length>0}},function(b){a.classroom_list=[],a.$parent.setBaseContentHeight(-1),console.log(b.status)})},a.fetchStudentList=function(c,d,e){a.response_msg="";var f=window.btoa(c),g=window.btoa(d),h=window.btoa(e.section);console.log(c+":"+d+":"+e.section),b.fetchStudentList(f,g,h).fetch({},function(b){if(a.student_list=[],a.student_details={},console.log(b),(200==b.status||201==b.status)&&void 0!=b.data.students){var c=angular.fromJson(b.data.students);a.student_list=c,console.log("data:-"+a.student_list.length)}},function(b){a.student_list=[],a.response_msg="No students found for this section.",console.log(b.status)})},a.fetchFacultyList=function(c,d){a.response_msg1="",b.fetchFacultyList(c,d).fetch({},function(b){if(a.faculty_list=[],console.log(b),200==b.status&&(a.count=b.data.total,void 0!=b.data.faculties)){var c=angular.fromJson(b.data.faculties);a.faculty_list=c}},function(b){a.faculty_list=[],console.log(b.status)})},a.mailNotify=function(){a.response_msg="",a.response_msg1="",a.add=angular.copy(f),console.log("inside mailTo !!")},a.sendMail=function(c){var e=a.add;console.log("inside sendMail !!");var f=' { "subject":"'+e.subject+'","description" :"'+e.description+'"}';console.log("read the inputs !!");var g=window.btoa(c.studentId);console.log(c);var h=b.sendMail(g);h.add({},f,function(b){200!=b.status&&201!=b.status||(a.response_msg1="Mails sent to student successfully !!!",console.log("Sent successfully")),d.go("^.email"),a.response_msg="Mail sent to student successfully !!!"},function(b){409==b.status?(a.response_msg1=b.data.errorMessage,console.log("409 error")):404==b.status?a.response_msg1=b.data.errorMessage:a.response_msg1="Sending mail to faculties unsuccessful !!!",console.log("Error in sending")})},a.sendMailNotification=function(c,e,f){console.log(c),console.log(e),console.log(f.classRoomId);var g=a.add;console.log("inside sendMailNotification !!");var h=' { "subject":"'+g.subject+'","description" :"'+g.description+'"}';console.log("read the inputs !!"),console.log(f.classRoomId);var f=window.btoa(f.classRoomId),i=b.sendMailNotification(f);i.add({},h,function(b){200!=b.status&&201!=b.status||(a.response_msg1="Mails sent to all students successfully !!!"),d.go("^.email"),a.response_msg1="Mails sent to all students successfully !!!"},function(b){409==b.status?(a.response_msg1=b.data.errorMessage,console.log("409 error")):404==b.status?a.response_msg1=b.data.errorMessage:a.response_msg1="Sending mail to faculties unsuccessful !!!"})},a.schoolMailNotification=function(c){var e=a.add;console.log("inside schoolMailNotification !!");var f=' { "subject":"'+e.subject+'","description" :"'+e.description+'"}';console.log("read the inputs !!");var g=window.btoa(c),h=b.schoolMailNotification(g);h.add({},f,function(b){200!=b.status&&201!=b.status||(d.go("^.email"),a.response_msg1="Mails sent to School successfully !!!")},function(b){409==b.status?(a.response_msg1=b.data.errorMessage,console.log("409 error")):404==b.status?a.response_msg1=b.data.errorMessage:a.response_msg1="Sending mail to faculties unsuccessful !!!"})},a.notifyAllFaculty=function(){var c=a.add;console.log("inside sendMail !!");var e=' { "subject":"'+c.subject+'","description" :"'+c.description+'"}';console.log("read the inputs !!");var f=b.notifyAllFaculty();f.add({},e,function(b){200!=b.status&&201!=b.status||(a.response_msg1="Mails sent to faculties successfully !!!",console.log("Sent successfully")),d.go("^.email")},function(b){409==b.status?a.response_msg1="Sending mail to faculties unsuccessful !!!":404==b.status?a.response_msg1=b.data.errorMessage:a.response_msg1="Sending mail to faculties unsuccessful !!!",console.log("Error in sending")})},a.notifyOneFaculty=function(c){var e=a.add;console.log("inside sendMail !!");var f=' { "subject":"'+e.subject+'","description" :"'+e.description+'"}';console.log("read the inputs !!");
var g=window.btoa(c.facultyId),h=b.notifyOneFaculty(g);h.add({},f,function(b){200!=b.status&&201!=b.status||(a.response_msg1="Mails sent to student successfully !!!",console.log("Sent successfully")),d.go("^.email")},function(b){409==b.status?(a.response_msg1="Sending mail to faculties unsuccessful !!!",console.log("409 error")):404==b.status?a.response_msg1=b.data.errorMessage:a.response_msg1="Sending mail to faculties unsuccessful !!!",console.log("Error in sending")})},a.init=function(){a.fetchYearList()},a.cancel1=function(){a.response_msg="",a.response_msg1="",d.go("^.email")},a.init()}]),branchManager.directive("fileModel",["$parse",function(a){return{restrict:"A",link:function(b,c,d){var e=a(d.fileModel),f=e.assign;c.bind("change",function(){b.$apply(function(){f(b,c[0].files[0])})})}}}]),branchManager.service("fileUpload",["$http",function(a){this.uploadFileToUrl=function(b,c){var d=new FormData;d.append("file",b),a.post(c,d,{transformRequest:angular.identity,headers:{"Content-Type":void 0}}).success(function(){}).error(function(){})}}]),branchManager.controller("myCtrl",["$scope","fileUpload",function(a,b){a.uploadFile=function(){var c=a.myFile;console.log("file is "),console.dir(c);var d=notificationFactory.url;b.uploadFileToUrl(c,d)}}]),branchManager.factory("reportFactory",["$resource","br_Manager_Config","$window",function(a,b,c){var d={},e=b.getMainAPI(),f=c.localStorage.getItem("authCode");return d.fetchBranchFeePdfReport=function(b,c,d){return a(e+"/reports/year/"+b+"/startDate/"+c+"/endDate/"+d,{},{fetch:{method:"get",responseType:"arraybuffer",headers:{Authorization:f},interceptor:{response:function(a){return console.log("Report Generated !!!"),a}}}})},d.feesReportForYear=function(b,c){return a(e+"/reports/student/"+c+"/year/"+b,{},{fetch:{method:"get",responseType:"arraybuffer",headers:{Authorization:f},interceptor:{response:function(a){return console.log("Report Generated !!!"),a}}}})},d.fetchViolationXlsReport=function(){return a(e+"/reports/xls",{},{fetch:{method:"get",responseType:"arraybuffer",headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d.fetchStudentList=function(b,c,d){return a(e+"/student/year/"+b+"/std/"+c+"/sec/"+d+"/basicinfo",{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d.fetchStandardList=function(b){return a(e+"/classroom/year/"+b,{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d.fetchClassRoomlist=function(b,c){return a(e+"/classroom/standard/"+b+"/section/year/"+c,{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d}]),branchManager.controller("reportCtrl",["$scope","reportFactory","$state","$filter",function(a,b,c,d){a.fetchYearList=function(){a.year_list=["2016-17","2017-18","2018-19","2019-20","2020-21"]},a.fetchStandardList=function(c){var d=window.btoa(c);b.fetchStandardList(d).fetch({},function(b){if(a.standard_list=[],console.log(a.standard_list),(200==b.status||201==b.status)&&void 0!=b.data.standards){var c=angular.fromJson(b.data.standards);a.standard_list=c,a.standard_list.length>0}},function(b){a.standard_list=[],console.log(b.status)})},a.fetchClassRoomlist=function(c,d){a.response_msg="";var e=window.btoa(c),f=window.btoa(d);b.fetchClassRoomlist(e,f).fetch({},function(b){if(a.classroom_list=[],console.log(b),(200==b.status||201==b.status)&&void 0!=b.data.classRoomLists){var c=angular.fromJson(b.data.classRoomLists);a.classroom_list=c,a.classroom_list.length>0}},function(b){a.classroom_list=[],console.log(b.status)})},a.fetchStudentList=function(c,d,e){var f=window.btoa(c),g=window.btoa(d),h=window.btoa(e.section);b.fetchStudentList(f,g,h).fetch({},function(b){if(a.student_list=[],console.log(b),(200==b.status||201==b.status)&&void 0!=b.data.students){var c=angular.fromJson(b.data.students);a.student_list=c,console.log("data:-"+a.student_list.length)}},function(b){a.student_list=[],console.log(b.status)})},a.generateReport=function(c,e,f,g){if(console.log(e),void 0==c||void 0==e||void 0==f||void 0==g)window.alert("Please Select Year, StartDate and EndDate");else if("branchFee"==c){var e=window.btoa(e),h=d("date")(new Date(f),"yyyy-MM-dd"),i=d("date")(new Date(g),"yyyy-MM-dd");console.log(h),console.log(i);var j=window.btoa(h),k=window.btoa(i);b.fetchBranchFeePdfReport(e,j,k).fetch({},function(b){if(a.success=!1,console.log(b),console.log("Inside the gerearteReport Function"),b.status=200)if(console.log("Response code is 200 !!"),b.data.byteLength>0){a.success=!0,console.log("Response is True !!");var c=new Blob([b.data],{type:"application/pdf"});a.fileURL=URL.createObjectURL(c),a.renderPDF(a.fileURL,document.getElementById("pdf-holder")),console.log("Call to render pdf !!")}else console.log("Reponse.data.byteLength = "+b.data.byteLength)},function(a){console.log("errorrrrrr")})}},a.feesReportForYear=function(c,d){console.log(c),console.log(d);var e=window.btoa(c),d=window.btoa(d);void 0==c||void 0==d?window.alert("Please Select Year, Class, Section and Student"):b.feesReportForYear(e,d).fetch({},function(b){if(a.success=!1,console.log(b),console.log("Inside the gerearteReport Function"),b.status=200)if(console.log("Response code is 200 !!"),b.data.byteLength>0){a.success=!0,console.log("Response is True !!");var c=new Blob([b.data],{type:"application/pdf"});a.fileURL=URL.createObjectURL(c),a.renderPDF(a.fileURL,document.getElementById("pdf-holder")),console.log("Call to render pdf !!")}else console.log("Reponse.data.byteLength = "+b.data.byteLength)},function(a){console.log("errorrrrrr")})},a.renderPDF=function(a,b){function c(a){var c=a.getViewport(e),d=document.createElement("canvas"),f=d.getContext("2d"),g={canvasContext:f,viewport:c};d.height=c.height,d.width=c.width,b.appendChild(d),a.render(g)}function d(a){for(var b=1;b<=a.numPages;b++)a.getPage(b).then(c)}var e=1.7;console.log("Render PDF !!"),PDFJS.getDocument(a).then(d)},a.downloadPdf=function(){window.open(a.fileURL)},a.back=function(){a.response_msg="",a.response_msg1="",c.go("reports.back")}}]),branchManager.factory("transferCertificateFactory",["$resource","br_Manager_Config","$window",function(a,b,c){var d={},e=b.getMainAPI(),f=c.localStorage.getItem("authCode");return d.fetchStudentList=function(b,c,d){return a(e+"/student/year/"+b+"/std/"+c+"/sec/"+d+"/basicinfo",{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d.fetchStandardList=function(b){return a(e+"/classroom/year/"+b,{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d.fetchSectionList=function(b,c){return a(e+"/classroom/standard/"+b+"/section/year/"+c,{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d.fetchTransferCertificateList=function(){return a(e,{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d.transferCertificate=function(b){return console.log("student Id "+b),a(e+"/student/"+b+"/reports",{},{fetch:{method:"get",responseType:"arraybuffer",headers:{Authorization:f},interceptor:{response:function(a){return console.log("Report Generated !!!"),a}}}})},d}]),branchManager.controller("transferCertificateCtrl",["$scope","transferCertificateFactory","$state",function(a,b,c){a.fetchYearList=function(){a.year_list=["2016-17","2017-18","2018-19","2019-20","2020-21"]},a.fetchStandardList=function(c){var d=window.btoa(c);b.fetchStandardList(d).fetch({},function(b){if(a.standard_list=[],console.log(a.standard_list),(200==b.status||201==b.status)&&void 0!=b.data.standards){var c=angular.fromJson(b.data.standards);a.standard_list=c,a.standard_list.length>0}},function(b){a.standard_list=[],console.log(b.status)})},a.fetchSectionList=function(c,d){a.response_msg="";var e=window.btoa(c),f=window.btoa(d);b.fetchSectionList(e,f).fetch({},function(b){if(a.classroom_list=[],console.log(b),(200==b.status||201==b.status)&&void 0!=b.data.classRoomLists){var c=angular.fromJson(b.data.classRoomLists);a.classroom_list=c,a.classroom_list.length>0}},function(b){a.classroom_list=[],a.$parent.setBaseContentHeight(-1),console.log(b.status)})},a.fetchStudentList=function(c,d,e){var f=window.btoa(c),g=window.btoa(d),h=window.btoa(e.section);b.fetchStudentList(f,g,h).fetch({},function(b){if(a.student_list=[],console.log(b),(200==b.status||201==b.status)&&void 0!=b.data.students){var c=angular.fromJson(b.data.students);a.student_list=c}},function(a){console.log(a.status)})},a.transferCertificate=function(c){console.log("Inside transferCertificate()"),console.log("studentId="+c);var d=window.btoa(c);void 0==c?window.alert("Please Select Year, Class, Section and Student"):b.transferCertificate(d).fetch({},function(b){if(a.success=!1,b.status=200)if(b.data.byteLength>0){a.success=!0,console.log("response status 200 !!"),console.log("Download Complete !!! content length: "+b.data.byteLength);var c=new Blob([b.data],{type:"application/pdf"});a.fileURL=URL.createObjectURL(c),a.renderPDF(a.fileURL,document.getElementById("pdf-holder"))}else console.log("Reponse.data.byteLength = "+b.data.byteLength)},function(a){console.log("Error Unable to download the page")})},a.renderPDF=function(a,b){function c(a){var c=a.getViewport(e),d=document.createElement("canvas"),f=d.getContext("2d"),g={canvasContext:f,viewport:c};d.height=c.height,d.width=c.width,b.appendChild(d),a.render(g)}function d(a){for(var b=1;b<=a.numPages;b++)a.getPage(b).then(c);console.log("Render Pages !!")}var e=1.7;console.log("Render PDF !!"),PDFJS.getDocument(a).then(d)},a.downloadPdf=function(){window.open(a.fileURL)},a.back=function(){a.response_msg="",a.response_msg1="",c.go("reports.main")}}]),branchManager.factory("fileUploadFactory",["$resource","br_Manager_Config","$window","$http",function(a,b,c,d){var e={},f=c.localStorage.getItem("authCode"),g=b.getMainAPI();return e.fecthAssesmentList=function(b){return a(g+"/classroom/"+b+"/assessment/fetch",{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},e.fetchStandardList=function(b){return a(g+"/classroom/year/"+b,{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},e.fetchSectionList=function(b,c){return a(g+"/classroom/standard/"+b+"/section/year/"+c,{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},e.uploadUrls=function(){return a(g+"/videourl",{},{add:{method:"POST",headers:{Authorization:f,"Content-Type":"application/json"},isArray:!1,interceptor:{response:function(a){return a}}}})},e.uploadOrgLogo=function(a){var b=new FormData;b.append("file",a),d.post(g+"/image/orglogo",b,{transformRequest:angular.identity,headers:{Authorization:f,"Content-Type":void 0}}).success(function(){alert("Photo uploaded Successfully !!!")}).error(function(){alert("Uploading photo is unsuccessful !!!")})},e.uploadBranchLogo=function(a){var b=new FormData;b.append("file",a),d.post(g+"/image/schoolphoto",b,{transformRequest:angular.identity,headers:{Authorization:f,"Content-Type":void 0}}).success(function(){alert("Photo uploaded Successfully !!!")}).error(function(){alert("Uploading photo is unsuccessful !!!")})},e.uploadInventory=function(){return url=g+"/inventory/bulkupload"},e.uploadVehicle=function(){return url=g+"/vehicle/bulkupload"},e.uploadLibrary=function(){return url=g+"/library/bulkupload"},e.uploadStudents=function(a){return url=g+"/classroom/"+a+"/bulkupload"},e.uploadMarksheet=function(a,b){return url=g+"/classroom/"+a+"/assessment/"+b+"/marksheet/bulkupload"},e.downloadInventory=function(){return a(g+"/inventory/xlsSheet",{},{fetch:{method:"get",responseType:"arraybuffer",headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},e.downloadVehicle=function(){return a(g+"/vehicle/vehiclexls",{},{fetch:{method:"get",responseType:"arraybuffer",headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},e.downloadLibrary=function(){return a(g+"/library/xlsSheet",{},{fetch:{method:"get",responseType:"arraybuffer",headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},e.downloadFaculty=function(){return a(g+"/faculty/xlsSheet",{},{fetch:{method:"get",responseType:"arraybuffer",headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},e.downloadStudents=function(b){return a(g+"/student/classroom/"+b+"/studentXls",{},{fetch:{method:"get",responseType:"arraybuffer",headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},e.downloadMarksheet=function(b,c){return a(g+"/classRoom/"+b+"/markssheet/assessment/"+c+"/xlsSheet",{},{fetch:{method:"get",responseType:"arraybuffer",headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},e}]),branchManager.directive("fileModel",["$parse",function(a){return{restrict:"A",link:function(b,c,d){var e=a(d.fileModel),f=e.assign;c.bind("change",function(){b.$apply(function(){f(b,c[0].files[0])})})}}}]),branchManager.service("fileUpload",["$http","$window",function(a,b){var c=b.localStorage.getItem("authCode");this.uploadFileToUrl=function(b,d){var e=new FormData;e.append("file",b),a.post(d,e,{transformRequest:angular.identity,headers:{Authorization:c,"Content-Type":void 0}}).then(function(a){alert(a.data.errorMessage)},function(a){alert(a.data.errorMessage)})}}]),branchManager.controller("fileUploadCtrl",["$scope","fileUpload","fileUploadFactory","br_manager_appConfig","$state",function(a,b,c,d,e){var f={videoName:"",imageUrl:"",videoUrl:"",eventName:""};a.uploadYearList=function(){a.year_list=["2016-17","2017-18","2018-19","2019-20","2020-21"]},a.fetchStandardList=function(b){var d=window.btoa(b);c.fetchStandardList(d).fetch({},function(b){if(a.standard_list=[],(200==b.status||201==b.status)&&void 0!=b.data.standards){var c=angular.fromJson(b.data.standards);a.standard_list=c,console.log(a.standard_list),a.standard_list.length>0}},function(b){a.standard_list=[],a.response_msg="There is no Standards found for this year.",console.log(b.status)})},a.fetchSectionList=function(b,d){a.response_msg="";var e=window.btoa(d),f=window.btoa(b);c.fetchSectionList(f,e).fetch({},function(b){if(a.classroom_list=[],console.log(b),(200==b.status||201==b.status)&&void 0!=b.data.classRoomLists){var c=angular.fromJson(b.data.classRoomLists);a.classroom_list=c}},function(b){a.classroom_list=[],a.response_msg="There is no classrooms found for this year.",console.log(b.status)})},a.fecthAssesmentList=function(b){a.response_msg="";var d=window.btoa(b.classRoomId);c.fecthAssesmentList(d).fetch({},function(b){if(a.assessment_list=[],console.log(b),200==b.status&&(a.count=b.data.total,void 0!=b.data.assessmentLists)){var c=angular.fromJson(b.data.assessmentLists);a.assessment_list=c}},function(b){a.assessment_list=[],a.$parent.setBaseContentHeight(-1),console.log(b.status)})},a.addUrl=function(){a.response_msg="",a.response_msg1="",a.add=angular.copy(f)},a.uploadUrls=function(){var b=a.add,d=' { "videoName":"'+b.videoName+'","imageUrl":"'+b.imageUrl+'","videoUrl" :"'+b.videoUrl+'","eventName" :"'+b.eventName+'"}',e=c.uploadUrls();e.add({},d,function(b){200!=b.status&&201!=b.status||(a.response_msg="Url Saved Successfully !!!")},function(b){404==b.status?a.response_msg1=b.data.errorMessage:a.response_msg1="Url Saving is Unsuccessful !!!"})},a.uploadOrgLogo=function(){if(void 0!=a.orgLogo){var b=a.orgLogo;console.log("file is "),console.dir(b),c.uploadOrgLogo(b)}else window.alert("Please select the file !!")},a.uploadBranchLogo=function(){if(void 0!=a.branchLogo){var b=a.branchLogo;console.log("file is "),console.dir(b),c.uploadBranchLogo(b)}else window.alert("Please select the file !!")},a.uploadInventory=function(){var d={};if(void 0==a.xlsInventory)window.alert("Please select the file");else{d=a.xlsInventory,console.log("file is "),console.dir(d);var e=c.uploadInventory();b.uploadFileToUrl(d,e),a.response_msg="File uploaded successfully!!!",a.xlsInventory=""}},a.uploadVehicle=function(){var d={};if(void 0==a.xlsVehicle)window.alert("Please select the file");else{d=a.xlsVehicle,console.log("file is "),console.dir(d);var e=c.uploadVehicle();b.uploadFileToUrl(d,e),a.response_msg="File uploaded successfully!!!",a.xlsVehicle=""}},a.uploadLibrary=function(){var d={};if(void 0==a.xlsLibrary)window.alert("Please select the file");else{d=a.xlsLibrary,console.log("file is "),console.dir(d);var e=c.uploadLibrary();b.uploadFileToUrl(d,e),a.response_msg="File uploaded successfully!!!",a.xlsLibrary=""}},a.uploadStudents=function(d){var e=window.btoa(d.classRoomId),f={};if(void 0==a.xlsStudents)window.alert("Please select the file");else{f=a.xlsStudents,console.log("file is "),console.dir(f);var g=c.uploadStudents(e);b.uploadFileToUrl(f,g),a.response_msg="File uploaded successfully!!!",a.xlsLibrary=""}},a.uploadMarksheet=function(d,e){var f=window.btoa(d.classRoomId);console.log(d.classRoomId),console.log(e.assessmentName);var g=window.btoa(e.assessmentId),h={};if(void 0==a.xlsMarksheet)window.alert("Please select the file");else{h=a.xlsMarksheet,console.log("file is "),console.dir(h);var i=c.uploadMarksheet(f,g);b.uploadFileToUrl(h,i),a.response_msg="File uploaded successfully!!!",a.xlsLibrary=""}},a.downloadStudents=function(b){a.response_msg="";var d=window.btoa(b);c.downloadStudents(d).fetch({},{},function(a){if((a.status=200)&&a.data.byteLength>0){var b=new Blob([a.data],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/vnd.ms-excel"}),c=URL.createObjectURL(b);window.open(c)}},function(a){console.log("downlaod error")})},a.downloadMarksheet=function(b,d){a.response_msg="",console.log(d);var e=window.btoa(b),f=window.btoa(d);c.downloadMarksheet(e,f).fetch({},{},function(a){if((a.status=200)&&a.data.byteLength>0){var b=new Blob([a.data],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/vnd.ms-excel"}),c=URL.createObjectURL(b);window.open(c)}},function(a){console.log("downlaod error")})},a.downloadLibrary=function(){a.response_msg="",c.downloadLibrary().fetch({},{},function(a){if((a.status=200)&&a.data.byteLength>0){var b=new Blob([a.data],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/vnd.ms-excel"}),c=URL.createObjectURL(b);window.open(c)}},function(a){console.log("downlaod error")})},a.downloadInventory=function(){a.response_msg="",c.downloadInventory().fetch({},{},function(a){if((a.status=200)&&a.data.byteLength>0){var b=new Blob([a.data],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/vnd.ms-excel"}),c=URL.createObjectURL(b);window.open(c)}},function(a){console.log("downlaod error")})},a.downloadVehicle=function(){a.response_msg="",c.downloadVehicle().fetch({},{},function(a){if((a.status=200)&&a.data.byteLength>0){var b=new Blob([a.data],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/vnd.ms-excel"}),c=URL.createObjectURL(b);window.open(c)}},function(a){console.log("downlaod error")})},a.downloadFaculty=function(){a.response_msg="",c.downloadFaculty().fetch({},{},function(a){if((a.status=200)&&a.data.byteLength>0){var b=new Blob([a.data],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/vnd.ms-excel"}),c=URL.createObjectURL(b);window.open(c)}},function(a){console.log("downlaod error")})},a.cancel=function(){a.response_msg="",a.response_msg1="",e.go("xlsfiles.files")},a.init=function(){},a.init()}]);