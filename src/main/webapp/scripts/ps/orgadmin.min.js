function error(a,b,c,d){console.log(d.$promise.getState()),404==a.status}function error(a,b){console.log("Error Response code : "+a.status)}function show_dialoge(a,b,c,d){return a.open({scope:b,templateUrl:d,controller:"dialogeCtrl",resolve:{message:function(){return c}}})}function goToHome(){$(".sidebar-menu #dashboard a").trigger("click")}var login_app=angular.module("login_app",["blockUI","config_app","ngRoute","ngResource"]);login_app.config(["$locationProvider","blockUIConfig",function(a,b){a.html5Mode({enabled:!0,requireBase:!0}),b.message="Logging In ..."}]),login_app.factory("loginFactory",["$resource","Config",function(a,b){var c={},d=b.getLoginApi();return c.getLogin=function(b){return a(d+"/"+b,{},{login:{method:"POST",headers:{"Content-Type":"application/json"},interceptor:{response:function(a){return a}}}})},c}]),login_app.controller("loginController",["$scope","loginFactory","$window",function(a,b,c){a.username="",a.password="",a.login=function(){var d='{"userName":"'+a.username+'","password":"'+a.password+'"}';b.getLogin(a.login_as).login({},d,function(a){if(200==a.status){var b=a.data;c.sessionStorage.setItem("orgId",b.orgId),c.sessionStorage.setItem("userId",b.userId),c.localStorage.setItem("authCode",b.authCode),c.location="ps_main.html"}},function(b){console.log(b),0==b.status||(a.$parent.$parent.response_message=b.data)})},a.clearErrorMsg=function(){a.$parent.$parent.response_message=""}}]);var smart_parking=angular.module("smart_parking",["ui.bootstrap","slimScrollDirective","highcharts-ng","googlechart","angularUtils.directives.dirPagination","ngSanitize","config_app","login_app","checklist-model","ui.router"]);smart_parking.controller("mainController",["$scope","$location","Config","$window",function(a,b,c,d){function e(){b.path("/dash")}var f=c.setConfig();f?e():(d.location="index.html",a.$parent.response_message="Please try after some time"),f||(d.location="index.html",a.$parent.response_message="Please try after some time")}]),smart_parking.directive("blink",["$timeout",function(a){return{restrict:"A",transclude:!0,scope:{},controller:function(b,c){function d(){c.css("opacity","1"),a(e,1e3)}function e(){c.css("opacity",".2"),a(d,1e3)}d()},template:"<span ng-transclude></span>",replace:!0}}]),smart_parking.config(["$sceProvider",function(a){a.enabled(!1)}]),smart_parking.directive("fileModel",["$parse",function(a){return{restrict:"A",link:function(b,c,d){var e=a(d.fileModel),f=e.assign;c.bind("change",function(){b.$apply(function(){f(b,c[0].files[0])})})}}}]),smart_parking.directive("resize",["$window",function(a){return function(b,c){var d=angular.element(a);b.getWindowDimensions=function(){return{h:d.height(),w:d.width()}},b.$watch(b.getWindowDimensions,function(a,c){b.windowHeight=a.h,b.windowWidth=a.w,b.style=function(){return{height:a.h-100+"px",width:a.w-100+"px"}}},!0),d.bind("resize",function(){b.$apply()})}}]),smart_parking.config(["$provide",function(a){a.decorator("$sanitize",["$delegate","$log",function(a,b){return function(b,c){var d=a(b,c);return d}}])}]),smart_parking.config(["$stateProvider","$urlRouterProvider","$locationProvider","blockUIConfig",function(a,b,c,d){b.otherwise("/#"),a.state("dash",{url:"/dash",templateUrl:"views/ps/ps_dashboard.html",controller:"dashCtrl"}).state("password",{url:"/password",templateUrl:"views/ps/passwordChange.html",controller:"password1Ctrl"}).state("branch",{"abstract":!0,url:"/branch",template:'<div ui-view style="height:100%"></div>',controller:"branchController"}).state("branch.list",{url:"",templateUrl:"views/ps/ps_branches.html"}).state("branch.add",{url:"",templateUrl:"views/ps/ps_add_branch.html"}).state("branch.edit",{url:"",templateUrl:"views/ps/ps_editBranch.html"}).state("fees",{"abstract":!0,url:"/fees",template:'<div ui-view style="height:100%"></div>',controller:"feeController"}).state("fees.list",{url:"",templateUrl:"views/ps/ps_fees.html"}).state("fees.add",{url:"",templateUrl:"views/ps/ps_add_fee.html"}).state("fees.edit",{url:"",templateUrl:"views/ps/ps_editFee.html"}).state("branchManagers",{url:"/branchManagers",template:'<div ui-view style="height:100%"></div>',controller:"managerCtrl"}).state("branchManagers.list",{url:"",templateUrl:"views/ps/ps_branchManagers.html"}).state("branchManagers.add",{url:"",templateUrl:"views/ps/ps_addBranchManager.html"}).state("branchManagers.edit",{url:"",templateUrl:"views/ps/ps_editManager.html"}).state("branchOperator",{url:"/branchoperator",template:'<div ui-view style="height:100%"></div>',controller:"operatorCtrl"}).state("branchOperator.list",{url:"",templateUrl:"views/ps/ps_branchOperators.html"}).state("branchOperator.add",{url:"",templateUrl:"views/ps/ps_addOperator.html"}).state("branchOperator.edit",{url:"",templateUrl:"views/ps/ps_editOperator.html"}),c.html5Mode(!0),d.message="Processing ..."}]),smart_parking.run([function(){$(function(){$(document).keydown(function(a){return 116==(a.which||a.keyCode)||82==a.keyCode&&a.ctrlKey?(a.preventDefault(),void console.log(a)):116!=(a.which||a.keyCode)})})}]),smart_parking.factory("spaceFactory",["$resource","Config","$window",function(a,b,c){var d={},e=b.getPasswordApi(),f=b.getOrgAPI(),g=c.localStorage.getItem("authCode");return d.changePassword=function(b){return a(e+"/user/"+b+"/password",{},{pass:{method:"PUT",headers:{Authorization:g,"Content-Type":"application/json"},interceptor:{response:function(a){return a}}}})},d.fetchOrgInfo=function(){return a(f,{},{fetch:{method:"get",isArray:!1,interceptor:{response:function(a){return console.log(a),a}}}})},d}]),smart_parking.controller("spaceController",["$scope","$rootScope","spaceFactory","$window","Config","$modal","$state",function(a,b,c,d,e,f,g){a.todaydate=new Date;c.fetchOrgInfo().fetch({},function(b){if(a.todaydate=new Date,console.log(b),200==b.status||201==b.status){var c=angular.fromJson(b.data),d={orgName:c.orgName,adminName:c.adminName,address:c.address,pincode:c.pincode};console.log(d.orgName),console.log(d.address),console.log(d.pincode),a.$parent.orgName=d.orgName,a.$parent.adminName=d.adminName,a.$parent.address=d.address,a.$parent.pincode=d.pincode,g.go("dash")}},error);a.setBaseContentHeight=function(a){a>10?($(".base-content").css({height:"90%"}),$(".slim-content").slimScroll({height:"88%",alwaysVisible:!1,size:"3px"}).css("width","100%"),$(".table-base .slimScrollDiv").css("min-width","660px")):($(".base-content").height("auto"),$(".slim-content").slimScroll({destroy:!0}))}}]),smart_parking.controller("logoutCtrl",["$scope","$window",function(a,b){a.logout=function(){b.sessionStorage.removeItem("parkingSpaceId"),b.sessionStorage.removeItem("userId"),b.location="index.html"}}]),smart_parking.controller("password1Ctrl",["$scope","spaceFactory","$state","$timeout","$window",function(a,b,c,d,e){var f={username:"",oldPassword:"",newPassword:"",confirmPassword:""};a.passwordChange=function(){a.response_msg="",a.response_msg1="",a.add=angular.copy(f)},a.changePassword=function(){var c=e.sessionStorage.getItem("userId");console.log("uid "+c);var d=a.add,f=' { "username":"'+d.username+'","oldPassword" :"'+d.oldPassword+'","newPassword" :"'+d.newPassword+'","confirmPassword" :"'+d.confirmPassword+'"}',g=window.btoa(c),h=b.changePassword(g);h.pass({},f,function(a){200==a.status&&(alert("Password Changed successfully!!!"),e.location="index.html")},function(b){409==b.status?a.response_msg1=b.data.errorMessage:a.response_msg1="Password change is unsuccessful !!!"})},a.cancel=function(){a.response_msg="",a.response_msg1="",c.go("dash")}}]),smart_parking.controller("dialogeCtrl",["$scope","$modalInstance","message",function(a,b,c){a.message=c,a.ok=function(){b.close(!0)},a.cancel=function(){b.dismiss("cancel")}}]);var setView=function(a,b,c,d,e){d.get(b).then(function(b){$("#"+a).html(e(b.data)(c))})};smart_parking.value("slimScrollConfig",{}),smart_parking.directive("slimScroll",["slimScrollConfig",function(a){var b={};return a&&angular.extend(b,a),{restrict:"A",link:function(a,c,d){var e=angular.extend({},b,a.$eval(d.slimScroll));angular.element(c).slimScroll(e)}}}]),smart_parking.factory("dashFactory",["$resource","Config","$window",function(a,b,c){var d={},e=b.getAssetAPI(),f=c.localStorage.getItem("authCode"),g=b.getBranchManagersAPI();return d.fetchAssetList=function(){return a(e,{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d.sunburstData=function(){return a(g+"/organizationdashboard/studentcountbasedonbranch",{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return console.log(a),a}}}})},d.getStudentCount=function(){return a(g+"/organizationdashboard/studentcount",{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d.newAdmissions=function(){return a(g+"/organizationdashboard/newadmissions",{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d}]),smart_parking.controller("dashCtrl",["$scope","dashFactory",function(a,b){function c(){b.newAdmissions().fetch({},function(b){if(console.log(b),a.chart1_info=[],200==b.status&&void 0!=b.data){var c=angular.fromJson(b.data);a.chart1_info=c,a.branch_list=a.chart1_info.branchInfoWithListStudentCountDTO,a.stCount=a.branch_list,console.log(a.stCount),console.log(a.branch_list),console.log(a.chart1_info)}},function(b){a.chart1_info=[],console.log(b.status)})}function d(){b.getStudentCount().fetch({},function(b){if(console.log(b),a.chart2_info=[],200==b.status&&void 0!=b.data){var c=angular.fromJson(b.data);a.chart2_info=c,a.values=a.chart2_info.studentCountInOrganizationDTO}},function(b){a.chart2_info=[],console.log(b.status)})}function e(){b.sunburstData().fetch({},function(b){if(console.log(b),a.data=[],200==b.status&&void 0!=b.data){var c=angular.fromJson(b.data);a.burstvalues=c;var d=a.burstvalues;a.data=d,console.log("Required Data"+a.data)}},function(b){a.data=[],console.log(b.status)})}a.fetchAssetList=function(){a.response_msg="",b.fetchAssetList().fetch({},function(b){if(a.asset_info=[],console.log(b),200==b.status&&void 0!=b.data){var c=angular.fromJson(b.data);a.asset_info=c}},function(b){a.asset_info=[],console.log(b.status)})},c(),d(),e(),a.init=function(){a.fetchAssetList()},a.init()}]),smart_parking.directive("pieChart",function(){return{restrict:"E",scope:{values:"="},link:function(a,b,c){a.$watch("values",function(a){if(a){var b={top:40,right:5,bottom:20,left:30},c=400-b.left-b.right,d=300-b.top-b.bottom,e=Math.min(c,d)/2,f=d3.scale.ordinal().range(["#ff3300","#0066ff","#009933","#8000ff","#00e6e6","#004080","#b35900"]),g=d3.svg.arc().outerRadius(e-10).innerRadius(0),h=d3.svg.arc().innerRadius(0).outerRadius(e),i=d3.layout.pie().sort(null).value(function(a){return a.studentCount}),j=d3.select("#piechart").append("svg").attr("width",c).attr("height",d).append("g").attr("transform","translate("+c/2+","+d/2+")"),k=j.selectAll(".arc").data(i(a)).enter().append("g").attr("class","arc");k.append("path").attr("d",g).style("fill",function(a){return f(a.data.branchId)}).on("mouseover",function(a){d3.select(this).transition().duration(500).attr("d",h)}).on("mouseout",function(a){d3.select(this).transition().duration(500).attr("d",g)}),k.append("text").attr("transform",function(a){return"translate("+g.centroid(a)+")"}).attr("dy",".35em").style("text-anchor","middle").text(function(a){return a.data.branchId})}})}}}),smart_parking.directive("barChart",function(){return{restrict:"E",scope:{values:"="},link:function(a,b,c){a.$watch("values",function(a){if(a){var b={top:30,right:5,bottom:20,left:50},c=400-b.left-b.right,d=300-b.top-b.bottom,e=5,f=d3.scale.ordinal().range(["#00ff00","#ff9900","#666633","#6666ff","#ff5050","#006699","#993333"]),g=d3.scale.linear().domain([0,a.length]).range([0,c]),h=d3.scale.linear().domain([0,d3.max(a,function(a){return a.studentCount})]).range([d,0]),i=(d3.svg.axis().scale(h),d3.svg.axis().scale(g).orient("bottom"),d3.tip().attr("class","d3-tip").offset([-10,0]).html(function(a){return"<strong>Branch Id :</strong> <span style='color:red'>"+a.branchId+"</span><br/><strong>Student Count:</strong> <span style='color:red'>"+a.studentCount+"</span>"})),j=d3.select("#barchart").append("svg").attr("width",c+b.left+b.right).attr("height",d+b.top+b.bottom).append("g").attr("transform","translate("+b.left+","+b.top+")");j.call(i),j.selectAll("rect").data(a).enter().append("rect").attr("x",function(a,b){return g(b)}).on("mouseover",i.show).on("mouseout",i.hide).attr("width",c/a.length-e).attr("height",0).transition().duration(500).delay(function(a,b){return 50*b}).attr("y",function(a){return console.log(h(a.studentCount)),h(a.studentCount)}).attr("height",function(a){return console.log(d),console.log(d-h(a.studentCount)),d-h(a.studentCount)}).attr("fill",function(a){return f(a.branchId)}),j.selectAll("text").data(a).enter().append("text").text(function(a){return a.studentCount}).attr("text-anchor","middle").attr("x",function(b,d){return d*(c/a.length)+(c/a.length-e)/2}).attr("y",function(a){return console.log(a.studentCount),h(a.studentCount)+14}).attr("class","yAxis");var k=j.append("g").attr("transform","translate("+b.left+","+(b.top+d)+")");k.selectAll("text.xAxis").data(a).enter().append("text").text(function(a){return a.branchId}).attr("text-anchor","middle").attr("x",function(b,d){return d*(c/a.length)+(c/a.length-e)/2}).attr("y",15).style("fill","yellow").attr("class","xAxis")}})}}}),smart_parking.directive("donutChart",function(){return{restrict:"E",scope:{values:"="},link:function(a,b,c){a.$watch("values",function(a){if(a){var b={top:40,right:5,bottom:20,left:30},c=400-b.left-b.right,d=300-b.top-b.bottom,e=Math.min(c,d)/2,f=d3.scale.ordinal().range(["#0000ff","#ff3300","#00ff00","#ff00ff","#ff0080","#6600ff","#ff5500"]),g=d3.svg.arc().outerRadius(e-10).innerRadius(e/2),h=d3.svg.arc().innerRadius(e/2-15).outerRadius(e-10),i=d3.layout.pie().sort(null).value(function(a){return a.studentCount}),j=d3.select("#donutchart").append("svg").attr("width",c).attr("height",d).append("g").attr("transform","translate("+c/2+","+d/2+")"),k=j.selectAll(".arc").data(i(a)).enter().append("g").attr("class","arc");k.append("path").attr("d",g).style("fill",function(a){return f(a.data.branchId)}).on("mouseover",function(a){d3.select(this).transition().duration(500).attr("d",h)}).on("mouseout",function(a){d3.select(this).transition().duration(500).attr("d",g)}),k.append("text").attr("transform",function(a){return"translate("+g.centroid(a)+")"}).attr("dy",".35em").style("text-anchor","middle").text(function(a){return a.data.studentCount})}})}}}),smart_parking.directive("lineChart",function(){return{restrict:"E",scope:{values:"="},link:function(a,b,c){a.$watch("values",function(a){if(a){var a=[{studentCount:"102",year:"2000"},{studentCount:"215",year:"2001"},{studentCount:"179",year:"2002"},{studentCount:"199",year:"2003"},{studentCount:"134",year:"2003"},{studentCount:"176",year:"2010"}];console.log("values from directive: ",a);var b={top:30,right:5,bottom:20,left:50},c=400-b.left-b.right,d=300-b.top-b.bottom,e=d3.scale.linear().range([b.left,c-b.right]).domain([2e3,2010]),f=d3.scale.linear().range([d-b.top,b.bottom]).domain([0,d3.max(a,function(a){return a.studentCount})]),g=d3.svg.axis().scale(e).ticks(5),h=d3.svg.axis().scale(f).orient("left"),i=d3.select("#linechart").append("svg").attr("width",c).attr("height",d);i.append("g").attr("class","axis").attr("transform","translate(0,"+(d-b.bottom)+")").call(g),i.append("g").attr("class","axis").attr("transform","translate("+b.left+",0)").call(h);var j=d3.svg.line().x(function(a){return console.log(a.year),e(a.year)}).y(function(a){return console.log(a.studentCount),f(a.studentCount)}).interpolate("basis");i.append("path").attr("d",j(a)).attr("stroke","green").attr("stroke-width",2).attr("fill","none")}})}}}),smart_parking.directive("sunburstChart",function(){return{restrict:"E",scope:{data:"="},link:function(a,b,c){a.$watch("data",function(a){function b(a){p.transition().attr("opacity",0),o.transition().duration(750).attrTween("d",c(a)).each("end",function(b,c){if(b.x>=a.x&&b.x<a.x+a.dx){var e=d3.select(this.parentNode).select("text");e.transition().duration(750).attr("opacity",1).attr("transform",function(){return"rotate("+d(b)+")"}).attr("x",function(a){return i(a.y)})}})}function c(a){var b=d3.interpolate(h.domain(),[a.x,a.x+a.dx]),c=d3.interpolate(i.domain(),[a.y,1]),d=d3.interpolate(i.range(),[a.y?20:0,g]);return function(a,e){return e?function(b){return m(a)}:function(e){return h.domain(b(e)),i.domain(c(e)).range(d(e)),m(a)}}}function d(a){return(h(a.x+a.dx/2)-Math.PI/2)/Math.PI*180}if(a)var e=960,f=700,g=Math.min(e,f)/2,h=d3.scale.linear().range([0,2*Math.PI]),i=d3.scale.linear().range([0,g]),j=d3.scale.category20c(),k=d3.select("#sunburstchart").append("svg").attr("width",e).attr("height",f).append("g").attr("transform","translate("+e/2+","+(f/2+10)+")"),l=d3.layout.partition().value(function(a){return a.size}),m=d3.svg.arc().startAngle(function(a){return Math.max(0,Math.min(2*Math.PI,h(a.x)))}).endAngle(function(a){return Math.max(0,Math.min(2*Math.PI,h(a.x+a.dx)))}).innerRadius(function(a){return Math.max(0,i(a.y))}).outerRadius(function(a){return Math.max(0,i(a.y+a.dy))}),n=k.selectAll("g").data(l.nodes(a)).enter().append("g"),o=n.append("path").attr("d",m).style("fill",function(a){return j((a.children?a:a.parent).name)}).on("click",b),p=n.append("text").attr("transform",function(a){return"rotate("+d(a)+")"}).attr("x",function(a){return i(a.y)}).attr("dx","6").attr("dy",".35em").text(function(a){return"C-"+a.size+", Y-"+a.name})})}}}),smart_parking.factory("branchFactory",["$resource","Config","$window",function(a,b,c){var d={},e=b.getBranchesAPI(),f=c.localStorage.getItem("authCode");return d.fetchAllBranchList=function(){return a(e+"/branch",{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d.createBranch=function(){return a(e+"/branch",{},{add:{method:"POST",headers:{Authorization:f,"Content-Type":"application/json"},isArray:!1,interceptor:{response:function(a){return a}}}})},d.updateBranch=function(b){return a(e+"/branch/"+b+"/update",{},{edit:{method:"PUT",headers:{Authorization:f,"Content-Type":"application/json"},isArray:!1,interceptor:{response:function(a){return a}}}})},d}]),smart_parking.controller("branchController",["$scope","branchFactory","$state","$modal",function(a,b,c,d){var e={orgName:"",address:"",pincode:"",branchId:"",branchName:"",email:"",branchManagerName:"",masterEmailId:"",masterEmailPassword:""};a.fetchBranchList=function(){a.response_msg="",b.fetchAllBranchList().fetch({},function(b){if(a.branch_list=[],200==b.status&&void 0!=b.data.branches){var c=angular.fromJson(b.data.branches);a.branch_list=c,a.$parent.setBaseContentHeight(a.branch_list.length)}},function(b){a.branch_list=[],a.$parent.setBaseContentHeight(-1),console.log(b.status)})},a.addBranch=function(){a.response_msg="",a.response_msg1="",a.add=angular.copy(e)},a.createBranch=function(){var d=a.add,e=' { "branchName":"'+d.branchName+'","address" :"'+d.address+'","masterEmailId" :"'+d.masterEmailId+'","masterEmailPassword" :"'+d.masterEmailPassword+'","emails":[{"email" :"'+d.email+'","type" :"'+d.type+'"}],"phoneNumbers":[{"phoneNumber" :"'+d.phoneNumber+'","type" :"'+d.type+'"}],"pincode" :"'+d.pincode+'"}',f=b.createBranch();f.add({},e,function(b){200!=b.status&&201!=b.status||a.fetchBranchList(),c.go("^.list"),a.response_msg="Branch added successfully !!!"},function(b){409==b.status?a.response_msg1=b.data.errorMessage:404==b.status?a.response_msg1=b.data.errorMessage:a.response_msg1="Addition of branch is unsuccessful !!!"})},a.editBranch=function(b){console.log("branch ID:  "+b),a.response_msg="",a.edit=angular.copy(e),angular.forEach(a.branch_list,function(c){console.log("subject: "+c.branchId),b==c.branchId&&(a.edit.branchId=c.branchId,a.edit.branchName=c.branchName,a.edit.address=c.address,a.edit.masterEmailId=c.masterEmailId,a.edit.masterEmailPassword=c.masterEmailPassword,a.edit.email=c.Emails[0].email,a.edit.phoneNumber=c.PhoneNumbers[0].phoneNumber,a.edit.pincode=c.pincode)})},a.updateBranch=function(d){var e=a.edit,f=' { "branchName":"'+e.branchName+'","address" :"'+e.address+'","masterEmailId" :"'+e.masterEmailId+'","masterEmailPassword" :"'+e.masterEmailPassword+'","emails":[{"email" :"'+e.email+'","type" :"'+e.type+'"}],"phoneNumbers":[{"phoneNumber" :"'+e.phoneNumber+'","type" :"'+e.type+'"}],"pincode" :"'+e.pincode+'"}',g=btoa(d),h=b.updateBranch(g);h.edit({},f,function(b){200!=b.status&&201!=b.status||(a.fetchBranchList(),c.go("^.list")),a.response_msg="Branch updated successfully !!!"},function(b){409==b.status?a.response_msg1=b.data.errorMessage:404==b.status?a.response_msg1=b.data.errorMessage:a.response_msg1="Updation of Branch is unsuccessful !!!"})},a.init=function(){a.fetchBranchList()},a.init(),a.cancel=function(){a.response_msg="",a.response_msg1="",c.go("^.list")}}]),smart_parking.factory("branchManagerFactory",["$resource","Config","$window",function(a,b,c){var d={},e=b.getBranchManagersAPI(),f=c.localStorage.getItem("authCode");return d.fetchBranchManagerList=function(){return a(e+"/branchmanagers",{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d.validateUsername=function(b){return a(e+"/userName/"+b,{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d.createManager=function(b){return a(e+"/branch/"+b+"/branchmanager",{},{add:{method:"POST",headers:{Authorization:f,"Content-Type":"application/json"},isArray:!1,interceptor:{response:function(a){return a}}}})},d}]),smart_parking.controller("managerCtrl",["$scope","branchManagerFactory","branchFactory","$state","$modal",function(a,b,c,d,e){var f={userName:"",password:"",firstName:"",lastName:"",phoneNumber:"",email:""};a.fetchBranchList=function(){c.fetchAllBranchList().fetch({},function(b){if(a.branch_list=[],200==b.status&&void 0!=b.data.branches){var c=angular.fromJson(b.data.branches);a.branch_list=c,a.branch_list.length>0}},function(b){a.branch_list=[],console.log(b.status)})},a.fetchBranchManagerList=function(){a.response_msg="",b.fetchBranchManagerList().fetch({},function(b){if(a.bm_list=[],console.log(b),200==b.status&&void 0!=b.data.branchManagers){var c=angular.fromJson(b.data.branchManagers);a.bm_list=c,a.$parent.setBaseContentHeight(a.bm_list.length)}},function(b){a.bm_list=[],a.$parent.setBaseContentHeight(-1),console.log(b.status)})},a.validateUsername=function(c){var d=window.btoa(c);b.validateUsername(d).fetch({},function(b){200!=b.status&&201!=b.status||(a.availability="Available !!")},function(b){a.availability=b.data.errorMessage})},a.addManager=function(){a.response_msg="",a.response_msg1="",a.add=angular.copy(f)},a.createManager=function(){var c=a.add,e=' { "userName":"'+c.userName+'","password" :"'+c.password+'","firstName":"'+c.firstName+'","lastName" :"'+c.lastName+'","emails":[{"email" :"'+c.email+'","type" :"'+c.type+'"}],"phoneNumbers":[{"phoneNumber" :"'+c.phoneNumber+'","type" :"'+c.type+'"}]}',f=window.btoa(c.branch.branchId),g=b.createManager(f);g.add({},e,function(b){200!=b.status&&201!=b.status||a.fetchBranchManagerList(),d.go("^.list"),a.response_msg="Manager added successfully !!!"},function(b){a.response_msg1=b.data.errorMessage})},a.init=function(){},a.init(),a.cancel=function(){a.response_msg="",a.response_msg1="",d.go("^.list")}}]),smart_parking.factory("branchOperatorFactory",["$resource","Config","$window",function(a,b,c){var d={},e=b.getBranchOperatorsAPI(),f=(b.getBranchesAPI(),c.localStorage.getItem("authCode"));return d.fetchOperatorManagerList=function(b){return a(e+"/branch/"+b+"/branchoperator",{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d.validateUsername=function(b){return a(e+"/userName/"+b,{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d.createOperator=function(b){return a(e+"/branch/"+b+"/branchoperator",{},{add:{method:"POST",headers:{Authorization:f,"Content-Type":"application/json"},isArray:!1,interceptor:{response:function(a){return a}}}})},d}]),smart_parking.controller("operatorCtrl",["$scope","branchOperatorFactory","branchFactory","$state","$modal",function(a,b,c,d,e){var f={userName:"",password:"",firstName:"",lastName:"",phoneNumber:"",email:""};a.fetchBranchList=function(){c.fetchAllBranchList().fetch({},function(b){if(a.branch_list=[],200==b.status&&void 0!=b.data.branches){var c=angular.fromJson(b.data.branches);a.branch_list=c,a.branch_list.length>0}},function(b){a.branch_list=[],console.log(b.status)})},a.fetchOperatorManagerList=function(c){a.response_msg="";var d=window.btoa(c.branchId);b.fetchOperatorManagerList(d).fetch({},function(b){if(a.bo_list=[],200==b.status&&void 0!=b.data.branchOperators){var c=angular.fromJson(b.data.branchOperators);a.bo_list=c,a.$parent.setBaseContentHeight(a.bo_list.length)}},function(b){a.bo_list=[],a.$parent.setBaseContentHeight(-1),console.log(b.status)})},a.validateUsername=function(c){var d=window.btoa(c);b.validateUsername(d).fetch({},function(b){200!=b.status&&201!=b.status||(a.availability="Available !!")},function(b){a.availability=b.data.errorMessage})},a.addOperator=function(){a.response_msg="",a.response_msg1="",a.add=angular.copy(f)},a.createOperator=function(){var c=a.add,e=' { "userName":"'+c.userName+'","password" :"'+c.password+'","firstName":"'+c.firstName+'","lastName" :"'+c.lastName+'","emails":[{"email" :"'+c.email+'","type" :"'+c.type+'"}],"phoneNumbers":[{"phoneNumber" :"'+c.phoneNumber+'","type" :"'+c.type+'"}]}',f=window.btoa(c.branch.branchId),g=b.createOperator(f);g.add({},e,function(b){200!=b.status&&201!=b.status||a.fetchBranchList(),d.go("^.list"),a.response_msg="Operator added successfully !!!"},function(b){409==b.status||404==b.status?a.response_msg1=b.data:a.response_msg1="Addition of Operator is unsuccessful !!!"})},a.init=function(){},a.cancel=function(){a.response_msg="",a.response_msg1="",d.go("^.list")},a.init()}]),smart_parking.factory("feeFactory",["$resource","Config","$window",function(a,b,c){var d={},e=b.getFeeAPI(),f=c.localStorage.getItem("authCode");return d.createFees=function(b){return a(e+b+"/fees",{},{add:{method:"POST",headers:{Authorization:f,"Content-Type":"application/json"},isArray:!1,interceptor:{response:function(a){return a}}}})},d.fetchFeeList=function(b,c,d){return console.log("auth "+f),a(e+b+"/fees/basic/syllabus/"+d+"/year/"+c,{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d}]),smart_parking.controller("feeController",["$scope","feeFactory","branchFactory","$state","$modal",function(a,b,c,d,e){var f={standard:"",admissionFees:"",monthlyFees:"",sportsFees:"",booksFees:"",vanFees:"",year:"",feesId:""};a.fetchYearList=function(){a.year_list=["2015-16","2016-17","2017-18","2018-19"],a.fee_list=[],a.syllabus_list=[]},a.fetchStandardList=function(b){a.standards=["First","Second","Third","Fourth","Fifth","Sixth","Seventh","Eighth","Ninth","Tenth"],a.fee_list=[],a.syllabus_list=[]},a.fetchSyllabusList=function(b){a.syllabus_list=["CBSE","ICSE","State Syllabus"],a.fee_list=[]},a.fetchBranchList=function(){c.fetchAllBranchList().fetch({},function(b){if(a.branch_list=[],200==b.status&&void 0!=b.data.branches){var c=angular.fromJson(b.data.branches);a.branch_list=c,a.branch_list.length>0}},function(b){a.branch_list=[],console.log(b.status)})},a.fetchFeeList=function(c,d,e){a.response_msg="",console.log(c.branchId+" "+d);var f=window.btoa(c.branchId),g=window.btoa(d),e=window.btoa(e);b.fetchFeeList(f,g,e).fetch({},function(b){if(a.fee_list=[],console.log(b),(200==b.status||201==b.statu)&&void 0!=b.data.fees){var c=angular.fromJson(b.data.fees);a.fee_list=c,a.$parent.setBaseContentHeight(a.fee_list.length)}},function(b){a.fee_list=[],a.$parent.setBaseContentHeight(-1),console.log(b.status)})},a.addFees=function(){a.response_msg="",a.response_msg1="",a.add=angular.copy(f)},a.createFees=function(c){var e=a.add,f=' { "standard":"'+e.standard+'","syllabus":"'+e.syllabus+'","admissionFees" :"'+e.admissionFees+'","monthlyFees" :"'+e.monthlyFees+'","sportsFees" :"'+e.sportsFees+'","booksFees" :"'+e.booksFees+'","vanFees" :"'+e.vanFees+'","year" :"'+e.year+'"}',g=window.btoa(c.branchId),h=b.createFees(g);h.add({},f,function(b){200==b.status&&(a.fetchBranchList(),d.go("^.list")),a.response_msg="Fee added successfully !!!"},function(b){409==b.status?a.response_msg1=b.data.errorMessage:a.response_msg1="Addition of Fee is unsuccessful !!!"})},a.init=function(){},a.cancel=function(){a.response_msg="",a.response_msg1="",d.go("^.list")},a.init()}]);