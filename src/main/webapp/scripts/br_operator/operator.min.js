function error(a){console.log(a.status)}function show_dialoge(a,b,c,d,e){return a.open({scope:b,templateUrl:d,controller:"dialogeCtrl",resolve:{data:function(){return void 0==c||null==c||""==c?{message:null,title:e}:void 0==e||null==e||""==e?{message:c,title:null}:void 0!=c&&null!=c&&""!=c||void 0!=e&&null!=e&&""!=e?{message:c,title:e}:null}}})}function open_dialoge(a,b,c,d,e){return b.open({scope:c,size:a,templateUrl:e,controller:"dialogeCtrl",resolve:{data:function(){return d}}})}function error(a,b){404==b.status&&console.log(a+b.status)}function goToHome(){$(".sidebar-menu #space a").trigger("click")}var branchOperator_login=angular.module("branchOperator_login",["blockUI","config_app","ngRoute","ngResource"]);branchOperator_login.config(["$locationProvider","blockUIConfig",function(a,b){a.html5Mode({enabled:!0,requireBase:!0}),b.message="Logging In ..."}]),branchOperator_login.factory("br_operator_loginFactory",["$resource","br_Operator_Config",function(a,b){var c={},d=b.getLoginApi();return c.getLogin=function(b){return a(d+"/"+b+"/branchOperatorLogin",{},{login:{method:"POST",headers:{"Content-Type":"application/json"},interceptor:{response:function(a){return a}}}})},c}]),branchOperator_login.controller("bo_loginCtrl",["$scope","br_operator_loginFactory","$window",function(a,b,c){a.username="",a.password="",a.login=function(){var d='{"userName":"'+a.username+'","password":"'+a.password+'"}';b.getLogin(a.login_as).login({},d,function(a){if(200==a.status){var b=a.data;c.sessionStorage.setItem("orgId",b.orgId),c.sessionStorage.setItem("userId",b.userId),c.sessionStorage.setItem("branchId",b.branchId),c.localStorage.setItem("authCode",b.authCode),c.localStorage.setItem("operatorName",b.operatorName),console.log(a),c.location="br_operator_main.html"}},function(b){console.log(b),0==b.status?c.location="system_error.html":a.$parent.$parent.response_message=b.data})},a.clearErrorMsg=function(){a.$parent.$parent.response_message=""}}]);var branchOperator=angular.module("branchOperator",["blockUI","slimScrollDirective","highcharts-ng","angularUtils.directives.dirPagination","config_app","ui.bootstrap","branchOperator_login","checklist-model","ui.router"]);branchOperator.factory("branchOperatorFactory",["$resource","br_Operator_Config","$window",function(a,b,c){var d={},e=b.getBaseUrl(),f=c.localStorage.getItem("authCode");return d.fetchBranchInfo=function(){return a(e,{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d}]),branchOperator.run([function(){$(function(){$(document).keydown(function(a){return 116==(a.which||a.keyCode)||82==a.keyCode&&a.ctrlKey?void a.preventDefault():116!=(a.which||a.keyCode)})})}]),branchOperator.controller("br_op_mainCtrl",["$scope","$location","br_Operator_Config","$window",function(a,b,c,d){function e(){b.path("/dash")}var f=c.setConfig();f?e():(d.location="index.html",a.$parent.response_message="Please try after some time")}]),branchOperator.controller("br_op_companyCtrl",["$scope","branchOperatorFactory","$state","$window","$timeout",function(a,b,c,d,e){b.fetchBranchInfo().fetch({},function(b){var e=d.localStorage.getItem("operatorName");if(a.todaydate=new Date,200==b.status){var f=angular.fromJson(b.data),g={orgName:f.orgName,address:f.address,branchName:f.branchName,pincode:f.pincode,branchId:f.branchId,userName:e};a.$parent.logo_image="images/loading5.jpg",a.$parent.orgName=g.orgName,a.$parent.branchId=g.branchId,a.$parent.branchName=g.branchName,a.$parent.address=g.address,a.$parent.pincode=g.pincode,a.$parent.userName=g.userName,c.go("dash")}},error);a.setBaseContentHeight=function(a,b,c,d){b>d?($("#"+a).slimScroll({height:c,alwaysVisible:!1,size:"3px"}).css("width","100%"),$(".table-base .slimScrollDiv").css("min-width","660px")):$("#"+a).slimScroll({destroy:!0})},c.go("dash")}]),branchOperator.config(["$stateProvider","$urlRouterProvider","$routeProvider","$locationProvider","blockUIConfig",function(a,b,c,d,e){b.otherwise("/#"),a.state("dash",{url:"/dash",templateUrl:"views/br_operator/br_op_dashboard.html",controller:"dashboardController"}).state("pass",{url:"/pass",templateUrl:"views/br_operator/br_op_changePassword.html",controller:"operatorPasswordCtrl"}).state("vehicle",{"abstract":!0,url:"/vehicle",template:'<div ui-view style="height:100%"></div>',controller:"op_vehicleManagementCtrl"}).state("vehicle.list",{url:"",templateUrl:"views/br_operator/br_op_vehicleManagement.html"}).state("vehicle.add",{url:"",templateUrl:"views/br_operator/br_op_addVehicle.html"}).state("vehicle.edit",{url:"",templateUrl:"views/br_operator/br_op_editVehicle.html"}).state("inventory",{"abstract":!0,url:"/inventory",template:'<div ui-view style="height:100%"></div>',controller:"op_inventoryManagementCtrl"}).state("inventory.list",{url:"",templateUrl:"views/br_operator/br_op_inventoryManagemnt.html"}).state("inventory.edit",{url:"",templateUrl:"views/br_operator/br_op_editInventory.html"}).state("inventory.add",{url:"",templateUrl:"views/br_operator/br_op_addInventory.html"}).state("library",{"abstract":!0,url:"/library",template:'<div ui-view style ="height:100%"></div>',controller:"libraryManagementController"}).state("library.assign",{url:"",templateUrl:"views/br_operator/br_op_libraryBookAssign.html"}).state("library.list",{url:"",templateUrl:"views/br_operator/br_op_libraryManagement.html"}).state("library.add",{url:"",templateUrl:"views/br_operator/br_op_addLibraryBook.html"}).state("library.edit",{url:"",templateUrl:"views/br_operator/br_op_editLibraryBook.html"}).state("library.ret",{url:"",templateUrl:"views/br_operator/br_op_libraryBookUnissue.html"}).state("library.search",{url:"",templateUrl:"views/br_operator/br_op_libraryManagement.html"}),d.html5Mode(!0),e.message="Processing ..."}]),branchOperator.controller("operatorPasswordCtrl",["$scope","branchOperatorFactory","$state","$timeout","$window",function(a,b,c,d,e){var f={username:"",oldPassword:"",newPassword:"",confirmPassword:""};a.oPasswordChange=function(){a.response_msg="",a.response_msg1="",a.add=angular.copy(f),console.log(a.userName)},a.changeOperatorPassword=function(){var c=e.sessionStorage.getItem("userId");console.log("udi "+c);var d=a.add,f=' { "username":"'+d.username+'","oldPassword" :"'+d.oldPassword+'","newPassword" :"'+d.newPassword+'","confirmPassword" :"'+d.confirmPassword+'"}',g=window.btoa(c),h=b.changeOperatorPassword(g);h.pass({},f,function(a){200==a.status&&(alert("Password Changed successfully!!!"),e.location="index.html")},function(b){409==b.status?a.response_msg1=b.data.errorMessage:a.response_msg1="Password change is unsuccessful !!!"})},a.cancel=function(){a.response_msg="",a.response_msg1="",c.go("dash")}}]),branchOperator.controller("logoutCtrl",["$scope","$window",function(a,b){a.logout=function(){b.sessionStorage.removeItem("psId"),b.sessionStorage.removeItem("pcId"),b.sessionStorage.removeItem("userId"),b.location="index.html"}}]),branchOperator.controller("dialogeCtrl",["$scope","$modalInstance","data",function(a,b,c){null==c.title?a.message=c.message:null==c.message?a.title=c.title:(a.message=c.message,a.title=c.title),a.ok=function(){b.close(!0)},a.cancel=function(){b.dismiss("cancel")},a.close=function(){b.close(!1)}}]),branchOperator.factory("dashFactory",["$resource","br_Operator_Config","$window",function(a,b,c){var d={},e=b.getAssetAPI(),f=c.localStorage.getItem("authCode");return d.fetchAssetList=function(){return a(e,{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d}]),branchOperator.controller("dashboardController",["$scope","dashFactory",function(a,b){a.fetchAssetList=function(){a.response_msg="",b.fetchAssetList().fetch({},function(b){if(a.asset_info=[],console.log(b),200==b.status&&void 0!=b.data){var c=angular.fromJson(b.data);a.asset_info=c,console.log(b)}},function(b){a.asset_info=[],console.log(b.status)})},a.init=function(){a.fetchAssetList()},a.init()}]),branchOperator.factory("inventoryFactory",["$resource","br_Operator_Config","$window",function(a,b,c){var d={},e=b.getMainAPI(),f=c.localStorage.getItem("authCode");return d.fetchInventoryList=function(b,c){return a(e+"/inventory?offset="+b+"&limit="+c,{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d.createInventoryEntry=function(){return a(e+"/inventory",{},{add:{method:"POST",headers:{Authorization:f,"Content-Type":"application/json"},isArray:!1,interceptor:{response:function(a){return a}}}})},d.updateInventory=function(b){return console.log("id: "+b),a(e+"/inventory/"+b+"/update",{},{edit:{method:"PUT",headers:{Authorization:f,"Content-Type":"application/json"},isArray:!1,interceptor:{response:function(a){return console.log("updated !!"),a}}}})},d.deleteInventory=function(b){return a(e+"/inventory/"+b+"/dectivate",{},{remove:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d}]),branchOperator.controller("op_inventoryManagementCtrl",["$scope","inventoryFactory","$state","$filter","$modal",function(a,b,c,d,e){var f={inventoryType:"",approximateCost:"",category:"",serialNumber:"",inventoryId:"",yearOfManufacturer:"",dateOfPurchase:""};a.inventoryDetails={inventoryList:[],numPerPage:25,currentPage:1,startValue:0},a.fetchInventoryList=function(c,d){a.response_msg1="",b.fetchInventoryList(c,d).fetch({},function(b){if(a.year_list=["2015-16","2016-17","2017-18","2018-19"],a.inventory_list=[],console.log(b),200==b.status&&(a.count=b.data.total,console.log(a.count),void 0!=b.data.inventoryLists)){var c=angular.fromJson(b.data.inventoryLists);console.log(c),a.inventory_list=c,a.totalPages=Math.ceil(a.count/a.inventoryDetails.numPerPage),a.$parent.setBaseContentHeight(a.inventory_list.length)}},function(b){a.inventory_list=[],a.$parent.setBaseContentHeight(-1),console.log(b.status)})},a.$on("$viewContentLoaded",function(){"inventory"==c.current.name&&void 0!=a.inventory_list&&a.$parent.setBaseContentHeight(a.inventory_list.length)}),a.addInventoryEntry=function(){a.response_msg="",a.response_msg1="",a.add=angular.copy(f)},a.category=["Electronic","Sports","Furniture","General"],a.createInventoryEntry=function(){var e=a.add;a.add.dateOfPurchase.Value=d("date")(new Date(e.dateOfPurchase),"yyyy-MM-dd");var f=' { "inventoryType":"'+e.inventoryType+'","yearOfManufacturer":"'+e.yearOfManufacturer+'","dateOfPurchase" :"'+a.add.dateOfPurchase.Value+'","approximateCost" :"'+e.approximateCost+'","serialNumber" :"'+e.serialNumber+'","category" :"'+e.category+'"}',g=b.createInventoryEntry();g.add({},f,function(b){200!=b.status&&201!=b.status||a.fetchInventoryList(0,a.inventoryDetails.numPerPage),c.go("^.list"),a.response_msg="Inventory added successfully !!!"},function(b){409==b.status?(a.add.inventoryType="",a.response_msg1=b.data.errorMessage):a.response_msg1="Addition of Inventory is unsuccessful !!!"})},a.editInventoryEntry=function(b){console.log("inventoryId "+b),a.response_msg="",a.edit=angular.copy(f),angular.forEach(a.inventory_list,function(c){console.log("inventory: "+c.inventoryId),b==c.inventoryId&&(a.edit.inventoryId=c.inventoryId,a.edit.inventoryType=c.inventoryType,a.edit.dateOfPurchase=new Date(c.dateOfPurchase),a.edit.approximateCost=c.approximateCost,a.edit.yearOfManufacturer=c.yearOfManufacturer,a.edit.serialNumber=c.serialNumber,a.edit.category=c.category)})},a.updateInventory=function(e){var f=a.edit;a.edit.dateOfPurchase.Value=d("date")(new Date(f.dateOfPurchase),"yyyy-MM-dd");var g=' { "yearOfManufacturer":"'+f.yearOfManufacturer+'","inventoryType":"'+f.inventoryType+'","approximateCost" :"'+f.approximateCost+'","dateOfPurchase" :"'+a.edit.dateOfPurchase.Value+'","serialNumber" :"'+f.serialNumber+'","category" :"'+f.category+'"}',h=window.btoa(e),i=b.updateInventory(h);i.edit({},g,function(b){200==b.status&&(console.log("response"+b.status),a.fetchInventoryList(0,a.inventoryDetails.numPerPage)),c.go("^.list"),a.response_msg="Inventory updated successfully !!!"},function(b){409==b.status?a.response_msg1=b.data.errorMessage:a.response_msg1="Updation of Inventory is unsuccessful !!!"})},a.deleteInventory=function(c,d){a.response_msg="",a.response_msg1="";var c=window.btoa(c.inventoryId);console.log("inside delete function !!");var f="Are you sure to delete the Inventary ??",g=show_dialoge(e,a,f,"dialoge_content.html");g.result.then(function(d){console.log("Flag value: "+d),d?(console.log(c.inventoryId),b.deleteInventory(c).remove({},function(b){200==b.status&&(a.fetchInventoryList(0,a.inventoryDetails.numPerPage),console.log("deleted"))},function(b){a.response_msg1="inventory Deletion failed !!!",console.log(b.status)})):console.log("Failed to delete")})},a.init=function(){a.inventoryDetails.numPerPage=parseInt(a.inventoryDetails.numPerPage),a.maxSize=5,a.fetchInventoryList(0,a.inventoryDetails.numPerPage)},a.cancel=function(){a.response_msg="",a.response_msg1="",c.go("^.list")},a.init(),a.pageChanged=function(){a.inventoryDetails.startValue=(a.inventoryDetails.currentPage-1)*a.inventoryDetails.numPerPage,a.fetchInventoryList(a.inventoryDetails.startValue,a.inventoryDetails.numPerPage)}}]),branchOperator.factory("vehicleFactory",["$resource","br_Operator_Config","$window",function(a,b,c){var d={},e=b.getMainAPI(),f=c.localStorage.getItem("authCode");return d.fetchVehicleList=function(b,c){return a(e+"/vehicle?offset="+b+"&limit="+c,{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d.createVehicleEntry=function(){return a(e+"/vehicle",{},{add:{method:"POST",headers:{Authorization:f,"Content-Type":"application/json"},isArray:!1,interceptor:{response:function(a){return a}}}})},d.editVehicleEntry=function(b){return a(e+"/vehicle/"+b+"/update",{},{edit:{method:"PUT",headers:{Authorization:f,"Content-Type":"application/json"},isArray:!1,interceptor:{response:function(a){return a}}}})},d.deleteVehicle=function(b){return a(e+"/vehicle/"+b+"/deactivate",{},{remove:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d}]),branchOperator.controller("op_vehicleManagementCtrl",["$scope","vehicleFactory","$state","$filter","$modal",function(a,b,c,d,e){var f={vehicleId:"",vehicleType:"",vehicleRegNo:"",vehicleModel:"",yearOfManufacter:"",insuranceRenewal:"",nextRenewalDate:"",seatCapacity:"",routeName:""};a.vehicleDetails={vehicleList:[],numPerPage:25,currentPage:1,startValue:0},a.fetchVehicleList=function(c,d){a.response_msg1="",b.fetchVehicleList(c,d).fetch({},function(b){if(a.vehicle_list=[],console.log(b),200==b.status&&(a.count=b.data.total,void 0!=b.data.vehicles)){var c=angular.fromJson(b.data.vehicles);a.vehicle_list=c,a.totalPages=Math.ceil(a.count/a.vehicleDetails.numPerPage),a.$parent.setBaseContentHeight(a.vehicle_list.length)}},function(b){a.vehicle_list=[],a.$parent.setBaseContentHeight(-1),console.log(b.status)})},a.$on("$viewContentLoaded",function(){"vehicle"==c.current.name&&void 0!=a.vehicle_list&&a.$parent.setBaseContentHeight(a.vehicle_list.length)}),a.addVehicle=function(){a.response_msg="",a.response_msg1="",a.add=angular.copy(f)},a.createVehicleEntry=function(){var e=a.add;a.add.insuranceRenewal.Value=d("date")(new Date(e.insuranceRenewal),"yyyy-MM-dd"),a.add.nextRenewalDate.Value=d("date")(new Date(e.nextRenewalDate),"yyyy-MM-dd");var f=' { "vehicleType":"'+e.vehicleType+'","vehicleRegNo" :"'+e.vehicleRegNo+'","vehicleModel" :"'+e.vehicleModel+'","seatCapacity" :"'+e.seatCapacity+'","driverName" :"'+e.driverName+'","routeName" :"'+e.routeName+'","phoneNumbers":{"phoneNumber" :"'+e.phoneNumber+'","type" :"'+e.type+'"},"yearOfManufacter" :"'+e.yearOfManufacter+'","insuranceRenewal" :"'+a.add.insuranceRenewal.Value+'","nextRenewalDate" :"'+a.add.nextRenewalDate.Value+'"}',g=b.createVehicleEntry();g.add({},f,function(b){200!=b.status&&201!=b.status||c.go("^.list"),a.response_msg="Vehicle added successfully !!!"},function(b){409==b.status?(a.add.vehicle="",a.response_msg1=b.data.errorMessage):a.response_msg1="Addition of Vehicle is unsuccessful !!!"})},a.editVehicle=function(b){console.log("vehicleId "+b),a.response_msg="",a.edit=angular.copy(f),angular.forEach(a.vehicle_list,function(c){console.log("vehicle: "+c.vehicleId),b==c.vehicleId&&(a.edit.vehicleId=c.vehicleId,a.edit.vehicleType=c.vehicleType,a.edit.vehicleRegNo=c.vehicleRegNo,a.edit.seatCapacity=c.seatCapacity,a.edit.driverName=c.driverName,a.edit.routeName=c.routeName,a.edit.phoneNumber=c.phoneNumbers.phoneNumber,a.edit.vehicleModel=c.vehicleModel,a.edit.yearOfManufacter=c.yearOfManufacter,a.edit.insuranceRenewal=new Date(c.insuranceRenewal),a.edit.nextRenewalDate=new Date(c.nextRenewalDate))})},a.editVehicleEntry=function(e){var f=a.edit;a.edit.insuranceRenewal.Value=d("date")(new Date(f.insuranceRenewal),"yyyy-MM-dd"),a.edit.nextRenewalDate.Value=d("date")(new Date(f.nextRenewalDate),"yyyy-MM-dd");var g=' { "vehicleType":"'+f.vehicleType+'","vehicleRegNo" :"'+f.vehicleRegNo+'","vehicleModel" :"'+f.vehicleModel+'","seatCapacity" :"'+f.seatCapacity+'","driverName" :"'+f.driverName+'","routeName" :"'+f.routeName+'","phoneNumbers":{"phoneNumber" :"'+f.phoneNumber+'","type" :"'+f.type+'"},"yearOfManufacter" :"'+f.yearOfManufacter+'","insuranceRenewal" :"'+a.edit.insuranceRenewal.Value+'","nextRenewalDate" :"'+a.edit.nextRenewalDate.Value+'"}',h=window.btoa(e),i=b.editVehicleEntry(h);i.edit({},g,function(b){200==b.status&&c.go("^.list"),a.response_msg="Vehicle Details Updated successfully !!!"},function(b){409==b.status?(a.edit.vehicle="",a.response_msg1=b.data.errorMessage):a.response_msg1="Updation of Vehicle details is unsuccessful !!!"})},a.deleteVehicle=function(c,d){a.response_msg="",a.response_msg1="";var c=window.btoa(c.vehicleId);console.log("inside delete function !!");var f="Are you sure to delete the Vehicle ??",g=show_dialoge(e,a,f,"dialoge_content.html");g.result.then(function(d){console.log("Flag value:"+d),d?(console.log(c.vehicleId),b.deleteVehicle(c).remove({},function(b){200==b.status&&(a.fetchVehicleList(0,a.vehicleDetails.numPerPage),console.log("deleted")),a.response_msg="Vehicle deleted successfully !!!"},function(b){a.response_msg1="vehicle Deletion failed !!!",console.log(b.status)})):console.log("Failed to delete")})},a.init=function(){a.vehicleDetails.numPerPage=parseInt(a.vehicleDetails.numPerPage),a.maxSize=5,a.fetchVehicleList(0,a.vehicleDetails.numPerPage)},a.cancel=function(){a.response_msg="",a.response_msg1="",c.go("^.list")},a.init(),a.pageChanged=function(){a.vehicleDetails.startValue=(a.vehicleDetails.currentPage-1)*a.vehicleDetails.numPerPage,a.fetchVehicleList(a.vehicleDetails.startValue,a.vehicleDetails.numPerPage)}}]),branchOperator.factory("libraryFactory",["$resource","br_Operator_Config","$window",function(a,b,c){var d={},e=b.getMainAPI(),f=c.localStorage.getItem("authCode");return d.fetchStandardList=function(b){return a(e+"/classroom/year/"+b,{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d.fetchClassRoomlist=function(b,c){return a(e+"/classroom/standard/"+c+"/section/year/"+b,{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d.fetchStudentList=function(b,c,d){return a(e+"/student/year/"+b+"/std/"+c+"/sec/"+d+"/basicinfo",{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d.fetchFacultyList=function(b,c){return a(e+"/faculty?offset="+b+"&limit="+c,{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d.fetchDefaulterList=function(b,c){return a(e+"/library/defaulters?offset="+b+"&limit="+c,{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d.fetchLibraryReport=function(){return a(e+"/library/reports",{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d.fetchLibraryList=function(b,c){return a(e+"/library/UnAssignedBooks?skip="+b+"&limit="+c,{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d.searchBooks=function(b,c,d,g){var h,i="Author",j="Publication",k="Book Name";return angular.equals(b,i)?h=e+"/library/author/"+c+"?skip="+d+"&limit="+g:angular.equals(b,j)?h=e+"/library/publication/"+c+"?skip="+d+"&limit="+g:angular.equals(b,k)&&(h=e+"/library/book/"+c),a(h,{},{fetch:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d.createLibraryBookEntry=function(b){return a(e+"/library/book/"+b,{},{add:{method:"POST",headers:{Authorization:f,"Content-Type":"application/json"},isArray:!1,interceptor:{response:function(a){return console.log("post successful !!"),a}}}})},d.assignTo=function(){return a(e+"/library/issuedTo",{},{assign:{method:"POST",headers:{Authorization:f,"Content-Type":"application/json"},isArray:!1,interceptor:{response:function(a){return console.log("post successful !!"),a}}}})},d.unissueBook=function(){return a(e+"/library/unissue",{},{ret:{method:"POST",headers:{Authorization:f,"Content-Type":"application/json"},isArray:!1,interceptor:{response:function(a){return console.log("post successful !!"),a}}}})},d.editLibraryBook=function(b){return a(e+"/library/"+b+"/update",{},{edit:{method:"PUT",headers:{Authorization:f,"Content-Type":"application/json"},isArray:!1,interceptor:{response:function(a){return a}}}})},d.deleteBook=function(b){return a(e+"/library/bookId/"+b,{},{remove:{method:"get",isArray:!1,headers:{Authorization:f},interceptor:{response:function(a){return a}}}})},d}]),branchOperator.controller("libraryManagementController",["$scope","libraryFactory","$state","$filter","$modal",function(a,b,c,d,e){var f={bookId:"",bookName:"",author:"",publication:"",issuedTo:"",issuedDate:"",returnDate:"",approximateCost:"",bookVersion:""};a.libraryDetails={libraryList:[],numPerPage:25,currentPage:1,startValue:0},a.fetchYearList=function(){a.year_list=["2015-16","2016-17","2017-18","2018-19"],a.standard_list=[],a.section_list=[],a.student_list=[],a.fee_list=[]},a.fetchStandardList=function(c){a.response_msg="";var d=window.btoa(c);b.fetchStandardList(d).fetch({},function(b){if(a.standard_list=[],a.section_list=[],a.student_list=[],a.fee_list=[],(200==b.status||201==b.status)&&void 0!=b.data.standards){var c=angular.fromJson(b.data.standards);a.standard_list=c}},function(b){a.standard_list=[],a.response_msg="No Standards found for this year.",console.log(b.status)})},a.fetchClassRoomlist=function(c,d){var e=window.btoa(c),f=window.btoa(d);b.fetchClassRoomlist(e,f).fetch({},function(b){if(a.section_list=[],a.student_list=[],a.fee_list=[],console.log(b),200==b.status&&void 0!=b.data.classRoomLists){var c=angular.fromJson(b.data.classRoomLists);a.section_list=c}},function(b){a.section_list=[],a.response_msg="No Section found for this standard.",console.log(b.status)})},a.fetchStudentList=function(c,d,e){var f=window.btoa(c),g=window.btoa(d),h=window.btoa(e.section);b.fetchStudentList(f,g,h).fetch({},function(b){if(a.student_list=[],a.fee_list=[],console.log(b),(200==b.status||201==b.status)&&void 0!=b.data.students){var c=angular.fromJson(b.data.students);a.student_list=c}},function(b){a.student_list=[],a.response_msg=" Studentds not found for this section.",console.log(b.status)})},a.search_by_list=["Author","Publication","Book Name"],a.fetchLibraryList=function(c,d){a.response_msg="",b.fetchLibraryList(c,d).fetch({},function(b){if(a.library_list=[],console.log(b),(200==b.status||201==b.status)&&(a.count=b.data.total,void 0!=b.data.libraryDetailsLists)){var c=angular.fromJson(b.data.libraryDetailsLists);a.library_list=c,a.totalPages=Math.ceil(a.count/a.libraryDetails.numPerPage),a.$parent.setBaseContentHeight(a.library_list.length)}},function(b){a.library_list=[],a.$parent.setBaseContentHeight(-1),console.log(b.status)})},a.searchBooks=function(c,d,e,f){console.log(c),console.log(d),a.response_msg="";var g=window.btoa(d);b.searchBooks(c,g,e,f).fetch({},function(b){if(a.library_list=[],console.log(b),(200==b.status||201==b.status)&&(a.count=b.data.total,void 0!=b.data.libraryDetailsLists)){var c=angular.fromJson(b.data.libraryDetailsLists);a.library_list=c,a.totalPages=Math.ceil(a.count/a.libraryDetails.numPerPage),a.$parent.setBaseContentHeight(a.library_list.length)}},function(b){409==b.status||404==b.status?(a.library_list=[],a.$parent.setBaseContentHeight(-1),console.log(b.status),a.response_msg1=b.data.errorMessage):a.response_msg1="No such books are found !!! "})},a.$on("$viewContentLoaded",function(){"library"==c.current.name&&void 0!=a.library_list&&a.$parent.setBaseContentHeight(a.library_list.length)}),a.addLibraryBook=function(){a.response_msg="",a.response_msg1="",a.add=angular.copy(f),console.log("inside addLibraryBook !!")},a.createLibraryBookEntry=function(d){var e=a.add;console.log("inside createLibraryBookEntry !!");var f=' { "publication":"'+e.publication+'","bookName" :"'+e.bookName+'","bookVersion" :"'+e.bookVersion+'","author" :"'+e.author+'","approximateCost" :"'+e.approximateCost+'"}';console.log("read the inputs !!");var g=window.btoa(d),h=b.createLibraryBookEntry(g);h.add({},f,function(b){200!=b.status&&201!=b.status||a.fetchLibraryList(0,a.libraryDetails.numPerPage),c.go("^.list"),a.response_msg="LibraryBookEntry added successfully !!!"},function(b){409==b.status?(a.add.branchName="",a.response_msg1=b.data.errorMessage):a.response_msg1="Addition of LibraryBookEntry is unsuccessful !!!"})},a.editLibrary=function(b){console.log("bookId "+b),a.response_msg="",a.edit=angular.copy(f),angular.forEach(a.library_list,function(c){console.log("vehicle: "+c.bookId),b==c.bookId&&(a.edit.bookId=c.bookId,a.edit.bookName=c.bookName,a.edit.bookVersion=c.bookVersion,a.edit.author=c.author,a.edit.publication=c.publication,a.edit.approximateCost=c.approximateCost)})},a.editLibraryBook=function(d){console.log("book id: "+d);var e=a.edit,f=' { "bookName" :"'+e.bookName+'","bookVersion" :"'+e.bookVersion+'","author" :"'+e.author+'","publication" :"'+e.publication+'","approximateCost" :"'+e.approximateCost+'"}',g=window.btoa(d),h=b.editLibraryBook(g);h.edit({},f,function(b){200!=b.status&&201!=b.status||a.fetchLibraryList(0,a.libraryDetails.numPerPage),c.go("^.list"),a.response_msg="Library Book updated successfully !!!"},function(b){409==b.status?a.response_msg1=b.data.errorMessage:a.response_msg1="Updating Book is unsuccessful !!!"})},a.deleteBook=function(c,d){a.response_msg="",a.response_msg1="";var f=window.btoa(c.bookId);console.log("inside delete function !!");var g="Are you sure to delete the library ??",h=show_dialoge(e,a,g,"dialoge_content.html");h.result.then(function(d){console.log("Flag value: "+d),d?(console.log(c.bookId),b.deleteBook(f).remove({},function(b){200==b.status&&(a.fetchLibraryList(0,a.libraryDetails.numPerPage),console.log("deleted"),a.response_msg="Book deleted Successfully!!!")},function(b){a.response_msg1="Book Deletion is failed !!!",console.log(b.status)})):console.log("Failed to delete")})},a.isVisibleS=!1,a.isVisibleF=!1,a.toStudent=function(b){a.isVisibleS="S"==b,a.isVisibleF=!1},a.toFaculty=function(b){a.isVisibleF="F"==b,a.fetchFacultyList(0,1e3),a.isVisibleS=!1},a.assignBook=function(b){console.log("bookId "+b),a.response_msg="",a.assign=angular.copy(f),angular.forEach(a.library_list,function(c){console.log("book: "+c.bookId),b==c.bookId&&(a.assign.bookId=c.bookId,a.assign.bookName=c.bookName,a.assign.author=c.author,a.assign.publication=c.publication,a.assign.approximateCost=c.approximateCost)})},a.assignTo=function(e){var f=function(b){return 1==a.isVisibleS?b.student.studentId:1==a.isVisibleF?b.faculty.facultyId:void 0};console.log("book id: "+e);var g=a.assign;a.assign.issueDate.Value=d("date")(new Date(g.issueDate),"yyyy-MM-dd"),a.assign.returnByDate.Value=d("date")(new Date(g.returnByDate),"yyyy-MM-dd");var h=' { "bookId" :"'+g.bookId+'","issuedTo" :"'+f(g)+'","returnByDate" :"'+a.assign.returnByDate.Value+'","issueDate" :"'+a.assign.issueDate.Value+'"}',i=window.btoa(e),j=b.assignTo(i);j.assign({},h,function(b){200!=b.status&&201!=b.status||(a.fetchLibraryList(0,a.libraryDetails.numPerPage),a.isVisibleS=!1,a.isVisibleF=!1),c.go("^.list"),a.response_msg="Book assigned successfully !!!"},function(b){409==b.status?a.response_msg1=b.data.errorMessage:a.response_msg1="Assigning of book is unsuccessful !!!"})},a.returnBook=function(b){console.log("bookId "+b),a.response_msg="",a.ret=angular.copy(f),angular.forEach(a.library_list,function(c){console.log("library: "+c.bookId),b==c.bookId&&(a.ret.bookId=c.bookId,a.ret.issuedTo=c.issuedTo)}),console.log("Id Matched with"+a.assign.bookId)},a.unissueBook=function(e){console.log("book id: "+e);var f=a.ret;a.ret.returnDate.Value=d("date")(new Date(f.returnDate),"yyyy-MM-dd");var g=' { "bookId" :"'+f.bookId+'","studentId" :"'+f.issuedTo+'","returnDate" :"'+a.ret.returnDate.Value+'"}',h=window.btoa(e),i=b.unissueBook(h);i.ret({},g,function(b){200!=b.status&&201!=b.status||(a.fetchLibraryList(0,a.libraryDetails.numPerPage),a.isVisibleS=!1,a.isVisibleF=!1),c.go("^.list"),a.response_msg="Book returned successfully !!!"},function(b){409==b.status?a.response_msg1=b.data.errorMessage:a.response_msg1="Book Returning is unsuccessful !!!"})},a.init=function(){a.libraryDetails.numPerPage=parseInt(a.libraryDetails.numPerPage),a.maxSize=5},a.cancel=function(){a.response_msg="",a.response_msg1="",c.go("^.list")},a.init(),a.pageChanged=function(){a.libraryDetails.startValue=(a.libraryDetails.currentPage-1)*a.libraryDetails.numPerPage,a.fetchLibraryList(a.libraryDetails.startValue,a.libraryDetails.numPerPage)},a.init1=function(b,c){void 0==b&&void 0==c?(a.libraryDetails.numPerPage=parseInt(a.libraryDetails.numPerPage),a.maxSize=5,a.fetchLibraryList(0,a.libraryDetails.numPerPage)):(a.libraryDetails.numPerPage=parseInt(a.libraryDetails.numPerPage),a.maxSize=5,a.searchBooks(b,c,0,a.libraryDetails.numPerPage))}}]);